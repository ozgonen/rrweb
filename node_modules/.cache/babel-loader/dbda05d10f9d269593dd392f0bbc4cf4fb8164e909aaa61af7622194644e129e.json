{"ast":null,"code":"import { createMirror, snapshot } from '../../../rrweb-snapshot/es/rrweb-snapshot.js';\nimport { initObservers, mutationBuffers } from './observer.js';\nimport { polyfill, on, getWindowWidth, getWindowHeight, isSerializedIframe, isSerializedStylesheet, hasShadowRoot } from '../utils.js';\nimport { EventType, IncrementalSource } from '../../../types/dist/types.js';\nimport { IframeManager } from './iframe-manager.js';\nimport { ShadowDomManager } from './shadow-dom-manager.js';\nimport { CanvasManager } from './observers/canvas/canvas-manager.js';\nimport { StylesheetManager } from './stylesheet-manager.js';\nfunction wrapEvent(e) {\n  return Object.assign(Object.assign({}, e), {\n    timestamp: Date.now()\n  });\n}\nlet wrappedEmit;\nlet takeFullSnapshot;\nlet canvasManager;\nlet recording = false;\nconst mirror = createMirror();\nfunction record(options = {}) {\n  const {\n    emit,\n    checkoutEveryNms,\n    checkoutEveryNth,\n    blockClass = 'rr-block',\n    blockSelector = null,\n    ignoreClass = 'rr-ignore',\n    maskTextClass = 'rr-mask',\n    maskTextSelector = null,\n    inlineStylesheet = true,\n    maskAllInputs,\n    maskInputOptions: _maskInputOptions,\n    slimDOMOptions: _slimDOMOptions,\n    maskInputFn,\n    maskTextFn,\n    hooks,\n    packFn,\n    sampling = {},\n    dataURLOptions = {},\n    mousemoveWait,\n    recordCanvas = false,\n    recordCrossOriginIframes = false,\n    userTriggeredOnInput = false,\n    collectFonts = false,\n    inlineImages = false,\n    plugins,\n    keepIframeSrcFn = () => false,\n    ignoreCSSAttributes = new Set([])\n  } = options;\n  const inEmittingFrame = recordCrossOriginIframes ? window.parent === window : true;\n  let passEmitsToParent = false;\n  if (!inEmittingFrame) {\n    try {\n      window.parent.document;\n      passEmitsToParent = false;\n    } catch (e) {\n      passEmitsToParent = true;\n    }\n  }\n  if (inEmittingFrame && !emit) {\n    throw new Error('emit function is required');\n  }\n  if (mousemoveWait !== undefined && sampling.mousemove === undefined) {\n    sampling.mousemove = mousemoveWait;\n  }\n  mirror.reset();\n  const maskInputOptions = maskAllInputs === true ? {\n    color: true,\n    date: true,\n    'datetime-local': true,\n    email: true,\n    month: true,\n    number: true,\n    range: true,\n    search: true,\n    tel: true,\n    text: true,\n    time: true,\n    url: true,\n    week: true,\n    textarea: true,\n    select: true,\n    password: true\n  } : _maskInputOptions !== undefined ? _maskInputOptions : {\n    password: true\n  };\n  const slimDOMOptions = _slimDOMOptions === true || _slimDOMOptions === 'all' ? {\n    script: true,\n    comment: true,\n    headFavicon: true,\n    headWhitespace: true,\n    headMetaSocial: true,\n    headMetaRobots: true,\n    headMetaHttpEquiv: true,\n    headMetaVerification: true,\n    headMetaAuthorship: _slimDOMOptions === 'all',\n    headMetaDescKeywords: _slimDOMOptions === 'all'\n  } : _slimDOMOptions ? _slimDOMOptions : {};\n  polyfill();\n  let lastFullSnapshotEvent;\n  let incrementalSnapshotCount = 0;\n  const eventProcessor = e => {\n    for (const plugin of plugins || []) {\n      if (plugin.eventProcessor) {\n        e = plugin.eventProcessor(e);\n      }\n    }\n    if (packFn) {\n      e = packFn(e);\n    }\n    return e;\n  };\n  wrappedEmit = (e, isCheckout) => {\n    var _a;\n    if (((_a = mutationBuffers[0]) === null || _a === void 0 ? void 0 : _a.isFrozen()) && e.type !== EventType.FullSnapshot && !(e.type === EventType.IncrementalSnapshot && e.data.source === IncrementalSource.Mutation)) {\n      mutationBuffers.forEach(buf => buf.unfreeze());\n    }\n    if (inEmittingFrame) {\n      emit === null || emit === void 0 ? void 0 : emit(eventProcessor(e), isCheckout);\n    } else if (passEmitsToParent) {\n      const message = {\n        type: 'rrweb',\n        event: eventProcessor(e),\n        isCheckout\n      };\n      window.parent.postMessage(message, '*');\n    }\n    if (e.type === EventType.FullSnapshot) {\n      lastFullSnapshotEvent = e;\n      incrementalSnapshotCount = 0;\n    } else if (e.type === EventType.IncrementalSnapshot) {\n      if (e.data.source === IncrementalSource.Mutation && e.data.isAttachIframe) {\n        return;\n      }\n      incrementalSnapshotCount++;\n      const exceedCount = checkoutEveryNth && incrementalSnapshotCount >= checkoutEveryNth;\n      const exceedTime = checkoutEveryNms && e.timestamp - lastFullSnapshotEvent.timestamp > checkoutEveryNms;\n      if (exceedCount || exceedTime) {\n        takeFullSnapshot(true);\n      }\n    }\n  };\n  const wrappedMutationEmit = m => {\n    wrappedEmit(wrapEvent({\n      type: EventType.IncrementalSnapshot,\n      data: Object.assign({\n        source: IncrementalSource.Mutation\n      }, m)\n    }));\n  };\n  const wrappedScrollEmit = p => wrappedEmit(wrapEvent({\n    type: EventType.IncrementalSnapshot,\n    data: Object.assign({\n      source: IncrementalSource.Scroll\n    }, p)\n  }));\n  const wrappedCanvasMutationEmit = p => wrappedEmit(wrapEvent({\n    type: EventType.IncrementalSnapshot,\n    data: Object.assign({\n      source: IncrementalSource.CanvasMutation\n    }, p)\n  }));\n  const wrappedAdoptedStyleSheetEmit = a => wrappedEmit(wrapEvent({\n    type: EventType.IncrementalSnapshot,\n    data: Object.assign({\n      source: IncrementalSource.AdoptedStyleSheet\n    }, a)\n  }));\n  const stylesheetManager = new StylesheetManager({\n    mutationCb: wrappedMutationEmit,\n    adoptedStyleSheetCb: wrappedAdoptedStyleSheetEmit\n  });\n  const iframeManager = new IframeManager({\n    mirror,\n    mutationCb: wrappedMutationEmit,\n    stylesheetManager: stylesheetManager,\n    recordCrossOriginIframes,\n    wrappedEmit\n  });\n  for (const plugin of plugins || []) {\n    if (plugin.getMirror) plugin.getMirror({\n      nodeMirror: mirror,\n      crossOriginIframeMirror: iframeManager.crossOriginIframeMirror,\n      crossOriginIframeStyleMirror: iframeManager.crossOriginIframeStyleMirror\n    });\n  }\n  canvasManager = new CanvasManager({\n    recordCanvas,\n    mutationCb: wrappedCanvasMutationEmit,\n    win: window,\n    blockClass,\n    blockSelector,\n    mirror,\n    sampling: sampling.canvas,\n    dataURLOptions\n  });\n  const shadowDomManager = new ShadowDomManager({\n    mutationCb: wrappedMutationEmit,\n    scrollCb: wrappedScrollEmit,\n    bypassOptions: {\n      blockClass,\n      blockSelector,\n      maskTextClass,\n      maskTextSelector,\n      inlineStylesheet,\n      maskInputOptions,\n      dataURLOptions,\n      maskTextFn,\n      maskInputFn,\n      recordCanvas,\n      inlineImages,\n      sampling,\n      slimDOMOptions,\n      iframeManager,\n      stylesheetManager,\n      canvasManager,\n      keepIframeSrcFn\n    },\n    mirror\n  });\n  takeFullSnapshot = (isCheckout = false) => {\n    var _a, _b, _c, _d, _e, _f;\n    wrappedEmit(wrapEvent({\n      type: EventType.Meta,\n      data: {\n        href: window.location.href,\n        width: getWindowWidth(),\n        height: getWindowHeight()\n      }\n    }), isCheckout);\n    stylesheetManager.reset();\n    mutationBuffers.forEach(buf => buf.lock());\n    const node = snapshot(document, {\n      mirror,\n      blockClass,\n      blockSelector,\n      maskTextClass,\n      maskTextSelector,\n      inlineStylesheet,\n      maskAllInputs: maskInputOptions,\n      maskTextFn,\n      slimDOM: slimDOMOptions,\n      dataURLOptions,\n      recordCanvas,\n      inlineImages,\n      onSerialize: n => {\n        if (isSerializedIframe(n, mirror)) {\n          iframeManager.addIframe(n);\n        }\n        if (isSerializedStylesheet(n, mirror)) {\n          stylesheetManager.trackLinkElement(n);\n        }\n        if (hasShadowRoot(n)) {\n          shadowDomManager.addShadowRoot(n.shadowRoot, document);\n        }\n      },\n      onIframeLoad: (iframe, childSn) => {\n        iframeManager.attachIframe(iframe, childSn);\n        shadowDomManager.observeAttachShadow(iframe);\n      },\n      onStylesheetLoad: (linkEl, childSn) => {\n        stylesheetManager.attachLinkElement(linkEl, childSn);\n      },\n      keepIframeSrcFn\n    });\n    if (!node) {\n      return console.warn('Failed to snapshot the document');\n    }\n    wrappedEmit(wrapEvent({\n      type: EventType.FullSnapshot,\n      data: {\n        node,\n        initialOffset: {\n          left: window.pageXOffset !== undefined ? window.pageXOffset : (document === null || document === void 0 ? void 0 : document.documentElement.scrollLeft) || ((_b = (_a = document === null || document === void 0 ? void 0 : document.body) === null || _a === void 0 ? void 0 : _a.parentElement) === null || _b === void 0 ? void 0 : _b.scrollLeft) || ((_c = document === null || document === void 0 ? void 0 : document.body) === null || _c === void 0 ? void 0 : _c.scrollLeft) || 0,\n          top: window.pageYOffset !== undefined ? window.pageYOffset : (document === null || document === void 0 ? void 0 : document.documentElement.scrollTop) || ((_e = (_d = document === null || document === void 0 ? void 0 : document.body) === null || _d === void 0 ? void 0 : _d.parentElement) === null || _e === void 0 ? void 0 : _e.scrollTop) || ((_f = document === null || document === void 0 ? void 0 : document.body) === null || _f === void 0 ? void 0 : _f.scrollTop) || 0\n        }\n      }\n    }));\n    mutationBuffers.forEach(buf => buf.unlock());\n    if (document.adoptedStyleSheets && document.adoptedStyleSheets.length > 0) stylesheetManager.adoptStyleSheets(document.adoptedStyleSheets, mirror.getId(document));\n  };\n  try {\n    const handlers = [];\n    handlers.push(on('DOMContentLoaded', () => {\n      wrappedEmit(wrapEvent({\n        type: EventType.DomContentLoaded,\n        data: {}\n      }));\n    }));\n    const observe = doc => {\n      var _a;\n      return initObservers({\n        mutationCb: wrappedMutationEmit,\n        mousemoveCb: (positions, source) => wrappedEmit(wrapEvent({\n          type: EventType.IncrementalSnapshot,\n          data: {\n            source,\n            positions\n          }\n        })),\n        mouseInteractionCb: d => wrappedEmit(wrapEvent({\n          type: EventType.IncrementalSnapshot,\n          data: Object.assign({\n            source: IncrementalSource.MouseInteraction\n          }, d)\n        })),\n        scrollCb: wrappedScrollEmit,\n        viewportResizeCb: d => wrappedEmit(wrapEvent({\n          type: EventType.IncrementalSnapshot,\n          data: Object.assign({\n            source: IncrementalSource.ViewportResize\n          }, d)\n        })),\n        inputCb: v => wrappedEmit(wrapEvent({\n          type: EventType.IncrementalSnapshot,\n          data: Object.assign({\n            source: IncrementalSource.Input\n          }, v)\n        })),\n        mediaInteractionCb: p => wrappedEmit(wrapEvent({\n          type: EventType.IncrementalSnapshot,\n          data: Object.assign({\n            source: IncrementalSource.MediaInteraction\n          }, p)\n        })),\n        styleSheetRuleCb: r => wrappedEmit(wrapEvent({\n          type: EventType.IncrementalSnapshot,\n          data: Object.assign({\n            source: IncrementalSource.StyleSheetRule\n          }, r)\n        })),\n        styleDeclarationCb: r => wrappedEmit(wrapEvent({\n          type: EventType.IncrementalSnapshot,\n          data: Object.assign({\n            source: IncrementalSource.StyleDeclaration\n          }, r)\n        })),\n        canvasMutationCb: wrappedCanvasMutationEmit,\n        fontCb: p => wrappedEmit(wrapEvent({\n          type: EventType.IncrementalSnapshot,\n          data: Object.assign({\n            source: IncrementalSource.Font\n          }, p)\n        })),\n        selectionCb: p => {\n          wrappedEmit(wrapEvent({\n            type: EventType.IncrementalSnapshot,\n            data: Object.assign({\n              source: IncrementalSource.Selection\n            }, p)\n          }));\n        },\n        blockClass,\n        ignoreClass,\n        maskTextClass,\n        maskTextSelector,\n        maskInputOptions,\n        inlineStylesheet,\n        sampling,\n        recordCanvas,\n        inlineImages,\n        userTriggeredOnInput,\n        collectFonts,\n        doc,\n        maskInputFn,\n        maskTextFn,\n        keepIframeSrcFn,\n        blockSelector,\n        slimDOMOptions,\n        dataURLOptions,\n        mirror,\n        iframeManager,\n        stylesheetManager,\n        shadowDomManager,\n        canvasManager,\n        ignoreCSSAttributes,\n        plugins: ((_a = plugins === null || plugins === void 0 ? void 0 : plugins.filter(p => p.observer)) === null || _a === void 0 ? void 0 : _a.map(p => ({\n          observer: p.observer,\n          options: p.options,\n          callback: payload => wrappedEmit(wrapEvent({\n            type: EventType.Plugin,\n            data: {\n              plugin: p.name,\n              payload\n            }\n          }))\n        }))) || []\n      }, hooks);\n    };\n    iframeManager.addLoadListener(iframeEl => {\n      handlers.push(observe(iframeEl.contentDocument));\n    });\n    const init = () => {\n      takeFullSnapshot();\n      handlers.push(observe(document));\n      recording = true;\n    };\n    if (document.readyState === 'interactive' || document.readyState === 'complete') {\n      init();\n    } else {\n      handlers.push(on('load', () => {\n        wrappedEmit(wrapEvent({\n          type: EventType.Load,\n          data: {}\n        }));\n        init();\n      }, window));\n    }\n    return () => {\n      handlers.forEach(h => h());\n      recording = false;\n    };\n  } catch (error) {\n    console.warn(error);\n  }\n}\nrecord.addCustomEvent = (tag, payload) => {\n  if (!recording) {\n    throw new Error('please add custom event after start recording');\n  }\n  wrappedEmit(wrapEvent({\n    type: EventType.Custom,\n    data: {\n      tag,\n      payload\n    }\n  }));\n};\nrecord.freezePage = () => {\n  mutationBuffers.forEach(buf => buf.freeze());\n};\nrecord.takeFullSnapshot = isCheckout => {\n  if (!recording) {\n    throw new Error('please take full snapshot after start recording');\n  }\n  takeFullSnapshot(isCheckout);\n};\nrecord.mirror = mirror;\nexport { record as default };","map":{"version":3,"names":["createMirror","snapshot","initObservers","mutationBuffers","polyfill","on","getWindowWidth","getWindowHeight","isSerializedIframe","isSerializedStylesheet","hasShadowRoot","EventType","IncrementalSource","IframeManager","ShadowDomManager","CanvasManager","StylesheetManager","wrapEvent","e","Object","assign","timestamp","Date","now","wrappedEmit","takeFullSnapshot","canvasManager","recording","mirror","record","options","emit","checkoutEveryNms","checkoutEveryNth","blockClass","blockSelector","ignoreClass","maskTextClass","maskTextSelector","inlineStylesheet","maskAllInputs","maskInputOptions","_maskInputOptions","slimDOMOptions","_slimDOMOptions","maskInputFn","maskTextFn","hooks","packFn","sampling","dataURLOptions","mousemoveWait","recordCanvas","recordCrossOriginIframes","userTriggeredOnInput","collectFonts","inlineImages","plugins","keepIframeSrcFn","ignoreCSSAttributes","Set","inEmittingFrame","window","parent","passEmitsToParent","document","Error","undefined","mousemove","reset","color","date","email","month","number","range","search","tel","text","time","url","week","textarea","select","password","script","comment","headFavicon","headWhitespace","headMetaSocial","headMetaRobots","headMetaHttpEquiv","headMetaVerification","headMetaAuthorship","headMetaDescKeywords","lastFullSnapshotEvent","incrementalSnapshotCount","eventProcessor","plugin","isCheckout","_a","isFrozen","type","FullSnapshot","IncrementalSnapshot","data","source","Mutation","forEach","buf","unfreeze","message","event","postMessage","isAttachIframe","exceedCount","exceedTime","wrappedMutationEmit","m","wrappedScrollEmit","p","Scroll","wrappedCanvasMutationEmit","CanvasMutation","wrappedAdoptedStyleSheetEmit","a","AdoptedStyleSheet","stylesheetManager","mutationCb","adoptedStyleSheetCb","iframeManager","getMirror","nodeMirror","crossOriginIframeMirror","crossOriginIframeStyleMirror","win","canvas","shadowDomManager","scrollCb","bypassOptions","_b","_c","_d","_e","_f","Meta","href","location","width","height","lock","node","slimDOM","onSerialize","n","addIframe","trackLinkElement","addShadowRoot","shadowRoot","onIframeLoad","iframe","childSn","attachIframe","observeAttachShadow","onStylesheetLoad","linkEl","attachLinkElement","console","warn","initialOffset","left","pageXOffset","documentElement","scrollLeft","body","parentElement","top","pageYOffset","scrollTop","unlock","adoptedStyleSheets","length","adoptStyleSheets","getId","handlers","push","DomContentLoaded","observe","doc","mousemoveCb","positions","mouseInteractionCb","d","MouseInteraction","viewportResizeCb","ViewportResize","inputCb","v","Input","mediaInteractionCb","MediaInteraction","styleSheetRuleCb","r","StyleSheetRule","styleDeclarationCb","StyleDeclaration","canvasMutationCb","fontCb","Font","selectionCb","Selection","filter","observer","map","callback","payload","Plugin","name","addLoadListener","iframeEl","contentDocument","init","readyState","Load","h","error","addCustomEvent","tag","Custom","freezePage","freeze","default"],"sources":["/Users/ogonen/rrweb/node_modules/rrweb/es/rrweb/packages/rrweb/src/record/index.js"],"sourcesContent":["import { createMirror, snapshot } from '../../../rrweb-snapshot/es/rrweb-snapshot.js';\nimport { initObservers, mutationBuffers } from './observer.js';\nimport { polyfill, on, getWindowWidth, getWindowHeight, isSerializedIframe, isSerializedStylesheet, hasShadowRoot } from '../utils.js';\nimport { EventType, IncrementalSource } from '../../../types/dist/types.js';\nimport { IframeManager } from './iframe-manager.js';\nimport { ShadowDomManager } from './shadow-dom-manager.js';\nimport { CanvasManager } from './observers/canvas/canvas-manager.js';\nimport { StylesheetManager } from './stylesheet-manager.js';\n\nfunction wrapEvent(e) {\r\n    return Object.assign(Object.assign({}, e), { timestamp: Date.now() });\r\n}\r\nlet wrappedEmit;\r\nlet takeFullSnapshot;\r\nlet canvasManager;\r\nlet recording = false;\r\nconst mirror = createMirror();\r\nfunction record(options = {}) {\r\n    const { emit, checkoutEveryNms, checkoutEveryNth, blockClass = 'rr-block', blockSelector = null, ignoreClass = 'rr-ignore', maskTextClass = 'rr-mask', maskTextSelector = null, inlineStylesheet = true, maskAllInputs, maskInputOptions: _maskInputOptions, slimDOMOptions: _slimDOMOptions, maskInputFn, maskTextFn, hooks, packFn, sampling = {}, dataURLOptions = {}, mousemoveWait, recordCanvas = false, recordCrossOriginIframes = false, userTriggeredOnInput = false, collectFonts = false, inlineImages = false, plugins, keepIframeSrcFn = () => false, ignoreCSSAttributes = new Set([]), } = options;\r\n    const inEmittingFrame = recordCrossOriginIframes\r\n        ? window.parent === window\r\n        : true;\r\n    let passEmitsToParent = false;\r\n    if (!inEmittingFrame) {\r\n        try {\r\n            window.parent.document;\r\n            passEmitsToParent = false;\r\n        }\r\n        catch (e) {\r\n            passEmitsToParent = true;\r\n        }\r\n    }\r\n    if (inEmittingFrame && !emit) {\r\n        throw new Error('emit function is required');\r\n    }\r\n    if (mousemoveWait !== undefined && sampling.mousemove === undefined) {\r\n        sampling.mousemove = mousemoveWait;\r\n    }\r\n    mirror.reset();\r\n    const maskInputOptions = maskAllInputs === true\r\n        ? {\r\n            color: true,\r\n            date: true,\r\n            'datetime-local': true,\r\n            email: true,\r\n            month: true,\r\n            number: true,\r\n            range: true,\r\n            search: true,\r\n            tel: true,\r\n            text: true,\r\n            time: true,\r\n            url: true,\r\n            week: true,\r\n            textarea: true,\r\n            select: true,\r\n            password: true,\r\n        }\r\n        : _maskInputOptions !== undefined\r\n            ? _maskInputOptions\r\n            : { password: true };\r\n    const slimDOMOptions = _slimDOMOptions === true || _slimDOMOptions === 'all'\r\n        ? {\r\n            script: true,\r\n            comment: true,\r\n            headFavicon: true,\r\n            headWhitespace: true,\r\n            headMetaSocial: true,\r\n            headMetaRobots: true,\r\n            headMetaHttpEquiv: true,\r\n            headMetaVerification: true,\r\n            headMetaAuthorship: _slimDOMOptions === 'all',\r\n            headMetaDescKeywords: _slimDOMOptions === 'all',\r\n        }\r\n        : _slimDOMOptions\r\n            ? _slimDOMOptions\r\n            : {};\r\n    polyfill();\r\n    let lastFullSnapshotEvent;\r\n    let incrementalSnapshotCount = 0;\r\n    const eventProcessor = (e) => {\r\n        for (const plugin of plugins || []) {\r\n            if (plugin.eventProcessor) {\r\n                e = plugin.eventProcessor(e);\r\n            }\r\n        }\r\n        if (packFn) {\r\n            e = packFn(e);\r\n        }\r\n        return e;\r\n    };\r\n    wrappedEmit = (e, isCheckout) => {\r\n        var _a;\r\n        if (((_a = mutationBuffers[0]) === null || _a === void 0 ? void 0 : _a.isFrozen()) &&\r\n            e.type !== EventType.FullSnapshot &&\r\n            !(e.type === EventType.IncrementalSnapshot &&\r\n                e.data.source === IncrementalSource.Mutation)) {\r\n            mutationBuffers.forEach((buf) => buf.unfreeze());\r\n        }\r\n        if (inEmittingFrame) {\r\n            emit === null || emit === void 0 ? void 0 : emit(eventProcessor(e), isCheckout);\r\n        }\r\n        else if (passEmitsToParent) {\r\n            const message = {\r\n                type: 'rrweb',\r\n                event: eventProcessor(e),\r\n                isCheckout,\r\n            };\r\n            window.parent.postMessage(message, '*');\r\n        }\r\n        if (e.type === EventType.FullSnapshot) {\r\n            lastFullSnapshotEvent = e;\r\n            incrementalSnapshotCount = 0;\r\n        }\r\n        else if (e.type === EventType.IncrementalSnapshot) {\r\n            if (e.data.source === IncrementalSource.Mutation &&\r\n                e.data.isAttachIframe) {\r\n                return;\r\n            }\r\n            incrementalSnapshotCount++;\r\n            const exceedCount = checkoutEveryNth && incrementalSnapshotCount >= checkoutEveryNth;\r\n            const exceedTime = checkoutEveryNms &&\r\n                e.timestamp - lastFullSnapshotEvent.timestamp > checkoutEveryNms;\r\n            if (exceedCount || exceedTime) {\r\n                takeFullSnapshot(true);\r\n            }\r\n        }\r\n    };\r\n    const wrappedMutationEmit = (m) => {\r\n        wrappedEmit(wrapEvent({\r\n            type: EventType.IncrementalSnapshot,\r\n            data: Object.assign({ source: IncrementalSource.Mutation }, m),\r\n        }));\r\n    };\r\n    const wrappedScrollEmit = (p) => wrappedEmit(wrapEvent({\r\n        type: EventType.IncrementalSnapshot,\r\n        data: Object.assign({ source: IncrementalSource.Scroll }, p),\r\n    }));\r\n    const wrappedCanvasMutationEmit = (p) => wrappedEmit(wrapEvent({\r\n        type: EventType.IncrementalSnapshot,\r\n        data: Object.assign({ source: IncrementalSource.CanvasMutation }, p),\r\n    }));\r\n    const wrappedAdoptedStyleSheetEmit = (a) => wrappedEmit(wrapEvent({\r\n        type: EventType.IncrementalSnapshot,\r\n        data: Object.assign({ source: IncrementalSource.AdoptedStyleSheet }, a),\r\n    }));\r\n    const stylesheetManager = new StylesheetManager({\r\n        mutationCb: wrappedMutationEmit,\r\n        adoptedStyleSheetCb: wrappedAdoptedStyleSheetEmit,\r\n    });\r\n    const iframeManager = new IframeManager({\r\n        mirror,\r\n        mutationCb: wrappedMutationEmit,\r\n        stylesheetManager: stylesheetManager,\r\n        recordCrossOriginIframes,\r\n        wrappedEmit,\r\n    });\r\n    for (const plugin of plugins || []) {\r\n        if (plugin.getMirror)\r\n            plugin.getMirror({\r\n                nodeMirror: mirror,\r\n                crossOriginIframeMirror: iframeManager.crossOriginIframeMirror,\r\n                crossOriginIframeStyleMirror: iframeManager.crossOriginIframeStyleMirror,\r\n            });\r\n    }\r\n    canvasManager = new CanvasManager({\r\n        recordCanvas,\r\n        mutationCb: wrappedCanvasMutationEmit,\r\n        win: window,\r\n        blockClass,\r\n        blockSelector,\r\n        mirror,\r\n        sampling: sampling.canvas,\r\n        dataURLOptions,\r\n    });\r\n    const shadowDomManager = new ShadowDomManager({\r\n        mutationCb: wrappedMutationEmit,\r\n        scrollCb: wrappedScrollEmit,\r\n        bypassOptions: {\r\n            blockClass,\r\n            blockSelector,\r\n            maskTextClass,\r\n            maskTextSelector,\r\n            inlineStylesheet,\r\n            maskInputOptions,\r\n            dataURLOptions,\r\n            maskTextFn,\r\n            maskInputFn,\r\n            recordCanvas,\r\n            inlineImages,\r\n            sampling,\r\n            slimDOMOptions,\r\n            iframeManager,\r\n            stylesheetManager,\r\n            canvasManager,\r\n            keepIframeSrcFn,\r\n        },\r\n        mirror,\r\n    });\r\n    takeFullSnapshot = (isCheckout = false) => {\r\n        var _a, _b, _c, _d, _e, _f;\r\n        wrappedEmit(wrapEvent({\r\n            type: EventType.Meta,\r\n            data: {\r\n                href: window.location.href,\r\n                width: getWindowWidth(),\r\n                height: getWindowHeight(),\r\n            },\r\n        }), isCheckout);\r\n        stylesheetManager.reset();\r\n        mutationBuffers.forEach((buf) => buf.lock());\r\n        const node = snapshot(document, {\r\n            mirror,\r\n            blockClass,\r\n            blockSelector,\r\n            maskTextClass,\r\n            maskTextSelector,\r\n            inlineStylesheet,\r\n            maskAllInputs: maskInputOptions,\r\n            maskTextFn,\r\n            slimDOM: slimDOMOptions,\r\n            dataURLOptions,\r\n            recordCanvas,\r\n            inlineImages,\r\n            onSerialize: (n) => {\r\n                if (isSerializedIframe(n, mirror)) {\r\n                    iframeManager.addIframe(n);\r\n                }\r\n                if (isSerializedStylesheet(n, mirror)) {\r\n                    stylesheetManager.trackLinkElement(n);\r\n                }\r\n                if (hasShadowRoot(n)) {\r\n                    shadowDomManager.addShadowRoot(n.shadowRoot, document);\r\n                }\r\n            },\r\n            onIframeLoad: (iframe, childSn) => {\r\n                iframeManager.attachIframe(iframe, childSn);\r\n                shadowDomManager.observeAttachShadow(iframe);\r\n            },\r\n            onStylesheetLoad: (linkEl, childSn) => {\r\n                stylesheetManager.attachLinkElement(linkEl, childSn);\r\n            },\r\n            keepIframeSrcFn,\r\n        });\r\n        if (!node) {\r\n            return console.warn('Failed to snapshot the document');\r\n        }\r\n        wrappedEmit(wrapEvent({\r\n            type: EventType.FullSnapshot,\r\n            data: {\r\n                node,\r\n                initialOffset: {\r\n                    left: window.pageXOffset !== undefined\r\n                        ? window.pageXOffset\r\n                        : (document === null || document === void 0 ? void 0 : document.documentElement.scrollLeft) ||\r\n                            ((_b = (_a = document === null || document === void 0 ? void 0 : document.body) === null || _a === void 0 ? void 0 : _a.parentElement) === null || _b === void 0 ? void 0 : _b.scrollLeft) ||\r\n                            ((_c = document === null || document === void 0 ? void 0 : document.body) === null || _c === void 0 ? void 0 : _c.scrollLeft) ||\r\n                            0,\r\n                    top: window.pageYOffset !== undefined\r\n                        ? window.pageYOffset\r\n                        : (document === null || document === void 0 ? void 0 : document.documentElement.scrollTop) ||\r\n                            ((_e = (_d = document === null || document === void 0 ? void 0 : document.body) === null || _d === void 0 ? void 0 : _d.parentElement) === null || _e === void 0 ? void 0 : _e.scrollTop) ||\r\n                            ((_f = document === null || document === void 0 ? void 0 : document.body) === null || _f === void 0 ? void 0 : _f.scrollTop) ||\r\n                            0,\r\n                },\r\n            },\r\n        }));\r\n        mutationBuffers.forEach((buf) => buf.unlock());\r\n        if (document.adoptedStyleSheets && document.adoptedStyleSheets.length > 0)\r\n            stylesheetManager.adoptStyleSheets(document.adoptedStyleSheets, mirror.getId(document));\r\n    };\r\n    try {\r\n        const handlers = [];\r\n        handlers.push(on('DOMContentLoaded', () => {\r\n            wrappedEmit(wrapEvent({\r\n                type: EventType.DomContentLoaded,\r\n                data: {},\r\n            }));\r\n        }));\r\n        const observe = (doc) => {\r\n            var _a;\r\n            return initObservers({\r\n                mutationCb: wrappedMutationEmit,\r\n                mousemoveCb: (positions, source) => wrappedEmit(wrapEvent({\r\n                    type: EventType.IncrementalSnapshot,\r\n                    data: {\r\n                        source,\r\n                        positions,\r\n                    },\r\n                })),\r\n                mouseInteractionCb: (d) => wrappedEmit(wrapEvent({\r\n                    type: EventType.IncrementalSnapshot,\r\n                    data: Object.assign({ source: IncrementalSource.MouseInteraction }, d),\r\n                })),\r\n                scrollCb: wrappedScrollEmit,\r\n                viewportResizeCb: (d) => wrappedEmit(wrapEvent({\r\n                    type: EventType.IncrementalSnapshot,\r\n                    data: Object.assign({ source: IncrementalSource.ViewportResize }, d),\r\n                })),\r\n                inputCb: (v) => wrappedEmit(wrapEvent({\r\n                    type: EventType.IncrementalSnapshot,\r\n                    data: Object.assign({ source: IncrementalSource.Input }, v),\r\n                })),\r\n                mediaInteractionCb: (p) => wrappedEmit(wrapEvent({\r\n                    type: EventType.IncrementalSnapshot,\r\n                    data: Object.assign({ source: IncrementalSource.MediaInteraction }, p),\r\n                })),\r\n                styleSheetRuleCb: (r) => wrappedEmit(wrapEvent({\r\n                    type: EventType.IncrementalSnapshot,\r\n                    data: Object.assign({ source: IncrementalSource.StyleSheetRule }, r),\r\n                })),\r\n                styleDeclarationCb: (r) => wrappedEmit(wrapEvent({\r\n                    type: EventType.IncrementalSnapshot,\r\n                    data: Object.assign({ source: IncrementalSource.StyleDeclaration }, r),\r\n                })),\r\n                canvasMutationCb: wrappedCanvasMutationEmit,\r\n                fontCb: (p) => wrappedEmit(wrapEvent({\r\n                    type: EventType.IncrementalSnapshot,\r\n                    data: Object.assign({ source: IncrementalSource.Font }, p),\r\n                })),\r\n                selectionCb: (p) => {\r\n                    wrappedEmit(wrapEvent({\r\n                        type: EventType.IncrementalSnapshot,\r\n                        data: Object.assign({ source: IncrementalSource.Selection }, p),\r\n                    }));\r\n                },\r\n                blockClass,\r\n                ignoreClass,\r\n                maskTextClass,\r\n                maskTextSelector,\r\n                maskInputOptions,\r\n                inlineStylesheet,\r\n                sampling,\r\n                recordCanvas,\r\n                inlineImages,\r\n                userTriggeredOnInput,\r\n                collectFonts,\r\n                doc,\r\n                maskInputFn,\r\n                maskTextFn,\r\n                keepIframeSrcFn,\r\n                blockSelector,\r\n                slimDOMOptions,\r\n                dataURLOptions,\r\n                mirror,\r\n                iframeManager,\r\n                stylesheetManager,\r\n                shadowDomManager,\r\n                canvasManager,\r\n                ignoreCSSAttributes,\r\n                plugins: ((_a = plugins === null || plugins === void 0 ? void 0 : plugins.filter((p) => p.observer)) === null || _a === void 0 ? void 0 : _a.map((p) => ({\r\n                    observer: p.observer,\r\n                    options: p.options,\r\n                    callback: (payload) => wrappedEmit(wrapEvent({\r\n                        type: EventType.Plugin,\r\n                        data: {\r\n                            plugin: p.name,\r\n                            payload,\r\n                        },\r\n                    })),\r\n                }))) || [],\r\n            }, hooks);\r\n        };\r\n        iframeManager.addLoadListener((iframeEl) => {\r\n            handlers.push(observe(iframeEl.contentDocument));\r\n        });\r\n        const init = () => {\r\n            takeFullSnapshot();\r\n            handlers.push(observe(document));\r\n            recording = true;\r\n        };\r\n        if (document.readyState === 'interactive' ||\r\n            document.readyState === 'complete') {\r\n            init();\r\n        }\r\n        else {\r\n            handlers.push(on('load', () => {\r\n                wrappedEmit(wrapEvent({\r\n                    type: EventType.Load,\r\n                    data: {},\r\n                }));\r\n                init();\r\n            }, window));\r\n        }\r\n        return () => {\r\n            handlers.forEach((h) => h());\r\n            recording = false;\r\n        };\r\n    }\r\n    catch (error) {\r\n        console.warn(error);\r\n    }\r\n}\r\nrecord.addCustomEvent = (tag, payload) => {\r\n    if (!recording) {\r\n        throw new Error('please add custom event after start recording');\r\n    }\r\n    wrappedEmit(wrapEvent({\r\n        type: EventType.Custom,\r\n        data: {\r\n            tag,\r\n            payload,\r\n        },\r\n    }));\r\n};\r\nrecord.freezePage = () => {\r\n    mutationBuffers.forEach((buf) => buf.freeze());\r\n};\r\nrecord.takeFullSnapshot = (isCheckout) => {\r\n    if (!recording) {\r\n        throw new Error('please take full snapshot after start recording');\r\n    }\r\n    takeFullSnapshot(isCheckout);\r\n};\r\nrecord.mirror = mirror;\n\nexport { record as default };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}