{"ast":null,"code":"var NodeType;\n(function (NodeType) {\n  NodeType[NodeType[\"Document\"] = 0] = \"Document\";\n  NodeType[NodeType[\"DocumentType\"] = 1] = \"DocumentType\";\n  NodeType[NodeType[\"Element\"] = 2] = \"Element\";\n  NodeType[NodeType[\"Text\"] = 3] = \"Text\";\n  NodeType[NodeType[\"CDATA\"] = 4] = \"CDATA\";\n  NodeType[NodeType[\"Comment\"] = 5] = \"Comment\";\n})(NodeType || (NodeType = {}));\nfunction isElement(n) {\n  return n.nodeType === n.ELEMENT_NODE;\n}\nfunction isShadowRoot(n) {\n  var host = n === null || n === void 0 ? void 0 : n.host;\n  return Boolean((host === null || host === void 0 ? void 0 : host.shadowRoot) === n);\n}\nfunction isNativeShadowDom(shadowRoot) {\n  return Object.prototype.toString.call(shadowRoot) === '[object ShadowRoot]';\n}\nfunction fixBrowserCompatibilityIssuesInCSS(cssText) {\n  if (cssText.includes(' background-clip: text;') && !cssText.includes(' -webkit-background-clip: text;')) {\n    cssText = cssText.replace(' background-clip: text;', ' -webkit-background-clip: text; background-clip: text;');\n  }\n  return cssText;\n}\nfunction getCssRulesString(s) {\n  try {\n    var rules = s.rules || s.cssRules;\n    return rules ? fixBrowserCompatibilityIssuesInCSS(Array.from(rules).map(getCssRuleString).join('')) : null;\n  } catch (error) {\n    return null;\n  }\n}\nfunction getCssRuleString(rule) {\n  var cssStringified = rule.cssText;\n  if (isCSSImportRule(rule)) {\n    try {\n      cssStringified = getCssRulesString(rule.styleSheet) || cssStringified;\n    } catch (_a) {}\n  }\n  return cssStringified;\n}\nfunction isCSSImportRule(rule) {\n  return 'styleSheet' in rule;\n}\nvar Mirror = function () {\n  function Mirror() {\n    this.idNodeMap = new Map();\n    this.nodeMetaMap = new WeakMap();\n  }\n  Mirror.prototype.getId = function (n) {\n    var _a;\n    if (!n) return -1;\n    var id = (_a = this.getMeta(n)) === null || _a === void 0 ? void 0 : _a.id;\n    return id !== null && id !== void 0 ? id : -1;\n  };\n  Mirror.prototype.getNode = function (id) {\n    return this.idNodeMap.get(id) || null;\n  };\n  Mirror.prototype.getIds = function () {\n    return Array.from(this.idNodeMap.keys());\n  };\n  Mirror.prototype.getMeta = function (n) {\n    return this.nodeMetaMap.get(n) || null;\n  };\n  Mirror.prototype.removeNodeFromMap = function (n) {\n    var _this = this;\n    var id = this.getId(n);\n    this.idNodeMap[\"delete\"](id);\n    if (n.childNodes) {\n      n.childNodes.forEach(function (childNode) {\n        return _this.removeNodeFromMap(childNode);\n      });\n    }\n  };\n  Mirror.prototype.has = function (id) {\n    return this.idNodeMap.has(id);\n  };\n  Mirror.prototype.hasNode = function (node) {\n    return this.nodeMetaMap.has(node);\n  };\n  Mirror.prototype.add = function (n, meta) {\n    var id = meta.id;\n    this.idNodeMap.set(id, n);\n    this.nodeMetaMap.set(n, meta);\n  };\n  Mirror.prototype.replace = function (id, n) {\n    var oldNode = this.getNode(id);\n    if (oldNode) {\n      var meta = this.nodeMetaMap.get(oldNode);\n      if (meta) this.nodeMetaMap.set(n, meta);\n    }\n    this.idNodeMap.set(id, n);\n  };\n  Mirror.prototype.reset = function () {\n    this.idNodeMap = new Map();\n    this.nodeMetaMap = new WeakMap();\n  };\n  return Mirror;\n}();\nfunction createMirror() {\n  return new Mirror();\n}\nfunction maskInputValue(_a) {\n  var maskInputOptions = _a.maskInputOptions,\n    tagName = _a.tagName,\n    type = _a.type,\n    value = _a.value,\n    maskInputFn = _a.maskInputFn;\n  var text = value || '';\n  if (maskInputOptions[tagName.toLowerCase()] || maskInputOptions[type]) {\n    if (maskInputFn) {\n      text = maskInputFn(text);\n    } else {\n      text = '*'.repeat(text.length);\n    }\n  }\n  return text;\n}\nvar ORIGINAL_ATTRIBUTE_NAME = '__rrweb_original__';\nfunction is2DCanvasBlank(canvas) {\n  var ctx = canvas.getContext('2d');\n  if (!ctx) return true;\n  var chunkSize = 50;\n  for (var x = 0; x < canvas.width; x += chunkSize) {\n    for (var y = 0; y < canvas.height; y += chunkSize) {\n      var getImageData = ctx.getImageData;\n      var originalGetImageData = ORIGINAL_ATTRIBUTE_NAME in getImageData ? getImageData[ORIGINAL_ATTRIBUTE_NAME] : getImageData;\n      var pixelBuffer = new Uint32Array(originalGetImageData.call(ctx, x, y, Math.min(chunkSize, canvas.width - x), Math.min(chunkSize, canvas.height - y)).data.buffer);\n      if (pixelBuffer.some(function (pixel) {\n        return pixel !== 0;\n      })) return false;\n    }\n  }\n  return true;\n}\nvar _id = 1;\nvar tagNameRegex = new RegExp('[^a-z0-9-_:]');\nvar IGNORED_NODE = -2;\nfunction genId() {\n  return _id++;\n}\nfunction getValidTagName(element) {\n  if (element instanceof HTMLFormElement) {\n    return 'form';\n  }\n  var processedTagName = element.tagName.toLowerCase().trim();\n  if (tagNameRegex.test(processedTagName)) {\n    return 'div';\n  }\n  return processedTagName;\n}\nfunction stringifyStyleSheet(sheet) {\n  return sheet.cssRules ? Array.from(sheet.cssRules).map(function (rule) {\n    return rule.cssText || '';\n  }).join('') : '';\n}\nfunction extractOrigin(url) {\n  var origin = '';\n  if (url.indexOf('//') > -1) {\n    origin = url.split('/').slice(0, 3).join('/');\n  } else {\n    origin = url.split('/')[0];\n  }\n  origin = origin.split('?')[0];\n  return origin;\n}\nvar canvasService;\nvar canvasCtx;\nvar URL_IN_CSS_REF = /url\\((?:(')([^']*)'|(\")(.*?)\"|([^)]*))\\)/gm;\nvar RELATIVE_PATH = /^(?!www\\.|(?:http|ftp)s?:\\/\\/|[A-Za-z]:\\\\|\\/\\/|#).*/;\nvar DATA_URI = /^(data:)([^,]*),(.*)/i;\nfunction absoluteToStylesheet(cssText, href) {\n  return (cssText || '').replace(URL_IN_CSS_REF, function (origin, quote1, path1, quote2, path2, path3) {\n    var filePath = path1 || path2 || path3;\n    var maybeQuote = quote1 || quote2 || '';\n    if (!filePath) {\n      return origin;\n    }\n    if (!RELATIVE_PATH.test(filePath)) {\n      return \"url(\".concat(maybeQuote).concat(filePath).concat(maybeQuote, \")\");\n    }\n    if (DATA_URI.test(filePath)) {\n      return \"url(\".concat(maybeQuote).concat(filePath).concat(maybeQuote, \")\");\n    }\n    if (filePath[0] === '/') {\n      return \"url(\".concat(maybeQuote).concat(extractOrigin(href) + filePath).concat(maybeQuote, \")\");\n    }\n    var stack = href.split('/');\n    var parts = filePath.split('/');\n    stack.pop();\n    for (var _i = 0, parts_1 = parts; _i < parts_1.length; _i++) {\n      var part = parts_1[_i];\n      if (part === '.') {\n        continue;\n      } else if (part === '..') {\n        stack.pop();\n      } else {\n        stack.push(part);\n      }\n    }\n    return \"url(\".concat(maybeQuote).concat(stack.join('/')).concat(maybeQuote, \")\");\n  });\n}\nvar SRCSET_NOT_SPACES = /^[^ \\t\\n\\r\\u000c]+/;\nvar SRCSET_COMMAS_OR_SPACES = /^[, \\t\\n\\r\\u000c]+/;\nfunction getAbsoluteSrcsetString(doc, attributeValue) {\n  if (attributeValue.trim() === '') {\n    return attributeValue;\n  }\n  var pos = 0;\n  function collectCharacters(regEx) {\n    var chars;\n    var match = regEx.exec(attributeValue.substring(pos));\n    if (match) {\n      chars = match[0];\n      pos += chars.length;\n      return chars;\n    }\n    return '';\n  }\n  var output = [];\n  while (true) {\n    collectCharacters(SRCSET_COMMAS_OR_SPACES);\n    if (pos >= attributeValue.length) {\n      break;\n    }\n    var url = collectCharacters(SRCSET_NOT_SPACES);\n    if (url.slice(-1) === ',') {\n      url = absoluteToDoc(doc, url.substring(0, url.length - 1));\n      output.push(url);\n    } else {\n      var descriptorsStr = '';\n      url = absoluteToDoc(doc, url);\n      var inParens = false;\n      while (true) {\n        var c = attributeValue.charAt(pos);\n        if (c === '') {\n          output.push((url + descriptorsStr).trim());\n          break;\n        } else if (!inParens) {\n          if (c === ',') {\n            pos += 1;\n            output.push((url + descriptorsStr).trim());\n            break;\n          } else if (c === '(') {\n            inParens = true;\n          }\n        } else {\n          if (c === ')') {\n            inParens = false;\n          }\n        }\n        descriptorsStr += c;\n        pos += 1;\n      }\n    }\n  }\n  return output.join(', ');\n}\nfunction absoluteToDoc(doc, attributeValue) {\n  if (!attributeValue || attributeValue.trim() === '') {\n    return attributeValue;\n  }\n  var a = doc.createElement('a');\n  a.href = attributeValue;\n  return a.href;\n}\nfunction isSVGElement(el) {\n  return Boolean(el.tagName === 'svg' || el.ownerSVGElement);\n}\nfunction getHref() {\n  var a = document.createElement('a');\n  a.href = '';\n  return a.href;\n}\nfunction transformAttribute(doc, tagName, name, value) {\n  if (name === 'src' || name === 'href' && value && !(tagName === 'use' && value[0] === '#')) {\n    return absoluteToDoc(doc, value);\n  } else if (name === 'xlink:href' && value && value[0] !== '#') {\n    return absoluteToDoc(doc, value);\n  } else if (name === 'background' && value && (tagName === 'table' || tagName === 'td' || tagName === 'th')) {\n    return absoluteToDoc(doc, value);\n  } else if (name === 'srcset' && value) {\n    return getAbsoluteSrcsetString(doc, value);\n  } else if (name === 'style' && value) {\n    return absoluteToStylesheet(value, getHref());\n  } else if (tagName === 'object' && name === 'data' && value) {\n    return absoluteToDoc(doc, value);\n  } else {\n    return value;\n  }\n}\nfunction _isBlockedElement(element, blockClass, blockSelector) {\n  if (typeof blockClass === 'string') {\n    if (element.classList.contains(blockClass)) {\n      return true;\n    }\n  } else {\n    for (var eIndex = element.classList.length; eIndex--;) {\n      var className = element.classList[eIndex];\n      if (blockClass.test(className)) {\n        return true;\n      }\n    }\n  }\n  if (blockSelector) {\n    return element.matches(blockSelector);\n  }\n  return false;\n}\nfunction classMatchesRegex(node, regex, checkAncestors) {\n  if (!node) return false;\n  if (node.nodeType !== node.ELEMENT_NODE) {\n    if (!checkAncestors) return false;\n    return classMatchesRegex(node.parentNode, regex, checkAncestors);\n  }\n  for (var eIndex = node.classList.length; eIndex--;) {\n    var className = node.classList[eIndex];\n    if (regex.test(className)) {\n      return true;\n    }\n  }\n  if (!checkAncestors) return false;\n  return classMatchesRegex(node.parentNode, regex, checkAncestors);\n}\nfunction needMaskingText(node, maskTextClass, maskTextSelector) {\n  var el = node.nodeType === node.ELEMENT_NODE ? node : node.parentElement;\n  if (el === null) return false;\n  if (typeof maskTextClass === 'string') {\n    if (el.classList.contains(maskTextClass)) return true;\n    if (el.closest(\".\".concat(maskTextClass))) return true;\n  } else {\n    if (classMatchesRegex(el, maskTextClass, true)) return true;\n  }\n  if (maskTextSelector) {\n    if (el.matches(maskTextSelector)) return true;\n    if (el.closest(maskTextSelector)) return true;\n  }\n  return false;\n}\nfunction onceIframeLoaded(iframeEl, listener, iframeLoadTimeout) {\n  var win = iframeEl.contentWindow;\n  if (!win) {\n    return;\n  }\n  var fired = false;\n  var readyState;\n  try {\n    readyState = win.document.readyState;\n  } catch (error) {\n    return;\n  }\n  if (readyState !== 'complete') {\n    var timer_1 = setTimeout(function () {\n      if (!fired) {\n        listener();\n        fired = true;\n      }\n    }, iframeLoadTimeout);\n    iframeEl.addEventListener('load', function () {\n      clearTimeout(timer_1);\n      fired = true;\n      listener();\n    });\n    return;\n  }\n  var blankUrl = 'about:blank';\n  if (win.location.href !== blankUrl || iframeEl.src === blankUrl || iframeEl.src === '') {\n    setTimeout(listener, 0);\n    return iframeEl.addEventListener('load', listener);\n  }\n  iframeEl.addEventListener('load', listener);\n}\nfunction onceStylesheetLoaded(link, listener, styleSheetLoadTimeout) {\n  var fired = false;\n  var styleSheetLoaded;\n  try {\n    styleSheetLoaded = link.sheet;\n  } catch (error) {\n    return;\n  }\n  if (styleSheetLoaded) return;\n  var timer = setTimeout(function () {\n    if (!fired) {\n      listener();\n      fired = true;\n    }\n  }, styleSheetLoadTimeout);\n  link.addEventListener('load', function () {\n    clearTimeout(timer);\n    fired = true;\n    listener();\n  });\n}\nfunction serializeNode(n, options) {\n  var doc = options.doc,\n    mirror = options.mirror,\n    blockClass = options.blockClass,\n    blockSelector = options.blockSelector,\n    maskTextClass = options.maskTextClass,\n    maskTextSelector = options.maskTextSelector,\n    inlineStylesheet = options.inlineStylesheet,\n    _a = options.maskInputOptions,\n    maskInputOptions = _a === void 0 ? {} : _a,\n    maskTextFn = options.maskTextFn,\n    maskInputFn = options.maskInputFn,\n    _b = options.dataURLOptions,\n    dataURLOptions = _b === void 0 ? {} : _b,\n    inlineImages = options.inlineImages,\n    recordCanvas = options.recordCanvas,\n    keepIframeSrcFn = options.keepIframeSrcFn,\n    _c = options.newlyAddedElement,\n    newlyAddedElement = _c === void 0 ? false : _c;\n  var rootId = getRootId(doc, mirror);\n  switch (n.nodeType) {\n    case n.DOCUMENT_NODE:\n      if (n.compatMode !== 'CSS1Compat') {\n        return {\n          type: NodeType.Document,\n          childNodes: [],\n          compatMode: n.compatMode\n        };\n      } else {\n        return {\n          type: NodeType.Document,\n          childNodes: []\n        };\n      }\n    case n.DOCUMENT_TYPE_NODE:\n      return {\n        type: NodeType.DocumentType,\n        name: n.name,\n        publicId: n.publicId,\n        systemId: n.systemId,\n        rootId: rootId\n      };\n    case n.ELEMENT_NODE:\n      return serializeElementNode(n, {\n        doc: doc,\n        blockClass: blockClass,\n        blockSelector: blockSelector,\n        inlineStylesheet: inlineStylesheet,\n        maskInputOptions: maskInputOptions,\n        maskInputFn: maskInputFn,\n        dataURLOptions: dataURLOptions,\n        inlineImages: inlineImages,\n        recordCanvas: recordCanvas,\n        keepIframeSrcFn: keepIframeSrcFn,\n        newlyAddedElement: newlyAddedElement,\n        rootId: rootId\n      });\n    case n.TEXT_NODE:\n      return serializeTextNode(n, {\n        maskTextClass: maskTextClass,\n        maskTextSelector: maskTextSelector,\n        maskTextFn: maskTextFn,\n        rootId: rootId\n      });\n    case n.CDATA_SECTION_NODE:\n      return {\n        type: NodeType.CDATA,\n        textContent: '',\n        rootId: rootId\n      };\n    case n.COMMENT_NODE:\n      return {\n        type: NodeType.Comment,\n        textContent: n.textContent || '',\n        rootId: rootId\n      };\n    default:\n      return false;\n  }\n}\nfunction getRootId(doc, mirror) {\n  if (!mirror.hasNode(doc)) return undefined;\n  var docId = mirror.getId(doc);\n  return docId === 1 ? undefined : docId;\n}\nfunction serializeTextNode(n, options) {\n  var _a;\n  var maskTextClass = options.maskTextClass,\n    maskTextSelector = options.maskTextSelector,\n    maskTextFn = options.maskTextFn,\n    rootId = options.rootId;\n  var parentTagName = n.parentNode && n.parentNode.tagName;\n  var textContent = n.textContent;\n  var isStyle = parentTagName === 'STYLE' ? true : undefined;\n  var isScript = parentTagName === 'SCRIPT' ? true : undefined;\n  if (isStyle && textContent) {\n    try {\n      if (n.nextSibling || n.previousSibling) {} else if ((_a = n.parentNode.sheet) === null || _a === void 0 ? void 0 : _a.cssRules) {\n        textContent = stringifyStyleSheet(n.parentNode.sheet);\n      }\n    } catch (err) {\n      console.warn(\"Cannot get CSS styles from text's parentNode. Error: \".concat(err), n);\n    }\n    textContent = absoluteToStylesheet(textContent, getHref());\n  }\n  if (isScript) {\n    textContent = 'SCRIPT_PLACEHOLDER';\n  }\n  if (!isStyle && !isScript && textContent && needMaskingText(n, maskTextClass, maskTextSelector)) {\n    textContent = maskTextFn ? maskTextFn(textContent) : textContent.replace(/[\\S]/g, '*');\n  }\n  return {\n    type: NodeType.Text,\n    textContent: textContent || '',\n    isStyle: isStyle,\n    rootId: rootId\n  };\n}\nfunction serializeElementNode(n, options) {\n  var doc = options.doc,\n    blockClass = options.blockClass,\n    blockSelector = options.blockSelector,\n    inlineStylesheet = options.inlineStylesheet,\n    _a = options.maskInputOptions,\n    maskInputOptions = _a === void 0 ? {} : _a,\n    maskInputFn = options.maskInputFn,\n    _b = options.dataURLOptions,\n    dataURLOptions = _b === void 0 ? {} : _b,\n    inlineImages = options.inlineImages,\n    recordCanvas = options.recordCanvas,\n    keepIframeSrcFn = options.keepIframeSrcFn,\n    _c = options.newlyAddedElement,\n    newlyAddedElement = _c === void 0 ? false : _c,\n    rootId = options.rootId;\n  var needBlock = _isBlockedElement(n, blockClass, blockSelector);\n  var tagName = getValidTagName(n);\n  var attributes = {};\n  var len = n.attributes.length;\n  for (var i = 0; i < len; i++) {\n    var attr = n.attributes[i];\n    attributes[attr.name] = transformAttribute(doc, tagName, attr.name, attr.value);\n  }\n  if (tagName === 'link' && inlineStylesheet) {\n    var stylesheet = Array.from(doc.styleSheets).find(function (s) {\n      return s.href === n.href;\n    });\n    var cssText = null;\n    if (stylesheet) {\n      cssText = getCssRulesString(stylesheet);\n    }\n    if (cssText) {\n      delete attributes.rel;\n      delete attributes.href;\n      attributes._cssText = absoluteToStylesheet(cssText, stylesheet.href);\n    }\n  }\n  if (tagName === 'style' && n.sheet && !(n.innerText || n.textContent || '').trim().length) {\n    var cssText = getCssRulesString(n.sheet);\n    if (cssText) {\n      attributes._cssText = absoluteToStylesheet(cssText, getHref());\n    }\n  }\n  if (tagName === 'input' || tagName === 'textarea' || tagName === 'select') {\n    var value = n.value;\n    var checked = n.checked;\n    if (attributes.type !== 'radio' && attributes.type !== 'checkbox' && attributes.type !== 'submit' && attributes.type !== 'button' && value) {\n      attributes.value = maskInputValue({\n        type: attributes.type,\n        tagName: tagName,\n        value: value,\n        maskInputOptions: maskInputOptions,\n        maskInputFn: maskInputFn\n      });\n    } else if (checked) {\n      attributes.checked = checked;\n    }\n  }\n  if (tagName === 'option') {\n    if (n.selected && !maskInputOptions['select']) {\n      attributes.selected = true;\n    } else {\n      delete attributes.selected;\n    }\n  }\n  if (tagName === 'canvas' && recordCanvas) {\n    if (n.__context === '2d') {\n      if (!is2DCanvasBlank(n)) {\n        attributes.rr_dataURL = n.toDataURL(dataURLOptions.type, dataURLOptions.quality);\n      }\n    } else if (!('__context' in n)) {\n      var canvasDataURL = n.toDataURL(dataURLOptions.type, dataURLOptions.quality);\n      var blankCanvas = document.createElement('canvas');\n      blankCanvas.width = n.width;\n      blankCanvas.height = n.height;\n      var blankCanvasDataURL = blankCanvas.toDataURL(dataURLOptions.type, dataURLOptions.quality);\n      if (canvasDataURL !== blankCanvasDataURL) {\n        attributes.rr_dataURL = canvasDataURL;\n      }\n    }\n  }\n  if (tagName === 'img' && inlineImages) {\n    if (!canvasService) {\n      canvasService = doc.createElement('canvas');\n      canvasCtx = canvasService.getContext('2d');\n    }\n    var image_1 = n;\n    var oldValue_1 = image_1.crossOrigin;\n    image_1.crossOrigin = 'anonymous';\n    var recordInlineImage = function () {\n      try {\n        canvasService.width = image_1.naturalWidth;\n        canvasService.height = image_1.naturalHeight;\n        canvasCtx.drawImage(image_1, 0, 0);\n        attributes.rr_dataURL = canvasService.toDataURL(dataURLOptions.type, dataURLOptions.quality);\n      } catch (err) {\n        console.warn(\"Cannot inline img src=\".concat(image_1.currentSrc, \"! Error: \").concat(err));\n      }\n      oldValue_1 ? attributes.crossOrigin = oldValue_1 : image_1.removeAttribute('crossorigin');\n    };\n    if (image_1.complete && image_1.naturalWidth !== 0) recordInlineImage();else image_1.onload = recordInlineImage;\n  }\n  if (tagName === 'audio' || tagName === 'video') {\n    attributes.rr_mediaState = n.paused ? 'paused' : 'played';\n    attributes.rr_mediaCurrentTime = n.currentTime;\n  }\n  if (!newlyAddedElement) {\n    if (n.scrollLeft) {\n      attributes.rr_scrollLeft = n.scrollLeft;\n    }\n    if (n.scrollTop) {\n      attributes.rr_scrollTop = n.scrollTop;\n    }\n  }\n  if (needBlock) {\n    var _d = n.getBoundingClientRect(),\n      width = _d.width,\n      height = _d.height;\n    attributes = {\n      \"class\": attributes[\"class\"],\n      rr_width: \"\".concat(width, \"px\"),\n      rr_height: \"\".concat(height, \"px\")\n    };\n  }\n  if (tagName === 'iframe' && !keepIframeSrcFn(attributes.src)) {\n    if (!n.contentDocument) {\n      attributes.rr_src = attributes.src;\n    }\n    delete attributes.src;\n  }\n  return {\n    type: NodeType.Element,\n    tagName: tagName,\n    attributes: attributes,\n    childNodes: [],\n    isSVG: isSVGElement(n) || undefined,\n    needBlock: needBlock,\n    rootId: rootId\n  };\n}\nfunction lowerIfExists(maybeAttr) {\n  if (maybeAttr === undefined) {\n    return '';\n  } else {\n    return maybeAttr.toLowerCase();\n  }\n}\nfunction slimDOMExcluded(sn, slimDOMOptions) {\n  if (slimDOMOptions.comment && sn.type === NodeType.Comment) {\n    return true;\n  } else if (sn.type === NodeType.Element) {\n    if (slimDOMOptions.script && (sn.tagName === 'script' || sn.tagName === 'link' && sn.attributes.rel === 'preload' && sn.attributes.as === 'script' || sn.tagName === 'link' && sn.attributes.rel === 'prefetch' && typeof sn.attributes.href === 'string' && sn.attributes.href.endsWith('.js'))) {\n      return true;\n    } else if (slimDOMOptions.headFavicon && (sn.tagName === 'link' && sn.attributes.rel === 'shortcut icon' || sn.tagName === 'meta' && (lowerIfExists(sn.attributes.name).match(/^msapplication-tile(image|color)$/) || lowerIfExists(sn.attributes.name) === 'application-name' || lowerIfExists(sn.attributes.rel) === 'icon' || lowerIfExists(sn.attributes.rel) === 'apple-touch-icon' || lowerIfExists(sn.attributes.rel) === 'shortcut icon'))) {\n      return true;\n    } else if (sn.tagName === 'meta') {\n      if (slimDOMOptions.headMetaDescKeywords && lowerIfExists(sn.attributes.name).match(/^description|keywords$/)) {\n        return true;\n      } else if (slimDOMOptions.headMetaSocial && (lowerIfExists(sn.attributes.property).match(/^(og|twitter|fb):/) || lowerIfExists(sn.attributes.name).match(/^(og|twitter):/) || lowerIfExists(sn.attributes.name) === 'pinterest')) {\n        return true;\n      } else if (slimDOMOptions.headMetaRobots && (lowerIfExists(sn.attributes.name) === 'robots' || lowerIfExists(sn.attributes.name) === 'googlebot' || lowerIfExists(sn.attributes.name) === 'bingbot')) {\n        return true;\n      } else if (slimDOMOptions.headMetaHttpEquiv && sn.attributes['http-equiv'] !== undefined) {\n        return true;\n      } else if (slimDOMOptions.headMetaAuthorship && (lowerIfExists(sn.attributes.name) === 'author' || lowerIfExists(sn.attributes.name) === 'generator' || lowerIfExists(sn.attributes.name) === 'framework' || lowerIfExists(sn.attributes.name) === 'publisher' || lowerIfExists(sn.attributes.name) === 'progid' || lowerIfExists(sn.attributes.property).match(/^article:/) || lowerIfExists(sn.attributes.property).match(/^product:/))) {\n        return true;\n      } else if (slimDOMOptions.headMetaVerification && (lowerIfExists(sn.attributes.name) === 'google-site-verification' || lowerIfExists(sn.attributes.name) === 'yandex-verification' || lowerIfExists(sn.attributes.name) === 'csrf-token' || lowerIfExists(sn.attributes.name) === 'p:domain_verify' || lowerIfExists(sn.attributes.name) === 'verify-v1' || lowerIfExists(sn.attributes.name) === 'verification' || lowerIfExists(sn.attributes.name) === 'shopify-checkout-api-token')) {\n        return true;\n      }\n    }\n  }\n  return false;\n}\nfunction serializeNodeWithId(n, options) {\n  var doc = options.doc,\n    mirror = options.mirror,\n    blockClass = options.blockClass,\n    blockSelector = options.blockSelector,\n    maskTextClass = options.maskTextClass,\n    maskTextSelector = options.maskTextSelector,\n    _a = options.skipChild,\n    skipChild = _a === void 0 ? false : _a,\n    _b = options.inlineStylesheet,\n    inlineStylesheet = _b === void 0 ? true : _b,\n    _c = options.maskInputOptions,\n    maskInputOptions = _c === void 0 ? {} : _c,\n    maskTextFn = options.maskTextFn,\n    maskInputFn = options.maskInputFn,\n    slimDOMOptions = options.slimDOMOptions,\n    _d = options.dataURLOptions,\n    dataURLOptions = _d === void 0 ? {} : _d,\n    _e = options.inlineImages,\n    inlineImages = _e === void 0 ? false : _e,\n    _f = options.recordCanvas,\n    recordCanvas = _f === void 0 ? false : _f,\n    onSerialize = options.onSerialize,\n    onIframeLoad = options.onIframeLoad,\n    _g = options.iframeLoadTimeout,\n    iframeLoadTimeout = _g === void 0 ? 5000 : _g,\n    onStylesheetLoad = options.onStylesheetLoad,\n    _h = options.stylesheetLoadTimeout,\n    stylesheetLoadTimeout = _h === void 0 ? 5000 : _h,\n    _j = options.keepIframeSrcFn,\n    keepIframeSrcFn = _j === void 0 ? function () {\n      return false;\n    } : _j,\n    _k = options.newlyAddedElement,\n    newlyAddedElement = _k === void 0 ? false : _k;\n  var _l = options.preserveWhiteSpace,\n    preserveWhiteSpace = _l === void 0 ? true : _l;\n  var _serializedNode = serializeNode(n, {\n    doc: doc,\n    mirror: mirror,\n    blockClass: blockClass,\n    blockSelector: blockSelector,\n    maskTextClass: maskTextClass,\n    maskTextSelector: maskTextSelector,\n    inlineStylesheet: inlineStylesheet,\n    maskInputOptions: maskInputOptions,\n    maskTextFn: maskTextFn,\n    maskInputFn: maskInputFn,\n    dataURLOptions: dataURLOptions,\n    inlineImages: inlineImages,\n    recordCanvas: recordCanvas,\n    keepIframeSrcFn: keepIframeSrcFn,\n    newlyAddedElement: newlyAddedElement\n  });\n  if (!_serializedNode) {\n    console.warn(n, 'not serialized');\n    return null;\n  }\n  var id;\n  if (mirror.hasNode(n)) {\n    id = mirror.getId(n);\n  } else if (slimDOMExcluded(_serializedNode, slimDOMOptions) || !preserveWhiteSpace && _serializedNode.type === NodeType.Text && !_serializedNode.isStyle && !_serializedNode.textContent.replace(/^\\s+|\\s+$/gm, '').length) {\n    id = IGNORED_NODE;\n  } else {\n    id = genId();\n  }\n  var serializedNode = Object.assign(_serializedNode, {\n    id: id\n  });\n  mirror.add(n, serializedNode);\n  if (id === IGNORED_NODE) {\n    return null;\n  }\n  if (onSerialize) {\n    onSerialize(n);\n  }\n  var recordChild = !skipChild;\n  if (serializedNode.type === NodeType.Element) {\n    recordChild = recordChild && !serializedNode.needBlock;\n    delete serializedNode.needBlock;\n    var shadowRoot = n.shadowRoot;\n    if (shadowRoot && isNativeShadowDom(shadowRoot)) serializedNode.isShadowHost = true;\n  }\n  if ((serializedNode.type === NodeType.Document || serializedNode.type === NodeType.Element) && recordChild) {\n    if (slimDOMOptions.headWhitespace && serializedNode.type === NodeType.Element && serializedNode.tagName === 'head') {\n      preserveWhiteSpace = false;\n    }\n    var bypassOptions = {\n      doc: doc,\n      mirror: mirror,\n      blockClass: blockClass,\n      blockSelector: blockSelector,\n      maskTextClass: maskTextClass,\n      maskTextSelector: maskTextSelector,\n      skipChild: skipChild,\n      inlineStylesheet: inlineStylesheet,\n      maskInputOptions: maskInputOptions,\n      maskTextFn: maskTextFn,\n      maskInputFn: maskInputFn,\n      slimDOMOptions: slimDOMOptions,\n      dataURLOptions: dataURLOptions,\n      inlineImages: inlineImages,\n      recordCanvas: recordCanvas,\n      preserveWhiteSpace: preserveWhiteSpace,\n      onSerialize: onSerialize,\n      onIframeLoad: onIframeLoad,\n      iframeLoadTimeout: iframeLoadTimeout,\n      onStylesheetLoad: onStylesheetLoad,\n      stylesheetLoadTimeout: stylesheetLoadTimeout,\n      keepIframeSrcFn: keepIframeSrcFn\n    };\n    for (var _i = 0, _m = Array.from(n.childNodes); _i < _m.length; _i++) {\n      var childN = _m[_i];\n      var serializedChildNode = serializeNodeWithId(childN, bypassOptions);\n      if (serializedChildNode) {\n        serializedNode.childNodes.push(serializedChildNode);\n      }\n    }\n    if (isElement(n) && n.shadowRoot) {\n      for (var _o = 0, _p = Array.from(n.shadowRoot.childNodes); _o < _p.length; _o++) {\n        var childN = _p[_o];\n        var serializedChildNode = serializeNodeWithId(childN, bypassOptions);\n        if (serializedChildNode) {\n          isNativeShadowDom(n.shadowRoot) && (serializedChildNode.isShadow = true);\n          serializedNode.childNodes.push(serializedChildNode);\n        }\n      }\n    }\n  }\n  if (n.parentNode && isShadowRoot(n.parentNode) && isNativeShadowDom(n.parentNode)) {\n    serializedNode.isShadow = true;\n  }\n  if (serializedNode.type === NodeType.Element && serializedNode.tagName === 'iframe') {\n    onceIframeLoaded(n, function () {\n      var iframeDoc = n.contentDocument;\n      if (iframeDoc && onIframeLoad) {\n        var serializedIframeNode = serializeNodeWithId(iframeDoc, {\n          doc: iframeDoc,\n          mirror: mirror,\n          blockClass: blockClass,\n          blockSelector: blockSelector,\n          maskTextClass: maskTextClass,\n          maskTextSelector: maskTextSelector,\n          skipChild: false,\n          inlineStylesheet: inlineStylesheet,\n          maskInputOptions: maskInputOptions,\n          maskTextFn: maskTextFn,\n          maskInputFn: maskInputFn,\n          slimDOMOptions: slimDOMOptions,\n          dataURLOptions: dataURLOptions,\n          inlineImages: inlineImages,\n          recordCanvas: recordCanvas,\n          preserveWhiteSpace: preserveWhiteSpace,\n          onSerialize: onSerialize,\n          onIframeLoad: onIframeLoad,\n          iframeLoadTimeout: iframeLoadTimeout,\n          onStylesheetLoad: onStylesheetLoad,\n          stylesheetLoadTimeout: stylesheetLoadTimeout,\n          keepIframeSrcFn: keepIframeSrcFn\n        });\n        if (serializedIframeNode) {\n          onIframeLoad(n, serializedIframeNode);\n        }\n      }\n    }, iframeLoadTimeout);\n  }\n  if (serializedNode.type === NodeType.Element && serializedNode.tagName === 'link' && serializedNode.attributes.rel === 'stylesheet') {\n    onceStylesheetLoaded(n, function () {\n      if (onStylesheetLoad) {\n        var serializedLinkNode = serializeNodeWithId(n, {\n          doc: doc,\n          mirror: mirror,\n          blockClass: blockClass,\n          blockSelector: blockSelector,\n          maskTextClass: maskTextClass,\n          maskTextSelector: maskTextSelector,\n          skipChild: false,\n          inlineStylesheet: inlineStylesheet,\n          maskInputOptions: maskInputOptions,\n          maskTextFn: maskTextFn,\n          maskInputFn: maskInputFn,\n          slimDOMOptions: slimDOMOptions,\n          dataURLOptions: dataURLOptions,\n          inlineImages: inlineImages,\n          recordCanvas: recordCanvas,\n          preserveWhiteSpace: preserveWhiteSpace,\n          onSerialize: onSerialize,\n          onIframeLoad: onIframeLoad,\n          iframeLoadTimeout: iframeLoadTimeout,\n          onStylesheetLoad: onStylesheetLoad,\n          stylesheetLoadTimeout: stylesheetLoadTimeout,\n          keepIframeSrcFn: keepIframeSrcFn\n        });\n        if (serializedLinkNode) {\n          onStylesheetLoad(n, serializedLinkNode);\n        }\n      }\n    }, stylesheetLoadTimeout);\n  }\n  return serializedNode;\n}\nfunction snapshot(n, options) {\n  var _a = options || {},\n    _b = _a.mirror,\n    mirror = _b === void 0 ? new Mirror() : _b,\n    _c = _a.blockClass,\n    blockClass = _c === void 0 ? 'rr-block' : _c,\n    _d = _a.blockSelector,\n    blockSelector = _d === void 0 ? null : _d,\n    _e = _a.maskTextClass,\n    maskTextClass = _e === void 0 ? 'rr-mask' : _e,\n    _f = _a.maskTextSelector,\n    maskTextSelector = _f === void 0 ? null : _f,\n    _g = _a.inlineStylesheet,\n    inlineStylesheet = _g === void 0 ? true : _g,\n    _h = _a.inlineImages,\n    inlineImages = _h === void 0 ? false : _h,\n    _j = _a.recordCanvas,\n    recordCanvas = _j === void 0 ? false : _j,\n    _k = _a.maskAllInputs,\n    maskAllInputs = _k === void 0 ? false : _k,\n    maskTextFn = _a.maskTextFn,\n    maskInputFn = _a.maskInputFn,\n    _l = _a.slimDOM,\n    slimDOM = _l === void 0 ? false : _l,\n    dataURLOptions = _a.dataURLOptions,\n    preserveWhiteSpace = _a.preserveWhiteSpace,\n    onSerialize = _a.onSerialize,\n    onIframeLoad = _a.onIframeLoad,\n    iframeLoadTimeout = _a.iframeLoadTimeout,\n    onStylesheetLoad = _a.onStylesheetLoad,\n    stylesheetLoadTimeout = _a.stylesheetLoadTimeout,\n    _m = _a.keepIframeSrcFn,\n    keepIframeSrcFn = _m === void 0 ? function () {\n      return false;\n    } : _m;\n  var maskInputOptions = maskAllInputs === true ? {\n    color: true,\n    date: true,\n    'datetime-local': true,\n    email: true,\n    month: true,\n    number: true,\n    range: true,\n    search: true,\n    tel: true,\n    text: true,\n    time: true,\n    url: true,\n    week: true,\n    textarea: true,\n    select: true,\n    password: true\n  } : maskAllInputs === false ? {\n    password: true\n  } : maskAllInputs;\n  var slimDOMOptions = slimDOM === true || slimDOM === 'all' ? {\n    script: true,\n    comment: true,\n    headFavicon: true,\n    headWhitespace: true,\n    headMetaDescKeywords: slimDOM === 'all',\n    headMetaSocial: true,\n    headMetaRobots: true,\n    headMetaHttpEquiv: true,\n    headMetaAuthorship: true,\n    headMetaVerification: true\n  } : slimDOM === false ? {} : slimDOM;\n  return serializeNodeWithId(n, {\n    doc: n,\n    mirror: mirror,\n    blockClass: blockClass,\n    blockSelector: blockSelector,\n    maskTextClass: maskTextClass,\n    maskTextSelector: maskTextSelector,\n    skipChild: false,\n    inlineStylesheet: inlineStylesheet,\n    maskInputOptions: maskInputOptions,\n    maskTextFn: maskTextFn,\n    maskInputFn: maskInputFn,\n    slimDOMOptions: slimDOMOptions,\n    dataURLOptions: dataURLOptions,\n    inlineImages: inlineImages,\n    recordCanvas: recordCanvas,\n    preserveWhiteSpace: preserveWhiteSpace,\n    onSerialize: onSerialize,\n    onIframeLoad: onIframeLoad,\n    iframeLoadTimeout: iframeLoadTimeout,\n    onStylesheetLoad: onStylesheetLoad,\n    stylesheetLoadTimeout: stylesheetLoadTimeout,\n    keepIframeSrcFn: keepIframeSrcFn,\n    newlyAddedElement: false\n  });\n}\nfunction visitSnapshot(node, onVisit) {\n  function walk(current) {\n    onVisit(current);\n    if (current.type === NodeType.Document || current.type === NodeType.Element) {\n      current.childNodes.forEach(walk);\n    }\n  }\n  walk(node);\n}\nfunction cleanupSnapshot() {\n  _id = 1;\n}\nvar commentre = /\\/\\*[^*]*\\*+([^/*][^*]*\\*+)*\\//g;\nfunction parse(css, options) {\n  if (options === void 0) {\n    options = {};\n  }\n  var lineno = 1;\n  var column = 1;\n  function updatePosition(str) {\n    var lines = str.match(/\\n/g);\n    if (lines) {\n      lineno += lines.length;\n    }\n    var i = str.lastIndexOf('\\n');\n    column = i === -1 ? column + str.length : str.length - i;\n  }\n  function position() {\n    var start = {\n      line: lineno,\n      column: column\n    };\n    return function (node) {\n      node.position = new Position(start);\n      whitespace();\n      return node;\n    };\n  }\n  var Position = function () {\n    function Position(start) {\n      this.start = start;\n      this.end = {\n        line: lineno,\n        column: column\n      };\n      this.source = options.source;\n    }\n    return Position;\n  }();\n  Position.prototype.content = css;\n  var errorsList = [];\n  function error(msg) {\n    var err = new Error(\"\".concat(options.source || '', \":\").concat(lineno, \":\").concat(column, \": \").concat(msg));\n    err.reason = msg;\n    err.filename = options.source;\n    err.line = lineno;\n    err.column = column;\n    err.source = css;\n    if (options.silent) {\n      errorsList.push(err);\n    } else {\n      throw err;\n    }\n  }\n  function stylesheet() {\n    var rulesList = rules();\n    return {\n      type: 'stylesheet',\n      stylesheet: {\n        source: options.source,\n        rules: rulesList,\n        parsingErrors: errorsList\n      }\n    };\n  }\n  function open() {\n    return match(/^{\\s*/);\n  }\n  function close() {\n    return match(/^}/);\n  }\n  function rules() {\n    var node;\n    var rules = [];\n    whitespace();\n    comments(rules);\n    while (css.length && css.charAt(0) !== '}' && (node = atrule() || rule())) {\n      if (node !== false) {\n        rules.push(node);\n        comments(rules);\n      }\n    }\n    return rules;\n  }\n  function match(re) {\n    var m = re.exec(css);\n    if (!m) {\n      return;\n    }\n    var str = m[0];\n    updatePosition(str);\n    css = css.slice(str.length);\n    return m;\n  }\n  function whitespace() {\n    match(/^\\s*/);\n  }\n  function comments(rules) {\n    if (rules === void 0) {\n      rules = [];\n    }\n    var c;\n    while (c = comment()) {\n      if (c !== false) {\n        rules.push(c);\n      }\n      c = comment();\n    }\n    return rules;\n  }\n  function comment() {\n    var pos = position();\n    if ('/' !== css.charAt(0) || '*' !== css.charAt(1)) {\n      return;\n    }\n    var i = 2;\n    while ('' !== css.charAt(i) && ('*' !== css.charAt(i) || '/' !== css.charAt(i + 1))) {\n      ++i;\n    }\n    i += 2;\n    if ('' === css.charAt(i - 1)) {\n      return error('End of comment missing');\n    }\n    var str = css.slice(2, i - 2);\n    column += 2;\n    updatePosition(str);\n    css = css.slice(i);\n    column += 2;\n    return pos({\n      type: 'comment',\n      comment: str\n    });\n  }\n  function selector() {\n    var m = match(/^([^{]+)/);\n    if (!m) {\n      return;\n    }\n    return trim(m[0]).replace(/\\/\\*([^*]|[\\r\\n]|(\\*+([^*/]|[\\r\\n])))*\\*\\/+/g, '').replace(/\"(?:\\\\\"|[^\"])*\"|'(?:\\\\'|[^'])*'/g, function (m) {\n      return m.replace(/,/g, '\\u200C');\n    }).split(/\\s*(?![^(]*\\)),\\s*/).map(function (s) {\n      return s.replace(/\\u200C/g, ',');\n    });\n  }\n  function declaration() {\n    var pos = position();\n    var propMatch = match(/^(\\*?[-#\\/\\*\\\\\\w]+(\\[[0-9a-z_-]+\\])?)\\s*/);\n    if (!propMatch) {\n      return;\n    }\n    var prop = trim(propMatch[0]);\n    if (!match(/^:\\s*/)) {\n      return error(\"property missing ':'\");\n    }\n    var val = match(/^((?:'(?:\\\\'|.)*?'|\"(?:\\\\\"|.)*?\"|\\([^\\)]*?\\)|[^};])+)/);\n    var ret = pos({\n      type: 'declaration',\n      property: prop.replace(commentre, ''),\n      value: val ? trim(val[0]).replace(commentre, '') : ''\n    });\n    match(/^[;\\s]*/);\n    return ret;\n  }\n  function declarations() {\n    var decls = [];\n    if (!open()) {\n      return error(\"missing '{'\");\n    }\n    comments(decls);\n    var decl;\n    while (decl = declaration()) {\n      if (decl !== false) {\n        decls.push(decl);\n        comments(decls);\n      }\n      decl = declaration();\n    }\n    if (!close()) {\n      return error(\"missing '}'\");\n    }\n    return decls;\n  }\n  function keyframe() {\n    var m;\n    var vals = [];\n    var pos = position();\n    while (m = match(/^((\\d+\\.\\d+|\\.\\d+|\\d+)%?|[a-z]+)\\s*/)) {\n      vals.push(m[1]);\n      match(/^,\\s*/);\n    }\n    if (!vals.length) {\n      return;\n    }\n    return pos({\n      type: 'keyframe',\n      values: vals,\n      declarations: declarations()\n    });\n  }\n  function atkeyframes() {\n    var pos = position();\n    var m = match(/^@([-\\w]+)?keyframes\\s*/);\n    if (!m) {\n      return;\n    }\n    var vendor = m[1];\n    m = match(/^([-\\w]+)\\s*/);\n    if (!m) {\n      return error('@keyframes missing name');\n    }\n    var name = m[1];\n    if (!open()) {\n      return error(\"@keyframes missing '{'\");\n    }\n    var frame;\n    var frames = comments();\n    while (frame = keyframe()) {\n      frames.push(frame);\n      frames = frames.concat(comments());\n    }\n    if (!close()) {\n      return error(\"@keyframes missing '}'\");\n    }\n    return pos({\n      type: 'keyframes',\n      name: name,\n      vendor: vendor,\n      keyframes: frames\n    });\n  }\n  function atsupports() {\n    var pos = position();\n    var m = match(/^@supports *([^{]+)/);\n    if (!m) {\n      return;\n    }\n    var supports = trim(m[1]);\n    if (!open()) {\n      return error(\"@supports missing '{'\");\n    }\n    var style = comments().concat(rules());\n    if (!close()) {\n      return error(\"@supports missing '}'\");\n    }\n    return pos({\n      type: 'supports',\n      supports: supports,\n      rules: style\n    });\n  }\n  function athost() {\n    var pos = position();\n    var m = match(/^@host\\s*/);\n    if (!m) {\n      return;\n    }\n    if (!open()) {\n      return error(\"@host missing '{'\");\n    }\n    var style = comments().concat(rules());\n    if (!close()) {\n      return error(\"@host missing '}'\");\n    }\n    return pos({\n      type: 'host',\n      rules: style\n    });\n  }\n  function atmedia() {\n    var pos = position();\n    var m = match(/^@media *([^{]+)/);\n    if (!m) {\n      return;\n    }\n    var media = trim(m[1]);\n    if (!open()) {\n      return error(\"@media missing '{'\");\n    }\n    var style = comments().concat(rules());\n    if (!close()) {\n      return error(\"@media missing '}'\");\n    }\n    return pos({\n      type: 'media',\n      media: media,\n      rules: style\n    });\n  }\n  function atcustommedia() {\n    var pos = position();\n    var m = match(/^@custom-media\\s+(--[^\\s]+)\\s*([^{;]+);/);\n    if (!m) {\n      return;\n    }\n    return pos({\n      type: 'custom-media',\n      name: trim(m[1]),\n      media: trim(m[2])\n    });\n  }\n  function atpage() {\n    var pos = position();\n    var m = match(/^@page */);\n    if (!m) {\n      return;\n    }\n    var sel = selector() || [];\n    if (!open()) {\n      return error(\"@page missing '{'\");\n    }\n    var decls = comments();\n    var decl;\n    while (decl = declaration()) {\n      decls.push(decl);\n      decls = decls.concat(comments());\n    }\n    if (!close()) {\n      return error(\"@page missing '}'\");\n    }\n    return pos({\n      type: 'page',\n      selectors: sel,\n      declarations: decls\n    });\n  }\n  function atdocument() {\n    var pos = position();\n    var m = match(/^@([-\\w]+)?document *([^{]+)/);\n    if (!m) {\n      return;\n    }\n    var vendor = trim(m[1]);\n    var doc = trim(m[2]);\n    if (!open()) {\n      return error(\"@document missing '{'\");\n    }\n    var style = comments().concat(rules());\n    if (!close()) {\n      return error(\"@document missing '}'\");\n    }\n    return pos({\n      type: 'document',\n      document: doc,\n      vendor: vendor,\n      rules: style\n    });\n  }\n  function atfontface() {\n    var pos = position();\n    var m = match(/^@font-face\\s*/);\n    if (!m) {\n      return;\n    }\n    if (!open()) {\n      return error(\"@font-face missing '{'\");\n    }\n    var decls = comments();\n    var decl;\n    while (decl = declaration()) {\n      decls.push(decl);\n      decls = decls.concat(comments());\n    }\n    if (!close()) {\n      return error(\"@font-face missing '}'\");\n    }\n    return pos({\n      type: 'font-face',\n      declarations: decls\n    });\n  }\n  var atimport = _compileAtrule('import');\n  var atcharset = _compileAtrule('charset');\n  var atnamespace = _compileAtrule('namespace');\n  function _compileAtrule(name) {\n    var re = new RegExp('^@' + name + '\\\\s*([^;]+);');\n    return function () {\n      var pos = position();\n      var m = match(re);\n      if (!m) {\n        return;\n      }\n      var ret = {\n        type: name\n      };\n      ret[name] = m[1].trim();\n      return pos(ret);\n    };\n  }\n  function atrule() {\n    if (css[0] !== '@') {\n      return;\n    }\n    return atkeyframes() || atmedia() || atcustommedia() || atsupports() || atimport() || atcharset() || atnamespace() || atdocument() || atpage() || athost() || atfontface();\n  }\n  function rule() {\n    var pos = position();\n    var sel = selector();\n    if (!sel) {\n      return error('selector missing');\n    }\n    comments();\n    return pos({\n      type: 'rule',\n      selectors: sel,\n      declarations: declarations()\n    });\n  }\n  return addParent(stylesheet());\n}\nfunction trim(str) {\n  return str ? str.replace(/^\\s+|\\s+$/g, '') : '';\n}\nfunction addParent(obj, parent) {\n  var isNode = obj && typeof obj.type === 'string';\n  var childParent = isNode ? obj : parent;\n  for (var _i = 0, _a = Object.keys(obj); _i < _a.length; _i++) {\n    var k = _a[_i];\n    var value = obj[k];\n    if (Array.isArray(value)) {\n      value.forEach(function (v) {\n        addParent(v, childParent);\n      });\n    } else if (value && typeof value === 'object') {\n      addParent(value, childParent);\n    }\n  }\n  if (isNode) {\n    Object.defineProperty(obj, 'parent', {\n      configurable: true,\n      writable: true,\n      enumerable: false,\n      value: parent || null\n    });\n  }\n  return obj;\n}\nvar tagMap = {\n  script: 'noscript',\n  altglyph: 'altGlyph',\n  altglyphdef: 'altGlyphDef',\n  altglyphitem: 'altGlyphItem',\n  animatecolor: 'animateColor',\n  animatemotion: 'animateMotion',\n  animatetransform: 'animateTransform',\n  clippath: 'clipPath',\n  feblend: 'feBlend',\n  fecolormatrix: 'feColorMatrix',\n  fecomponenttransfer: 'feComponentTransfer',\n  fecomposite: 'feComposite',\n  feconvolvematrix: 'feConvolveMatrix',\n  fediffuselighting: 'feDiffuseLighting',\n  fedisplacementmap: 'feDisplacementMap',\n  fedistantlight: 'feDistantLight',\n  fedropshadow: 'feDropShadow',\n  feflood: 'feFlood',\n  fefunca: 'feFuncA',\n  fefuncb: 'feFuncB',\n  fefuncg: 'feFuncG',\n  fefuncr: 'feFuncR',\n  fegaussianblur: 'feGaussianBlur',\n  feimage: 'feImage',\n  femerge: 'feMerge',\n  femergenode: 'feMergeNode',\n  femorphology: 'feMorphology',\n  feoffset: 'feOffset',\n  fepointlight: 'fePointLight',\n  fespecularlighting: 'feSpecularLighting',\n  fespotlight: 'feSpotLight',\n  fetile: 'feTile',\n  feturbulence: 'feTurbulence',\n  foreignobject: 'foreignObject',\n  glyphref: 'glyphRef',\n  lineargradient: 'linearGradient',\n  radialgradient: 'radialGradient'\n};\nfunction getTagName(n) {\n  var tagName = tagMap[n.tagName] ? tagMap[n.tagName] : n.tagName;\n  if (tagName === 'link' && n.attributes._cssText) {\n    tagName = 'style';\n  }\n  return tagName;\n}\nfunction escapeRegExp(str) {\n  return str.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n}\nvar HOVER_SELECTOR = /([^\\\\]):hover/;\nvar HOVER_SELECTOR_GLOBAL = new RegExp(HOVER_SELECTOR.source, 'g');\nfunction addHoverClass(cssText, cache) {\n  var cachedStyle = cache === null || cache === void 0 ? void 0 : cache.stylesWithHoverClass.get(cssText);\n  if (cachedStyle) return cachedStyle;\n  var ast = parse(cssText, {\n    silent: true\n  });\n  if (!ast.stylesheet) {\n    return cssText;\n  }\n  var selectors = [];\n  ast.stylesheet.rules.forEach(function (rule) {\n    if ('selectors' in rule) {\n      (rule.selectors || []).forEach(function (selector) {\n        if (HOVER_SELECTOR.test(selector)) {\n          selectors.push(selector);\n        }\n      });\n    }\n  });\n  if (selectors.length === 0) {\n    return cssText;\n  }\n  var selectorMatcher = new RegExp(selectors.filter(function (selector, index) {\n    return selectors.indexOf(selector) === index;\n  }).sort(function (a, b) {\n    return b.length - a.length;\n  }).map(function (selector) {\n    return escapeRegExp(selector);\n  }).join('|'), 'g');\n  var result = cssText.replace(selectorMatcher, function (selector) {\n    var newSelector = selector.replace(HOVER_SELECTOR_GLOBAL, '$1.\\\\:hover');\n    return \"\".concat(selector, \", \").concat(newSelector);\n  });\n  cache === null || cache === void 0 ? void 0 : cache.stylesWithHoverClass.set(cssText, result);\n  return result;\n}\nfunction createCache() {\n  var stylesWithHoverClass = new Map();\n  return {\n    stylesWithHoverClass: stylesWithHoverClass\n  };\n}\nfunction buildNode(n, options) {\n  var doc = options.doc,\n    hackCss = options.hackCss,\n    cache = options.cache;\n  switch (n.type) {\n    case NodeType.Document:\n      return doc.implementation.createDocument(null, '', null);\n    case NodeType.DocumentType:\n      return doc.implementation.createDocumentType(n.name || 'html', n.publicId, n.systemId);\n    case NodeType.Element:\n      {\n        var tagName = getTagName(n);\n        var node_1;\n        if (n.isSVG) {\n          node_1 = doc.createElementNS('http://www.w3.org/2000/svg', tagName);\n        } else {\n          node_1 = doc.createElement(tagName);\n        }\n        var specialAttributes = {};\n        for (var name_1 in n.attributes) {\n          if (!Object.prototype.hasOwnProperty.call(n.attributes, name_1)) {\n            continue;\n          }\n          var value = n.attributes[name_1];\n          if (tagName === 'option' && name_1 === 'selected' && value === false) {\n            continue;\n          }\n          if (value === true) value = '';\n          if (name_1.startsWith('rr_')) {\n            specialAttributes[name_1] = value;\n            continue;\n          }\n          var isTextarea = tagName === 'textarea' && name_1 === 'value';\n          var isRemoteOrDynamicCss = tagName === 'style' && name_1 === '_cssText';\n          if (isRemoteOrDynamicCss && hackCss && typeof value === 'string') {\n            value = addHoverClass(value, cache);\n          }\n          if ((isTextarea || isRemoteOrDynamicCss) && typeof value === 'string') {\n            var child = doc.createTextNode(value);\n            for (var _i = 0, _a = Array.from(node_1.childNodes); _i < _a.length; _i++) {\n              var c = _a[_i];\n              if (c.nodeType === node_1.TEXT_NODE) {\n                node_1.removeChild(c);\n              }\n            }\n            node_1.appendChild(child);\n            continue;\n          }\n          try {\n            if (n.isSVG && name_1 === 'xlink:href') {\n              node_1.setAttributeNS('http://www.w3.org/1999/xlink', name_1, value.toString());\n            } else if (name_1 === 'onload' || name_1 === 'onclick' || name_1.substring(0, 7) === 'onmouse') {\n              node_1.setAttribute('_' + name_1, value.toString());\n            } else if (tagName === 'meta' && n.attributes['http-equiv'] === 'Content-Security-Policy' && name_1 === 'content') {\n              node_1.setAttribute('csp-content', value.toString());\n              continue;\n            } else if (tagName === 'link' && n.attributes.rel === 'preload' && n.attributes.as === 'script') {} else if (tagName === 'link' && n.attributes.rel === 'prefetch' && typeof n.attributes.href === 'string' && n.attributes.href.endsWith('.js')) {} else if (tagName === 'img' && n.attributes.srcset && n.attributes.rr_dataURL) {\n              node_1.setAttribute('rrweb-original-srcset', n.attributes.srcset);\n            } else {\n              node_1.setAttribute(name_1, value.toString());\n            }\n          } catch (error) {}\n        }\n        var _loop_1 = function (name_2) {\n          var value = specialAttributes[name_2];\n          if (tagName === 'canvas' && name_2 === 'rr_dataURL') {\n            var image_1 = document.createElement('img');\n            image_1.onload = function () {\n              var ctx = node_1.getContext('2d');\n              if (ctx) {\n                ctx.drawImage(image_1, 0, 0, image_1.width, image_1.height);\n              }\n            };\n            image_1.src = value.toString();\n            if (node_1.RRNodeType) node_1.rr_dataURL = value.toString();\n          } else if (tagName === 'img' && name_2 === 'rr_dataURL') {\n            var image = node_1;\n            if (!image.currentSrc.startsWith('data:')) {\n              image.setAttribute('rrweb-original-src', n.attributes.src);\n              image.src = value.toString();\n            }\n          }\n          if (name_2 === 'rr_width') {\n            node_1.style.width = value.toString();\n          } else if (name_2 === 'rr_height') {\n            node_1.style.height = value.toString();\n          } else if (name_2 === 'rr_mediaCurrentTime' && typeof value === 'number') {\n            node_1.currentTime = value;\n          } else if (name_2 === 'rr_mediaState') {\n            switch (value) {\n              case 'played':\n                node_1.play()[\"catch\"](function (e) {\n                  return console.warn('media playback error', e);\n                });\n                break;\n              case 'paused':\n                node_1.pause();\n                break;\n            }\n          }\n        };\n        for (var name_2 in specialAttributes) {\n          _loop_1(name_2);\n        }\n        if (n.isShadowHost) {\n          if (!node_1.shadowRoot) {\n            node_1.attachShadow({\n              mode: 'open'\n            });\n          } else {\n            while (node_1.shadowRoot.firstChild) {\n              node_1.shadowRoot.removeChild(node_1.shadowRoot.firstChild);\n            }\n          }\n        }\n        return node_1;\n      }\n    case NodeType.Text:\n      return doc.createTextNode(n.isStyle && hackCss ? addHoverClass(n.textContent, cache) : n.textContent);\n    case NodeType.CDATA:\n      return doc.createCDATASection(n.textContent);\n    case NodeType.Comment:\n      return doc.createComment(n.textContent);\n    default:\n      return null;\n  }\n}\nfunction buildNodeWithSN(n, options) {\n  var doc = options.doc,\n    mirror = options.mirror,\n    _a = options.skipChild,\n    skipChild = _a === void 0 ? false : _a,\n    _b = options.hackCss,\n    hackCss = _b === void 0 ? true : _b,\n    afterAppend = options.afterAppend,\n    cache = options.cache;\n  var node = buildNode(n, {\n    doc: doc,\n    hackCss: hackCss,\n    cache: cache\n  });\n  if (!node) {\n    return null;\n  }\n  if (n.rootId && mirror.getNode(n.rootId) !== doc) {\n    mirror.replace(n.rootId, doc);\n  }\n  if (n.type === NodeType.Document) {\n    doc.close();\n    doc.open();\n    if (n.compatMode === 'BackCompat' && n.childNodes && n.childNodes[0].type !== NodeType.DocumentType) {\n      if (n.childNodes[0].type === NodeType.Element && 'xmlns' in n.childNodes[0].attributes && n.childNodes[0].attributes.xmlns === 'http://www.w3.org/1999/xhtml') {\n        doc.write('<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"\">');\n      } else {\n        doc.write('<!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.0 Transitional//EN\" \"\">');\n      }\n    }\n    node = doc;\n  }\n  mirror.add(node, n);\n  if ((n.type === NodeType.Document || n.type === NodeType.Element) && !skipChild) {\n    for (var _i = 0, _c = n.childNodes; _i < _c.length; _i++) {\n      var childN = _c[_i];\n      var childNode = buildNodeWithSN(childN, {\n        doc: doc,\n        mirror: mirror,\n        skipChild: false,\n        hackCss: hackCss,\n        afterAppend: afterAppend,\n        cache: cache\n      });\n      if (!childNode) {\n        console.warn('Failed to rebuild', childN);\n        continue;\n      }\n      if (childN.isShadow && isElement(node) && node.shadowRoot) {\n        node.shadowRoot.appendChild(childNode);\n      } else {\n        node.appendChild(childNode);\n      }\n      if (afterAppend) {\n        afterAppend(childNode, childN.id);\n      }\n    }\n  }\n  return node;\n}\nfunction visit(mirror, onVisit) {\n  function walk(node) {\n    onVisit(node);\n  }\n  for (var _i = 0, _a = mirror.getIds(); _i < _a.length; _i++) {\n    var id = _a[_i];\n    if (mirror.has(id)) {\n      walk(mirror.getNode(id));\n    }\n  }\n}\nfunction handleScroll(node, mirror) {\n  var n = mirror.getMeta(node);\n  if ((n === null || n === void 0 ? void 0 : n.type) !== NodeType.Element) {\n    return;\n  }\n  var el = node;\n  for (var name_3 in n.attributes) {\n    if (!(Object.prototype.hasOwnProperty.call(n.attributes, name_3) && name_3.startsWith('rr_'))) {\n      continue;\n    }\n    var value = n.attributes[name_3];\n    if (name_3 === 'rr_scrollLeft') {\n      el.scrollLeft = value;\n    }\n    if (name_3 === 'rr_scrollTop') {\n      el.scrollTop = value;\n    }\n  }\n}\nfunction rebuild(n, options) {\n  var doc = options.doc,\n    onVisit = options.onVisit,\n    _a = options.hackCss,\n    hackCss = _a === void 0 ? true : _a,\n    afterAppend = options.afterAppend,\n    cache = options.cache,\n    _b = options.mirror,\n    mirror = _b === void 0 ? new Mirror() : _b;\n  var node = buildNodeWithSN(n, {\n    doc: doc,\n    mirror: mirror,\n    skipChild: false,\n    hackCss: hackCss,\n    afterAppend: afterAppend,\n    cache: cache\n  });\n  visit(mirror, function (visitedNode) {\n    if (onVisit) {\n      onVisit(visitedNode);\n    }\n    handleScroll(visitedNode, mirror);\n  });\n  return node;\n}\nexport { IGNORED_NODE, Mirror, NodeType, addHoverClass, buildNodeWithSN, classMatchesRegex, cleanupSnapshot, createCache, createMirror, genId, getCssRuleString, getCssRulesString, is2DCanvasBlank, isCSSImportRule, isElement, isNativeShadowDom, isShadowRoot, maskInputValue, needMaskingText, rebuild, serializeNodeWithId, snapshot, transformAttribute, visitSnapshot };","map":{"version":3,"names":["NodeType","isElement","n","nodeType","ELEMENT_NODE","isShadowRoot","host","Boolean","shadowRoot","isNativeShadowDom","Object","prototype","toString","call","fixBrowserCompatibilityIssuesInCSS","cssText","includes","replace","getCssRulesString","s","rules","cssRules","Array","from","map","getCssRuleString","join","error","rule","cssStringified","isCSSImportRule","styleSheet","_a","Mirror","idNodeMap","Map","nodeMetaMap","WeakMap","getId","id","getMeta","getNode","get","getIds","keys","removeNodeFromMap","_this","childNodes","forEach","childNode","has","hasNode","node","add","meta","set","oldNode","reset","createMirror","maskInputValue","maskInputOptions","tagName","type","value","maskInputFn","text","toLowerCase","repeat","length","ORIGINAL_ATTRIBUTE_NAME","is2DCanvasBlank","canvas","ctx","getContext","chunkSize","x","width","y","height","getImageData","originalGetImageData","pixelBuffer","Uint32Array","Math","min","data","buffer","some","pixel","_id","tagNameRegex","RegExp","IGNORED_NODE","genId","getValidTagName","element","HTMLFormElement","processedTagName","trim","test","stringifyStyleSheet","sheet","extractOrigin","url","origin","indexOf","split","slice","canvasService","canvasCtx","URL_IN_CSS_REF","RELATIVE_PATH","DATA_URI","absoluteToStylesheet","href","quote1","path1","quote2","path2","path3","filePath","maybeQuote","concat","stack","parts","pop","_i","parts_1","part","push","SRCSET_NOT_SPACES","SRCSET_COMMAS_OR_SPACES","getAbsoluteSrcsetString","doc","attributeValue","pos","collectCharacters","regEx","chars","match","exec","substring","output","absoluteToDoc","descriptorsStr","inParens","c","charAt","a","createElement","isSVGElement","el","ownerSVGElement","getHref","document","transformAttribute","name","_isBlockedElement","blockClass","blockSelector","classList","contains","eIndex","className","matches","classMatchesRegex","regex","checkAncestors","parentNode","needMaskingText","maskTextClass","maskTextSelector","parentElement","closest","onceIframeLoaded","iframeEl","listener","iframeLoadTimeout","win","contentWindow","fired","readyState","timer_1","setTimeout","addEventListener","clearTimeout","blankUrl","location","src","onceStylesheetLoaded","link","styleSheetLoadTimeout","styleSheetLoaded","timer","serializeNode","options","mirror","inlineStylesheet","maskTextFn","_b","dataURLOptions","inlineImages","recordCanvas","keepIframeSrcFn","_c","newlyAddedElement","rootId","getRootId","DOCUMENT_NODE","compatMode","Document","DOCUMENT_TYPE_NODE","DocumentType","publicId","systemId","serializeElementNode","TEXT_NODE","serializeTextNode","CDATA_SECTION_NODE","CDATA","textContent","COMMENT_NODE","Comment","undefined","docId","parentTagName","isStyle","isScript","nextSibling","previousSibling","err","console","warn","Text","needBlock","attributes","len","i","attr","stylesheet","styleSheets","find","rel","_cssText","innerText","checked","selected","__context","rr_dataURL","toDataURL","quality","canvasDataURL","blankCanvas","blankCanvasDataURL","image_1","oldValue_1","crossOrigin","recordInlineImage","naturalWidth","naturalHeight","drawImage","currentSrc","removeAttribute","complete","onload","rr_mediaState","paused","rr_mediaCurrentTime","currentTime","scrollLeft","rr_scrollLeft","scrollTop","rr_scrollTop","_d","getBoundingClientRect","rr_width","rr_height","contentDocument","rr_src","Element","isSVG","lowerIfExists","maybeAttr","slimDOMExcluded","sn","slimDOMOptions","comment","script","as","endsWith","headFavicon","headMetaDescKeywords","headMetaSocial","property","headMetaRobots","headMetaHttpEquiv","headMetaAuthorship","headMetaVerification","serializeNodeWithId","skipChild","_e","_f","onSerialize","onIframeLoad","_g","onStylesheetLoad","_h","stylesheetLoadTimeout","_j","_k","_l","preserveWhiteSpace","_serializedNode","serializedNode","assign","recordChild","isShadowHost","headWhitespace","bypassOptions","_m","childN","serializedChildNode","_o","_p","isShadow","iframeDoc","serializedIframeNode","serializedLinkNode","snapshot","maskAllInputs","slimDOM","color","date","email","month","number","range","search","tel","time","week","textarea","select","password","visitSnapshot","onVisit","walk","current","cleanupSnapshot","commentre","parse","css","lineno","column","updatePosition","str","lines","lastIndexOf","position","start","line","Position","whitespace","end","source","content","errorsList","msg","Error","reason","filename","silent","rulesList","parsingErrors","open","close","comments","atrule","re","m","selector","declaration","propMatch","prop","val","ret","declarations","decls","decl","keyframe","vals","values","atkeyframes","vendor","frame","frames","keyframes","atsupports","supports","style","athost","atmedia","media","atcustommedia","atpage","sel","selectors","atdocument","atfontface","atimport","_compileAtrule","atcharset","atnamespace","addParent","obj","parent","isNode","childParent","k","isArray","v","defineProperty","configurable","writable","enumerable","tagMap","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","clippath","feblend","fecolormatrix","fecomponenttransfer","fecomposite","feconvolvematrix","fediffuselighting","fedisplacementmap","fedistantlight","fedropshadow","feflood","fefunca","fefuncb","fefuncg","fefuncr","fegaussianblur","feimage","femerge","femergenode","femorphology","feoffset","fepointlight","fespecularlighting","fespotlight","fetile","feturbulence","foreignobject","glyphref","lineargradient","radialgradient","getTagName","escapeRegExp","HOVER_SELECTOR","HOVER_SELECTOR_GLOBAL","addHoverClass","cache","cachedStyle","stylesWithHoverClass","ast","selectorMatcher","filter","index","sort","b","result","newSelector","createCache","buildNode","hackCss","implementation","createDocument","createDocumentType","node_1","createElementNS","specialAttributes","name_1","hasOwnProperty","startsWith","isTextarea","isRemoteOrDynamicCss","child","createTextNode","removeChild","appendChild","setAttributeNS","setAttribute","srcset","_loop_1","name_2","RRNodeType","image","play","e","pause","attachShadow","mode","firstChild","createCDATASection","createComment","buildNodeWithSN","afterAppend","xmlns","write","visit","handleScroll","name_3","rebuild","visitedNode"],"sources":["/Users/ogonen/rrweb/node_modules/rrweb-snapshot/es/rrweb-snapshot.js"],"sourcesContent":["var NodeType;\r\n(function (NodeType) {\r\n    NodeType[NodeType[\"Document\"] = 0] = \"Document\";\r\n    NodeType[NodeType[\"DocumentType\"] = 1] = \"DocumentType\";\r\n    NodeType[NodeType[\"Element\"] = 2] = \"Element\";\r\n    NodeType[NodeType[\"Text\"] = 3] = \"Text\";\r\n    NodeType[NodeType[\"CDATA\"] = 4] = \"CDATA\";\r\n    NodeType[NodeType[\"Comment\"] = 5] = \"Comment\";\r\n})(NodeType || (NodeType = {}));\n\nfunction isElement(n) {\r\n    return n.nodeType === n.ELEMENT_NODE;\r\n}\r\nfunction isShadowRoot(n) {\r\n    var host = n === null || n === void 0 ? void 0 : n.host;\r\n    return Boolean((host === null || host === void 0 ? void 0 : host.shadowRoot) === n);\r\n}\r\nfunction isNativeShadowDom(shadowRoot) {\r\n    return Object.prototype.toString.call(shadowRoot) === '[object ShadowRoot]';\r\n}\r\nfunction fixBrowserCompatibilityIssuesInCSS(cssText) {\r\n    if (cssText.includes(' background-clip: text;') &&\r\n        !cssText.includes(' -webkit-background-clip: text;')) {\r\n        cssText = cssText.replace(' background-clip: text;', ' -webkit-background-clip: text; background-clip: text;');\r\n    }\r\n    return cssText;\r\n}\r\nfunction getCssRulesString(s) {\r\n    try {\r\n        var rules = s.rules || s.cssRules;\r\n        return rules\r\n            ? fixBrowserCompatibilityIssuesInCSS(Array.from(rules).map(getCssRuleString).join(''))\r\n            : null;\r\n    }\r\n    catch (error) {\r\n        return null;\r\n    }\r\n}\r\nfunction getCssRuleString(rule) {\r\n    var cssStringified = rule.cssText;\r\n    if (isCSSImportRule(rule)) {\r\n        try {\r\n            cssStringified = getCssRulesString(rule.styleSheet) || cssStringified;\r\n        }\r\n        catch (_a) {\r\n        }\r\n    }\r\n    return cssStringified;\r\n}\r\nfunction isCSSImportRule(rule) {\r\n    return 'styleSheet' in rule;\r\n}\r\nvar Mirror = (function () {\r\n    function Mirror() {\r\n        this.idNodeMap = new Map();\r\n        this.nodeMetaMap = new WeakMap();\r\n    }\r\n    Mirror.prototype.getId = function (n) {\r\n        var _a;\r\n        if (!n)\r\n            return -1;\r\n        var id = (_a = this.getMeta(n)) === null || _a === void 0 ? void 0 : _a.id;\r\n        return id !== null && id !== void 0 ? id : -1;\r\n    };\r\n    Mirror.prototype.getNode = function (id) {\r\n        return this.idNodeMap.get(id) || null;\r\n    };\r\n    Mirror.prototype.getIds = function () {\r\n        return Array.from(this.idNodeMap.keys());\r\n    };\r\n    Mirror.prototype.getMeta = function (n) {\r\n        return this.nodeMetaMap.get(n) || null;\r\n    };\r\n    Mirror.prototype.removeNodeFromMap = function (n) {\r\n        var _this = this;\r\n        var id = this.getId(n);\r\n        this.idNodeMap[\"delete\"](id);\r\n        if (n.childNodes) {\r\n            n.childNodes.forEach(function (childNode) {\r\n                return _this.removeNodeFromMap(childNode);\r\n            });\r\n        }\r\n    };\r\n    Mirror.prototype.has = function (id) {\r\n        return this.idNodeMap.has(id);\r\n    };\r\n    Mirror.prototype.hasNode = function (node) {\r\n        return this.nodeMetaMap.has(node);\r\n    };\r\n    Mirror.prototype.add = function (n, meta) {\r\n        var id = meta.id;\r\n        this.idNodeMap.set(id, n);\r\n        this.nodeMetaMap.set(n, meta);\r\n    };\r\n    Mirror.prototype.replace = function (id, n) {\r\n        var oldNode = this.getNode(id);\r\n        if (oldNode) {\r\n            var meta = this.nodeMetaMap.get(oldNode);\r\n            if (meta)\r\n                this.nodeMetaMap.set(n, meta);\r\n        }\r\n        this.idNodeMap.set(id, n);\r\n    };\r\n    Mirror.prototype.reset = function () {\r\n        this.idNodeMap = new Map();\r\n        this.nodeMetaMap = new WeakMap();\r\n    };\r\n    return Mirror;\r\n}());\r\nfunction createMirror() {\r\n    return new Mirror();\r\n}\r\nfunction maskInputValue(_a) {\r\n    var maskInputOptions = _a.maskInputOptions, tagName = _a.tagName, type = _a.type, value = _a.value, maskInputFn = _a.maskInputFn;\r\n    var text = value || '';\r\n    if (maskInputOptions[tagName.toLowerCase()] ||\r\n        maskInputOptions[type]) {\r\n        if (maskInputFn) {\r\n            text = maskInputFn(text);\r\n        }\r\n        else {\r\n            text = '*'.repeat(text.length);\r\n        }\r\n    }\r\n    return text;\r\n}\r\nvar ORIGINAL_ATTRIBUTE_NAME = '__rrweb_original__';\r\nfunction is2DCanvasBlank(canvas) {\r\n    var ctx = canvas.getContext('2d');\r\n    if (!ctx)\r\n        return true;\r\n    var chunkSize = 50;\r\n    for (var x = 0; x < canvas.width; x += chunkSize) {\r\n        for (var y = 0; y < canvas.height; y += chunkSize) {\r\n            var getImageData = ctx.getImageData;\r\n            var originalGetImageData = ORIGINAL_ATTRIBUTE_NAME in getImageData\r\n                ? getImageData[ORIGINAL_ATTRIBUTE_NAME]\r\n                : getImageData;\r\n            var pixelBuffer = new Uint32Array(originalGetImageData.call(ctx, x, y, Math.min(chunkSize, canvas.width - x), Math.min(chunkSize, canvas.height - y)).data.buffer);\r\n            if (pixelBuffer.some(function (pixel) { return pixel !== 0; }))\r\n                return false;\r\n        }\r\n    }\r\n    return true;\r\n}\n\nvar _id = 1;\r\nvar tagNameRegex = new RegExp('[^a-z0-9-_:]');\r\nvar IGNORED_NODE = -2;\r\nfunction genId() {\r\n    return _id++;\r\n}\r\nfunction getValidTagName(element) {\r\n    if (element instanceof HTMLFormElement) {\r\n        return 'form';\r\n    }\r\n    var processedTagName = element.tagName.toLowerCase().trim();\r\n    if (tagNameRegex.test(processedTagName)) {\r\n        return 'div';\r\n    }\r\n    return processedTagName;\r\n}\r\nfunction stringifyStyleSheet(sheet) {\r\n    return sheet.cssRules\r\n        ? Array.from(sheet.cssRules)\r\n            .map(function (rule) { return rule.cssText || ''; })\r\n            .join('')\r\n        : '';\r\n}\r\nfunction extractOrigin(url) {\r\n    var origin = '';\r\n    if (url.indexOf('//') > -1) {\r\n        origin = url.split('/').slice(0, 3).join('/');\r\n    }\r\n    else {\r\n        origin = url.split('/')[0];\r\n    }\r\n    origin = origin.split('?')[0];\r\n    return origin;\r\n}\r\nvar canvasService;\r\nvar canvasCtx;\r\nvar URL_IN_CSS_REF = /url\\((?:(')([^']*)'|(\")(.*?)\"|([^)]*))\\)/gm;\r\nvar RELATIVE_PATH = /^(?!www\\.|(?:http|ftp)s?:\\/\\/|[A-Za-z]:\\\\|\\/\\/|#).*/;\r\nvar DATA_URI = /^(data:)([^,]*),(.*)/i;\r\nfunction absoluteToStylesheet(cssText, href) {\r\n    return (cssText || '').replace(URL_IN_CSS_REF, function (origin, quote1, path1, quote2, path2, path3) {\r\n        var filePath = path1 || path2 || path3;\r\n        var maybeQuote = quote1 || quote2 || '';\r\n        if (!filePath) {\r\n            return origin;\r\n        }\r\n        if (!RELATIVE_PATH.test(filePath)) {\r\n            return \"url(\".concat(maybeQuote).concat(filePath).concat(maybeQuote, \")\");\r\n        }\r\n        if (DATA_URI.test(filePath)) {\r\n            return \"url(\".concat(maybeQuote).concat(filePath).concat(maybeQuote, \")\");\r\n        }\r\n        if (filePath[0] === '/') {\r\n            return \"url(\".concat(maybeQuote).concat(extractOrigin(href) + filePath).concat(maybeQuote, \")\");\r\n        }\r\n        var stack = href.split('/');\r\n        var parts = filePath.split('/');\r\n        stack.pop();\r\n        for (var _i = 0, parts_1 = parts; _i < parts_1.length; _i++) {\r\n            var part = parts_1[_i];\r\n            if (part === '.') {\r\n                continue;\r\n            }\r\n            else if (part === '..') {\r\n                stack.pop();\r\n            }\r\n            else {\r\n                stack.push(part);\r\n            }\r\n        }\r\n        return \"url(\".concat(maybeQuote).concat(stack.join('/')).concat(maybeQuote, \")\");\r\n    });\r\n}\r\nvar SRCSET_NOT_SPACES = /^[^ \\t\\n\\r\\u000c]+/;\r\nvar SRCSET_COMMAS_OR_SPACES = /^[, \\t\\n\\r\\u000c]+/;\r\nfunction getAbsoluteSrcsetString(doc, attributeValue) {\r\n    if (attributeValue.trim() === '') {\r\n        return attributeValue;\r\n    }\r\n    var pos = 0;\r\n    function collectCharacters(regEx) {\r\n        var chars;\r\n        var match = regEx.exec(attributeValue.substring(pos));\r\n        if (match) {\r\n            chars = match[0];\r\n            pos += chars.length;\r\n            return chars;\r\n        }\r\n        return '';\r\n    }\r\n    var output = [];\r\n    while (true) {\r\n        collectCharacters(SRCSET_COMMAS_OR_SPACES);\r\n        if (pos >= attributeValue.length) {\r\n            break;\r\n        }\r\n        var url = collectCharacters(SRCSET_NOT_SPACES);\r\n        if (url.slice(-1) === ',') {\r\n            url = absoluteToDoc(doc, url.substring(0, url.length - 1));\r\n            output.push(url);\r\n        }\r\n        else {\r\n            var descriptorsStr = '';\r\n            url = absoluteToDoc(doc, url);\r\n            var inParens = false;\r\n            while (true) {\r\n                var c = attributeValue.charAt(pos);\r\n                if (c === '') {\r\n                    output.push((url + descriptorsStr).trim());\r\n                    break;\r\n                }\r\n                else if (!inParens) {\r\n                    if (c === ',') {\r\n                        pos += 1;\r\n                        output.push((url + descriptorsStr).trim());\r\n                        break;\r\n                    }\r\n                    else if (c === '(') {\r\n                        inParens = true;\r\n                    }\r\n                }\r\n                else {\r\n                    if (c === ')') {\r\n                        inParens = false;\r\n                    }\r\n                }\r\n                descriptorsStr += c;\r\n                pos += 1;\r\n            }\r\n        }\r\n    }\r\n    return output.join(', ');\r\n}\r\nfunction absoluteToDoc(doc, attributeValue) {\r\n    if (!attributeValue || attributeValue.trim() === '') {\r\n        return attributeValue;\r\n    }\r\n    var a = doc.createElement('a');\r\n    a.href = attributeValue;\r\n    return a.href;\r\n}\r\nfunction isSVGElement(el) {\r\n    return Boolean(el.tagName === 'svg' || el.ownerSVGElement);\r\n}\r\nfunction getHref() {\r\n    var a = document.createElement('a');\r\n    a.href = '';\r\n    return a.href;\r\n}\r\nfunction transformAttribute(doc, tagName, name, value) {\r\n    if (name === 'src' ||\r\n        (name === 'href' && value && !(tagName === 'use' && value[0] === '#'))) {\r\n        return absoluteToDoc(doc, value);\r\n    }\r\n    else if (name === 'xlink:href' && value && value[0] !== '#') {\r\n        return absoluteToDoc(doc, value);\r\n    }\r\n    else if (name === 'background' &&\r\n        value &&\r\n        (tagName === 'table' || tagName === 'td' || tagName === 'th')) {\r\n        return absoluteToDoc(doc, value);\r\n    }\r\n    else if (name === 'srcset' && value) {\r\n        return getAbsoluteSrcsetString(doc, value);\r\n    }\r\n    else if (name === 'style' && value) {\r\n        return absoluteToStylesheet(value, getHref());\r\n    }\r\n    else if (tagName === 'object' && name === 'data' && value) {\r\n        return absoluteToDoc(doc, value);\r\n    }\r\n    else {\r\n        return value;\r\n    }\r\n}\r\nfunction _isBlockedElement(element, blockClass, blockSelector) {\r\n    if (typeof blockClass === 'string') {\r\n        if (element.classList.contains(blockClass)) {\r\n            return true;\r\n        }\r\n    }\r\n    else {\r\n        for (var eIndex = element.classList.length; eIndex--;) {\r\n            var className = element.classList[eIndex];\r\n            if (blockClass.test(className)) {\r\n                return true;\r\n            }\r\n        }\r\n    }\r\n    if (blockSelector) {\r\n        return element.matches(blockSelector);\r\n    }\r\n    return false;\r\n}\r\nfunction classMatchesRegex(node, regex, checkAncestors) {\r\n    if (!node)\r\n        return false;\r\n    if (node.nodeType !== node.ELEMENT_NODE) {\r\n        if (!checkAncestors)\r\n            return false;\r\n        return classMatchesRegex(node.parentNode, regex, checkAncestors);\r\n    }\r\n    for (var eIndex = node.classList.length; eIndex--;) {\r\n        var className = node.classList[eIndex];\r\n        if (regex.test(className)) {\r\n            return true;\r\n        }\r\n    }\r\n    if (!checkAncestors)\r\n        return false;\r\n    return classMatchesRegex(node.parentNode, regex, checkAncestors);\r\n}\r\nfunction needMaskingText(node, maskTextClass, maskTextSelector) {\r\n    var el = node.nodeType === node.ELEMENT_NODE\r\n        ? node\r\n        : node.parentElement;\r\n    if (el === null)\r\n        return false;\r\n    if (typeof maskTextClass === 'string') {\r\n        if (el.classList.contains(maskTextClass))\r\n            return true;\r\n        if (el.closest(\".\".concat(maskTextClass)))\r\n            return true;\r\n    }\r\n    else {\r\n        if (classMatchesRegex(el, maskTextClass, true))\r\n            return true;\r\n    }\r\n    if (maskTextSelector) {\r\n        if (el.matches(maskTextSelector))\r\n            return true;\r\n        if (el.closest(maskTextSelector))\r\n            return true;\r\n    }\r\n    return false;\r\n}\r\nfunction onceIframeLoaded(iframeEl, listener, iframeLoadTimeout) {\r\n    var win = iframeEl.contentWindow;\r\n    if (!win) {\r\n        return;\r\n    }\r\n    var fired = false;\r\n    var readyState;\r\n    try {\r\n        readyState = win.document.readyState;\r\n    }\r\n    catch (error) {\r\n        return;\r\n    }\r\n    if (readyState !== 'complete') {\r\n        var timer_1 = setTimeout(function () {\r\n            if (!fired) {\r\n                listener();\r\n                fired = true;\r\n            }\r\n        }, iframeLoadTimeout);\r\n        iframeEl.addEventListener('load', function () {\r\n            clearTimeout(timer_1);\r\n            fired = true;\r\n            listener();\r\n        });\r\n        return;\r\n    }\r\n    var blankUrl = 'about:blank';\r\n    if (win.location.href !== blankUrl ||\r\n        iframeEl.src === blankUrl ||\r\n        iframeEl.src === '') {\r\n        setTimeout(listener, 0);\r\n        return iframeEl.addEventListener('load', listener);\r\n    }\r\n    iframeEl.addEventListener('load', listener);\r\n}\r\nfunction onceStylesheetLoaded(link, listener, styleSheetLoadTimeout) {\r\n    var fired = false;\r\n    var styleSheetLoaded;\r\n    try {\r\n        styleSheetLoaded = link.sheet;\r\n    }\r\n    catch (error) {\r\n        return;\r\n    }\r\n    if (styleSheetLoaded)\r\n        return;\r\n    var timer = setTimeout(function () {\r\n        if (!fired) {\r\n            listener();\r\n            fired = true;\r\n        }\r\n    }, styleSheetLoadTimeout);\r\n    link.addEventListener('load', function () {\r\n        clearTimeout(timer);\r\n        fired = true;\r\n        listener();\r\n    });\r\n}\r\nfunction serializeNode(n, options) {\r\n    var doc = options.doc, mirror = options.mirror, blockClass = options.blockClass, blockSelector = options.blockSelector, maskTextClass = options.maskTextClass, maskTextSelector = options.maskTextSelector, inlineStylesheet = options.inlineStylesheet, _a = options.maskInputOptions, maskInputOptions = _a === void 0 ? {} : _a, maskTextFn = options.maskTextFn, maskInputFn = options.maskInputFn, _b = options.dataURLOptions, dataURLOptions = _b === void 0 ? {} : _b, inlineImages = options.inlineImages, recordCanvas = options.recordCanvas, keepIframeSrcFn = options.keepIframeSrcFn, _c = options.newlyAddedElement, newlyAddedElement = _c === void 0 ? false : _c;\r\n    var rootId = getRootId(doc, mirror);\r\n    switch (n.nodeType) {\r\n        case n.DOCUMENT_NODE:\r\n            if (n.compatMode !== 'CSS1Compat') {\r\n                return {\r\n                    type: NodeType.Document,\r\n                    childNodes: [],\r\n                    compatMode: n.compatMode\r\n                };\r\n            }\r\n            else {\r\n                return {\r\n                    type: NodeType.Document,\r\n                    childNodes: []\r\n                };\r\n            }\r\n        case n.DOCUMENT_TYPE_NODE:\r\n            return {\r\n                type: NodeType.DocumentType,\r\n                name: n.name,\r\n                publicId: n.publicId,\r\n                systemId: n.systemId,\r\n                rootId: rootId\r\n            };\r\n        case n.ELEMENT_NODE:\r\n            return serializeElementNode(n, {\r\n                doc: doc,\r\n                blockClass: blockClass,\r\n                blockSelector: blockSelector,\r\n                inlineStylesheet: inlineStylesheet,\r\n                maskInputOptions: maskInputOptions,\r\n                maskInputFn: maskInputFn,\r\n                dataURLOptions: dataURLOptions,\r\n                inlineImages: inlineImages,\r\n                recordCanvas: recordCanvas,\r\n                keepIframeSrcFn: keepIframeSrcFn,\r\n                newlyAddedElement: newlyAddedElement,\r\n                rootId: rootId\r\n            });\r\n        case n.TEXT_NODE:\r\n            return serializeTextNode(n, {\r\n                maskTextClass: maskTextClass,\r\n                maskTextSelector: maskTextSelector,\r\n                maskTextFn: maskTextFn,\r\n                rootId: rootId\r\n            });\r\n        case n.CDATA_SECTION_NODE:\r\n            return {\r\n                type: NodeType.CDATA,\r\n                textContent: '',\r\n                rootId: rootId\r\n            };\r\n        case n.COMMENT_NODE:\r\n            return {\r\n                type: NodeType.Comment,\r\n                textContent: n.textContent || '',\r\n                rootId: rootId\r\n            };\r\n        default:\r\n            return false;\r\n    }\r\n}\r\nfunction getRootId(doc, mirror) {\r\n    if (!mirror.hasNode(doc))\r\n        return undefined;\r\n    var docId = mirror.getId(doc);\r\n    return docId === 1 ? undefined : docId;\r\n}\r\nfunction serializeTextNode(n, options) {\r\n    var _a;\r\n    var maskTextClass = options.maskTextClass, maskTextSelector = options.maskTextSelector, maskTextFn = options.maskTextFn, rootId = options.rootId;\r\n    var parentTagName = n.parentNode && n.parentNode.tagName;\r\n    var textContent = n.textContent;\r\n    var isStyle = parentTagName === 'STYLE' ? true : undefined;\r\n    var isScript = parentTagName === 'SCRIPT' ? true : undefined;\r\n    if (isStyle && textContent) {\r\n        try {\r\n            if (n.nextSibling || n.previousSibling) {\r\n            }\r\n            else if ((_a = n.parentNode.sheet) === null || _a === void 0 ? void 0 : _a.cssRules) {\r\n                textContent = stringifyStyleSheet(n.parentNode.sheet);\r\n            }\r\n        }\r\n        catch (err) {\r\n            console.warn(\"Cannot get CSS styles from text's parentNode. Error: \".concat(err), n);\r\n        }\r\n        textContent = absoluteToStylesheet(textContent, getHref());\r\n    }\r\n    if (isScript) {\r\n        textContent = 'SCRIPT_PLACEHOLDER';\r\n    }\r\n    if (!isStyle &&\r\n        !isScript &&\r\n        textContent &&\r\n        needMaskingText(n, maskTextClass, maskTextSelector)) {\r\n        textContent = maskTextFn\r\n            ? maskTextFn(textContent)\r\n            : textContent.replace(/[\\S]/g, '*');\r\n    }\r\n    return {\r\n        type: NodeType.Text,\r\n        textContent: textContent || '',\r\n        isStyle: isStyle,\r\n        rootId: rootId\r\n    };\r\n}\r\nfunction serializeElementNode(n, options) {\r\n    var doc = options.doc, blockClass = options.blockClass, blockSelector = options.blockSelector, inlineStylesheet = options.inlineStylesheet, _a = options.maskInputOptions, maskInputOptions = _a === void 0 ? {} : _a, maskInputFn = options.maskInputFn, _b = options.dataURLOptions, dataURLOptions = _b === void 0 ? {} : _b, inlineImages = options.inlineImages, recordCanvas = options.recordCanvas, keepIframeSrcFn = options.keepIframeSrcFn, _c = options.newlyAddedElement, newlyAddedElement = _c === void 0 ? false : _c, rootId = options.rootId;\r\n    var needBlock = _isBlockedElement(n, blockClass, blockSelector);\r\n    var tagName = getValidTagName(n);\r\n    var attributes = {};\r\n    var len = n.attributes.length;\r\n    for (var i = 0; i < len; i++) {\r\n        var attr = n.attributes[i];\r\n        attributes[attr.name] = transformAttribute(doc, tagName, attr.name, attr.value);\r\n    }\r\n    if (tagName === 'link' && inlineStylesheet) {\r\n        var stylesheet = Array.from(doc.styleSheets).find(function (s) {\r\n            return s.href === n.href;\r\n        });\r\n        var cssText = null;\r\n        if (stylesheet) {\r\n            cssText = getCssRulesString(stylesheet);\r\n        }\r\n        if (cssText) {\r\n            delete attributes.rel;\r\n            delete attributes.href;\r\n            attributes._cssText = absoluteToStylesheet(cssText, stylesheet.href);\r\n        }\r\n    }\r\n    if (tagName === 'style' &&\r\n        n.sheet &&\r\n        !(n.innerText || n.textContent || '').trim().length) {\r\n        var cssText = getCssRulesString(n.sheet);\r\n        if (cssText) {\r\n            attributes._cssText = absoluteToStylesheet(cssText, getHref());\r\n        }\r\n    }\r\n    if (tagName === 'input' || tagName === 'textarea' || tagName === 'select') {\r\n        var value = n.value;\r\n        var checked = n.checked;\r\n        if (attributes.type !== 'radio' &&\r\n            attributes.type !== 'checkbox' &&\r\n            attributes.type !== 'submit' &&\r\n            attributes.type !== 'button' &&\r\n            value) {\r\n            attributes.value = maskInputValue({\r\n                type: attributes.type,\r\n                tagName: tagName,\r\n                value: value,\r\n                maskInputOptions: maskInputOptions,\r\n                maskInputFn: maskInputFn\r\n            });\r\n        }\r\n        else if (checked) {\r\n            attributes.checked = checked;\r\n        }\r\n    }\r\n    if (tagName === 'option') {\r\n        if (n.selected && !maskInputOptions['select']) {\r\n            attributes.selected = true;\r\n        }\r\n        else {\r\n            delete attributes.selected;\r\n        }\r\n    }\r\n    if (tagName === 'canvas' && recordCanvas) {\r\n        if (n.__context === '2d') {\r\n            if (!is2DCanvasBlank(n)) {\r\n                attributes.rr_dataURL = n.toDataURL(dataURLOptions.type, dataURLOptions.quality);\r\n            }\r\n        }\r\n        else if (!('__context' in n)) {\r\n            var canvasDataURL = n.toDataURL(dataURLOptions.type, dataURLOptions.quality);\r\n            var blankCanvas = document.createElement('canvas');\r\n            blankCanvas.width = n.width;\r\n            blankCanvas.height = n.height;\r\n            var blankCanvasDataURL = blankCanvas.toDataURL(dataURLOptions.type, dataURLOptions.quality);\r\n            if (canvasDataURL !== blankCanvasDataURL) {\r\n                attributes.rr_dataURL = canvasDataURL;\r\n            }\r\n        }\r\n    }\r\n    if (tagName === 'img' && inlineImages) {\r\n        if (!canvasService) {\r\n            canvasService = doc.createElement('canvas');\r\n            canvasCtx = canvasService.getContext('2d');\r\n        }\r\n        var image_1 = n;\r\n        var oldValue_1 = image_1.crossOrigin;\r\n        image_1.crossOrigin = 'anonymous';\r\n        var recordInlineImage = function () {\r\n            try {\r\n                canvasService.width = image_1.naturalWidth;\r\n                canvasService.height = image_1.naturalHeight;\r\n                canvasCtx.drawImage(image_1, 0, 0);\r\n                attributes.rr_dataURL = canvasService.toDataURL(dataURLOptions.type, dataURLOptions.quality);\r\n            }\r\n            catch (err) {\r\n                console.warn(\"Cannot inline img src=\".concat(image_1.currentSrc, \"! Error: \").concat(err));\r\n            }\r\n            oldValue_1\r\n                ? (attributes.crossOrigin = oldValue_1)\r\n                : image_1.removeAttribute('crossorigin');\r\n        };\r\n        if (image_1.complete && image_1.naturalWidth !== 0)\r\n            recordInlineImage();\r\n        else\r\n            image_1.onload = recordInlineImage;\r\n    }\r\n    if (tagName === 'audio' || tagName === 'video') {\r\n        attributes.rr_mediaState = n.paused\r\n            ? 'paused'\r\n            : 'played';\r\n        attributes.rr_mediaCurrentTime = n.currentTime;\r\n    }\r\n    if (!newlyAddedElement) {\r\n        if (n.scrollLeft) {\r\n            attributes.rr_scrollLeft = n.scrollLeft;\r\n        }\r\n        if (n.scrollTop) {\r\n            attributes.rr_scrollTop = n.scrollTop;\r\n        }\r\n    }\r\n    if (needBlock) {\r\n        var _d = n.getBoundingClientRect(), width = _d.width, height = _d.height;\r\n        attributes = {\r\n            \"class\": attributes[\"class\"],\r\n            rr_width: \"\".concat(width, \"px\"),\r\n            rr_height: \"\".concat(height, \"px\")\r\n        };\r\n    }\r\n    if (tagName === 'iframe' && !keepIframeSrcFn(attributes.src)) {\r\n        if (!n.contentDocument) {\r\n            attributes.rr_src = attributes.src;\r\n        }\r\n        delete attributes.src;\r\n    }\r\n    return {\r\n        type: NodeType.Element,\r\n        tagName: tagName,\r\n        attributes: attributes,\r\n        childNodes: [],\r\n        isSVG: isSVGElement(n) || undefined,\r\n        needBlock: needBlock,\r\n        rootId: rootId\r\n    };\r\n}\r\nfunction lowerIfExists(maybeAttr) {\r\n    if (maybeAttr === undefined) {\r\n        return '';\r\n    }\r\n    else {\r\n        return maybeAttr.toLowerCase();\r\n    }\r\n}\r\nfunction slimDOMExcluded(sn, slimDOMOptions) {\r\n    if (slimDOMOptions.comment && sn.type === NodeType.Comment) {\r\n        return true;\r\n    }\r\n    else if (sn.type === NodeType.Element) {\r\n        if (slimDOMOptions.script &&\r\n            (sn.tagName === 'script' ||\r\n                (sn.tagName === 'link' &&\r\n                    sn.attributes.rel === 'preload' &&\r\n                    sn.attributes.as === 'script') ||\r\n                (sn.tagName === 'link' &&\r\n                    sn.attributes.rel === 'prefetch' &&\r\n                    typeof sn.attributes.href === 'string' &&\r\n                    sn.attributes.href.endsWith('.js')))) {\r\n            return true;\r\n        }\r\n        else if (slimDOMOptions.headFavicon &&\r\n            ((sn.tagName === 'link' && sn.attributes.rel === 'shortcut icon') ||\r\n                (sn.tagName === 'meta' &&\r\n                    (lowerIfExists(sn.attributes.name).match(/^msapplication-tile(image|color)$/) ||\r\n                        lowerIfExists(sn.attributes.name) === 'application-name' ||\r\n                        lowerIfExists(sn.attributes.rel) === 'icon' ||\r\n                        lowerIfExists(sn.attributes.rel) === 'apple-touch-icon' ||\r\n                        lowerIfExists(sn.attributes.rel) === 'shortcut icon')))) {\r\n            return true;\r\n        }\r\n        else if (sn.tagName === 'meta') {\r\n            if (slimDOMOptions.headMetaDescKeywords &&\r\n                lowerIfExists(sn.attributes.name).match(/^description|keywords$/)) {\r\n                return true;\r\n            }\r\n            else if (slimDOMOptions.headMetaSocial &&\r\n                (lowerIfExists(sn.attributes.property).match(/^(og|twitter|fb):/) ||\r\n                    lowerIfExists(sn.attributes.name).match(/^(og|twitter):/) ||\r\n                    lowerIfExists(sn.attributes.name) === 'pinterest')) {\r\n                return true;\r\n            }\r\n            else if (slimDOMOptions.headMetaRobots &&\r\n                (lowerIfExists(sn.attributes.name) === 'robots' ||\r\n                    lowerIfExists(sn.attributes.name) === 'googlebot' ||\r\n                    lowerIfExists(sn.attributes.name) === 'bingbot')) {\r\n                return true;\r\n            }\r\n            else if (slimDOMOptions.headMetaHttpEquiv &&\r\n                sn.attributes['http-equiv'] !== undefined) {\r\n                return true;\r\n            }\r\n            else if (slimDOMOptions.headMetaAuthorship &&\r\n                (lowerIfExists(sn.attributes.name) === 'author' ||\r\n                    lowerIfExists(sn.attributes.name) === 'generator' ||\r\n                    lowerIfExists(sn.attributes.name) === 'framework' ||\r\n                    lowerIfExists(sn.attributes.name) === 'publisher' ||\r\n                    lowerIfExists(sn.attributes.name) === 'progid' ||\r\n                    lowerIfExists(sn.attributes.property).match(/^article:/) ||\r\n                    lowerIfExists(sn.attributes.property).match(/^product:/))) {\r\n                return true;\r\n            }\r\n            else if (slimDOMOptions.headMetaVerification &&\r\n                (lowerIfExists(sn.attributes.name) === 'google-site-verification' ||\r\n                    lowerIfExists(sn.attributes.name) === 'yandex-verification' ||\r\n                    lowerIfExists(sn.attributes.name) === 'csrf-token' ||\r\n                    lowerIfExists(sn.attributes.name) === 'p:domain_verify' ||\r\n                    lowerIfExists(sn.attributes.name) === 'verify-v1' ||\r\n                    lowerIfExists(sn.attributes.name) === 'verification' ||\r\n                    lowerIfExists(sn.attributes.name) === 'shopify-checkout-api-token')) {\r\n                return true;\r\n            }\r\n        }\r\n    }\r\n    return false;\r\n}\r\nfunction serializeNodeWithId(n, options) {\r\n    var doc = options.doc, mirror = options.mirror, blockClass = options.blockClass, blockSelector = options.blockSelector, maskTextClass = options.maskTextClass, maskTextSelector = options.maskTextSelector, _a = options.skipChild, skipChild = _a === void 0 ? false : _a, _b = options.inlineStylesheet, inlineStylesheet = _b === void 0 ? true : _b, _c = options.maskInputOptions, maskInputOptions = _c === void 0 ? {} : _c, maskTextFn = options.maskTextFn, maskInputFn = options.maskInputFn, slimDOMOptions = options.slimDOMOptions, _d = options.dataURLOptions, dataURLOptions = _d === void 0 ? {} : _d, _e = options.inlineImages, inlineImages = _e === void 0 ? false : _e, _f = options.recordCanvas, recordCanvas = _f === void 0 ? false : _f, onSerialize = options.onSerialize, onIframeLoad = options.onIframeLoad, _g = options.iframeLoadTimeout, iframeLoadTimeout = _g === void 0 ? 5000 : _g, onStylesheetLoad = options.onStylesheetLoad, _h = options.stylesheetLoadTimeout, stylesheetLoadTimeout = _h === void 0 ? 5000 : _h, _j = options.keepIframeSrcFn, keepIframeSrcFn = _j === void 0 ? function () { return false; } : _j, _k = options.newlyAddedElement, newlyAddedElement = _k === void 0 ? false : _k;\r\n    var _l = options.preserveWhiteSpace, preserveWhiteSpace = _l === void 0 ? true : _l;\r\n    var _serializedNode = serializeNode(n, {\r\n        doc: doc,\r\n        mirror: mirror,\r\n        blockClass: blockClass,\r\n        blockSelector: blockSelector,\r\n        maskTextClass: maskTextClass,\r\n        maskTextSelector: maskTextSelector,\r\n        inlineStylesheet: inlineStylesheet,\r\n        maskInputOptions: maskInputOptions,\r\n        maskTextFn: maskTextFn,\r\n        maskInputFn: maskInputFn,\r\n        dataURLOptions: dataURLOptions,\r\n        inlineImages: inlineImages,\r\n        recordCanvas: recordCanvas,\r\n        keepIframeSrcFn: keepIframeSrcFn,\r\n        newlyAddedElement: newlyAddedElement\r\n    });\r\n    if (!_serializedNode) {\r\n        console.warn(n, 'not serialized');\r\n        return null;\r\n    }\r\n    var id;\r\n    if (mirror.hasNode(n)) {\r\n        id = mirror.getId(n);\r\n    }\r\n    else if (slimDOMExcluded(_serializedNode, slimDOMOptions) ||\r\n        (!preserveWhiteSpace &&\r\n            _serializedNode.type === NodeType.Text &&\r\n            !_serializedNode.isStyle &&\r\n            !_serializedNode.textContent.replace(/^\\s+|\\s+$/gm, '').length)) {\r\n        id = IGNORED_NODE;\r\n    }\r\n    else {\r\n        id = genId();\r\n    }\r\n    var serializedNode = Object.assign(_serializedNode, { id: id });\r\n    mirror.add(n, serializedNode);\r\n    if (id === IGNORED_NODE) {\r\n        return null;\r\n    }\r\n    if (onSerialize) {\r\n        onSerialize(n);\r\n    }\r\n    var recordChild = !skipChild;\r\n    if (serializedNode.type === NodeType.Element) {\r\n        recordChild = recordChild && !serializedNode.needBlock;\r\n        delete serializedNode.needBlock;\r\n        var shadowRoot = n.shadowRoot;\r\n        if (shadowRoot && isNativeShadowDom(shadowRoot))\r\n            serializedNode.isShadowHost = true;\r\n    }\r\n    if ((serializedNode.type === NodeType.Document ||\r\n        serializedNode.type === NodeType.Element) &&\r\n        recordChild) {\r\n        if (slimDOMOptions.headWhitespace &&\r\n            serializedNode.type === NodeType.Element &&\r\n            serializedNode.tagName === 'head') {\r\n            preserveWhiteSpace = false;\r\n        }\r\n        var bypassOptions = {\r\n            doc: doc,\r\n            mirror: mirror,\r\n            blockClass: blockClass,\r\n            blockSelector: blockSelector,\r\n            maskTextClass: maskTextClass,\r\n            maskTextSelector: maskTextSelector,\r\n            skipChild: skipChild,\r\n            inlineStylesheet: inlineStylesheet,\r\n            maskInputOptions: maskInputOptions,\r\n            maskTextFn: maskTextFn,\r\n            maskInputFn: maskInputFn,\r\n            slimDOMOptions: slimDOMOptions,\r\n            dataURLOptions: dataURLOptions,\r\n            inlineImages: inlineImages,\r\n            recordCanvas: recordCanvas,\r\n            preserveWhiteSpace: preserveWhiteSpace,\r\n            onSerialize: onSerialize,\r\n            onIframeLoad: onIframeLoad,\r\n            iframeLoadTimeout: iframeLoadTimeout,\r\n            onStylesheetLoad: onStylesheetLoad,\r\n            stylesheetLoadTimeout: stylesheetLoadTimeout,\r\n            keepIframeSrcFn: keepIframeSrcFn\r\n        };\r\n        for (var _i = 0, _m = Array.from(n.childNodes); _i < _m.length; _i++) {\r\n            var childN = _m[_i];\r\n            var serializedChildNode = serializeNodeWithId(childN, bypassOptions);\r\n            if (serializedChildNode) {\r\n                serializedNode.childNodes.push(serializedChildNode);\r\n            }\r\n        }\r\n        if (isElement(n) && n.shadowRoot) {\r\n            for (var _o = 0, _p = Array.from(n.shadowRoot.childNodes); _o < _p.length; _o++) {\r\n                var childN = _p[_o];\r\n                var serializedChildNode = serializeNodeWithId(childN, bypassOptions);\r\n                if (serializedChildNode) {\r\n                    isNativeShadowDom(n.shadowRoot) &&\r\n                        (serializedChildNode.isShadow = true);\r\n                    serializedNode.childNodes.push(serializedChildNode);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    if (n.parentNode &&\r\n        isShadowRoot(n.parentNode) &&\r\n        isNativeShadowDom(n.parentNode)) {\r\n        serializedNode.isShadow = true;\r\n    }\r\n    if (serializedNode.type === NodeType.Element &&\r\n        serializedNode.tagName === 'iframe') {\r\n        onceIframeLoaded(n, function () {\r\n            var iframeDoc = n.contentDocument;\r\n            if (iframeDoc && onIframeLoad) {\r\n                var serializedIframeNode = serializeNodeWithId(iframeDoc, {\r\n                    doc: iframeDoc,\r\n                    mirror: mirror,\r\n                    blockClass: blockClass,\r\n                    blockSelector: blockSelector,\r\n                    maskTextClass: maskTextClass,\r\n                    maskTextSelector: maskTextSelector,\r\n                    skipChild: false,\r\n                    inlineStylesheet: inlineStylesheet,\r\n                    maskInputOptions: maskInputOptions,\r\n                    maskTextFn: maskTextFn,\r\n                    maskInputFn: maskInputFn,\r\n                    slimDOMOptions: slimDOMOptions,\r\n                    dataURLOptions: dataURLOptions,\r\n                    inlineImages: inlineImages,\r\n                    recordCanvas: recordCanvas,\r\n                    preserveWhiteSpace: preserveWhiteSpace,\r\n                    onSerialize: onSerialize,\r\n                    onIframeLoad: onIframeLoad,\r\n                    iframeLoadTimeout: iframeLoadTimeout,\r\n                    onStylesheetLoad: onStylesheetLoad,\r\n                    stylesheetLoadTimeout: stylesheetLoadTimeout,\r\n                    keepIframeSrcFn: keepIframeSrcFn\r\n                });\r\n                if (serializedIframeNode) {\r\n                    onIframeLoad(n, serializedIframeNode);\r\n                }\r\n            }\r\n        }, iframeLoadTimeout);\r\n    }\r\n    if (serializedNode.type === NodeType.Element &&\r\n        serializedNode.tagName === 'link' &&\r\n        serializedNode.attributes.rel === 'stylesheet') {\r\n        onceStylesheetLoaded(n, function () {\r\n            if (onStylesheetLoad) {\r\n                var serializedLinkNode = serializeNodeWithId(n, {\r\n                    doc: doc,\r\n                    mirror: mirror,\r\n                    blockClass: blockClass,\r\n                    blockSelector: blockSelector,\r\n                    maskTextClass: maskTextClass,\r\n                    maskTextSelector: maskTextSelector,\r\n                    skipChild: false,\r\n                    inlineStylesheet: inlineStylesheet,\r\n                    maskInputOptions: maskInputOptions,\r\n                    maskTextFn: maskTextFn,\r\n                    maskInputFn: maskInputFn,\r\n                    slimDOMOptions: slimDOMOptions,\r\n                    dataURLOptions: dataURLOptions,\r\n                    inlineImages: inlineImages,\r\n                    recordCanvas: recordCanvas,\r\n                    preserveWhiteSpace: preserveWhiteSpace,\r\n                    onSerialize: onSerialize,\r\n                    onIframeLoad: onIframeLoad,\r\n                    iframeLoadTimeout: iframeLoadTimeout,\r\n                    onStylesheetLoad: onStylesheetLoad,\r\n                    stylesheetLoadTimeout: stylesheetLoadTimeout,\r\n                    keepIframeSrcFn: keepIframeSrcFn\r\n                });\r\n                if (serializedLinkNode) {\r\n                    onStylesheetLoad(n, serializedLinkNode);\r\n                }\r\n            }\r\n        }, stylesheetLoadTimeout);\r\n    }\r\n    return serializedNode;\r\n}\r\nfunction snapshot(n, options) {\r\n    var _a = options || {}, _b = _a.mirror, mirror = _b === void 0 ? new Mirror() : _b, _c = _a.blockClass, blockClass = _c === void 0 ? 'rr-block' : _c, _d = _a.blockSelector, blockSelector = _d === void 0 ? null : _d, _e = _a.maskTextClass, maskTextClass = _e === void 0 ? 'rr-mask' : _e, _f = _a.maskTextSelector, maskTextSelector = _f === void 0 ? null : _f, _g = _a.inlineStylesheet, inlineStylesheet = _g === void 0 ? true : _g, _h = _a.inlineImages, inlineImages = _h === void 0 ? false : _h, _j = _a.recordCanvas, recordCanvas = _j === void 0 ? false : _j, _k = _a.maskAllInputs, maskAllInputs = _k === void 0 ? false : _k, maskTextFn = _a.maskTextFn, maskInputFn = _a.maskInputFn, _l = _a.slimDOM, slimDOM = _l === void 0 ? false : _l, dataURLOptions = _a.dataURLOptions, preserveWhiteSpace = _a.preserveWhiteSpace, onSerialize = _a.onSerialize, onIframeLoad = _a.onIframeLoad, iframeLoadTimeout = _a.iframeLoadTimeout, onStylesheetLoad = _a.onStylesheetLoad, stylesheetLoadTimeout = _a.stylesheetLoadTimeout, _m = _a.keepIframeSrcFn, keepIframeSrcFn = _m === void 0 ? function () { return false; } : _m;\r\n    var maskInputOptions = maskAllInputs === true\r\n        ? {\r\n            color: true,\r\n            date: true,\r\n            'datetime-local': true,\r\n            email: true,\r\n            month: true,\r\n            number: true,\r\n            range: true,\r\n            search: true,\r\n            tel: true,\r\n            text: true,\r\n            time: true,\r\n            url: true,\r\n            week: true,\r\n            textarea: true,\r\n            select: true,\r\n            password: true\r\n        }\r\n        : maskAllInputs === false\r\n            ? {\r\n                password: true\r\n            }\r\n            : maskAllInputs;\r\n    var slimDOMOptions = slimDOM === true || slimDOM === 'all'\r\n        ?\r\n            {\r\n                script: true,\r\n                comment: true,\r\n                headFavicon: true,\r\n                headWhitespace: true,\r\n                headMetaDescKeywords: slimDOM === 'all',\r\n                headMetaSocial: true,\r\n                headMetaRobots: true,\r\n                headMetaHttpEquiv: true,\r\n                headMetaAuthorship: true,\r\n                headMetaVerification: true\r\n            }\r\n        : slimDOM === false\r\n            ? {}\r\n            : slimDOM;\r\n    return serializeNodeWithId(n, {\r\n        doc: n,\r\n        mirror: mirror,\r\n        blockClass: blockClass,\r\n        blockSelector: blockSelector,\r\n        maskTextClass: maskTextClass,\r\n        maskTextSelector: maskTextSelector,\r\n        skipChild: false,\r\n        inlineStylesheet: inlineStylesheet,\r\n        maskInputOptions: maskInputOptions,\r\n        maskTextFn: maskTextFn,\r\n        maskInputFn: maskInputFn,\r\n        slimDOMOptions: slimDOMOptions,\r\n        dataURLOptions: dataURLOptions,\r\n        inlineImages: inlineImages,\r\n        recordCanvas: recordCanvas,\r\n        preserveWhiteSpace: preserveWhiteSpace,\r\n        onSerialize: onSerialize,\r\n        onIframeLoad: onIframeLoad,\r\n        iframeLoadTimeout: iframeLoadTimeout,\r\n        onStylesheetLoad: onStylesheetLoad,\r\n        stylesheetLoadTimeout: stylesheetLoadTimeout,\r\n        keepIframeSrcFn: keepIframeSrcFn,\r\n        newlyAddedElement: false\r\n    });\r\n}\r\nfunction visitSnapshot(node, onVisit) {\r\n    function walk(current) {\r\n        onVisit(current);\r\n        if (current.type === NodeType.Document ||\r\n            current.type === NodeType.Element) {\r\n            current.childNodes.forEach(walk);\r\n        }\r\n    }\r\n    walk(node);\r\n}\r\nfunction cleanupSnapshot() {\r\n    _id = 1;\r\n}\n\nvar commentre = /\\/\\*[^*]*\\*+([^/*][^*]*\\*+)*\\//g;\r\nfunction parse(css, options) {\r\n    if (options === void 0) { options = {}; }\r\n    var lineno = 1;\r\n    var column = 1;\r\n    function updatePosition(str) {\r\n        var lines = str.match(/\\n/g);\r\n        if (lines) {\r\n            lineno += lines.length;\r\n        }\r\n        var i = str.lastIndexOf('\\n');\r\n        column = i === -1 ? column + str.length : str.length - i;\r\n    }\r\n    function position() {\r\n        var start = { line: lineno, column: column };\r\n        return function (node) {\r\n            node.position = new Position(start);\r\n            whitespace();\r\n            return node;\r\n        };\r\n    }\r\n    var Position = (function () {\r\n        function Position(start) {\r\n            this.start = start;\r\n            this.end = { line: lineno, column: column };\r\n            this.source = options.source;\r\n        }\r\n        return Position;\r\n    }());\r\n    Position.prototype.content = css;\r\n    var errorsList = [];\r\n    function error(msg) {\r\n        var err = new Error(\"\".concat(options.source || '', \":\").concat(lineno, \":\").concat(column, \": \").concat(msg));\r\n        err.reason = msg;\r\n        err.filename = options.source;\r\n        err.line = lineno;\r\n        err.column = column;\r\n        err.source = css;\r\n        if (options.silent) {\r\n            errorsList.push(err);\r\n        }\r\n        else {\r\n            throw err;\r\n        }\r\n    }\r\n    function stylesheet() {\r\n        var rulesList = rules();\r\n        return {\r\n            type: 'stylesheet',\r\n            stylesheet: {\r\n                source: options.source,\r\n                rules: rulesList,\r\n                parsingErrors: errorsList\r\n            }\r\n        };\r\n    }\r\n    function open() {\r\n        return match(/^{\\s*/);\r\n    }\r\n    function close() {\r\n        return match(/^}/);\r\n    }\r\n    function rules() {\r\n        var node;\r\n        var rules = [];\r\n        whitespace();\r\n        comments(rules);\r\n        while (css.length && css.charAt(0) !== '}' && (node = atrule() || rule())) {\r\n            if (node !== false) {\r\n                rules.push(node);\r\n                comments(rules);\r\n            }\r\n        }\r\n        return rules;\r\n    }\r\n    function match(re) {\r\n        var m = re.exec(css);\r\n        if (!m) {\r\n            return;\r\n        }\r\n        var str = m[0];\r\n        updatePosition(str);\r\n        css = css.slice(str.length);\r\n        return m;\r\n    }\r\n    function whitespace() {\r\n        match(/^\\s*/);\r\n    }\r\n    function comments(rules) {\r\n        if (rules === void 0) { rules = []; }\r\n        var c;\r\n        while ((c = comment())) {\r\n            if (c !== false) {\r\n                rules.push(c);\r\n            }\r\n            c = comment();\r\n        }\r\n        return rules;\r\n    }\r\n    function comment() {\r\n        var pos = position();\r\n        if ('/' !== css.charAt(0) || '*' !== css.charAt(1)) {\r\n            return;\r\n        }\r\n        var i = 2;\r\n        while ('' !== css.charAt(i) &&\r\n            ('*' !== css.charAt(i) || '/' !== css.charAt(i + 1))) {\r\n            ++i;\r\n        }\r\n        i += 2;\r\n        if ('' === css.charAt(i - 1)) {\r\n            return error('End of comment missing');\r\n        }\r\n        var str = css.slice(2, i - 2);\r\n        column += 2;\r\n        updatePosition(str);\r\n        css = css.slice(i);\r\n        column += 2;\r\n        return pos({\r\n            type: 'comment',\r\n            comment: str\r\n        });\r\n    }\r\n    function selector() {\r\n        var m = match(/^([^{]+)/);\r\n        if (!m) {\r\n            return;\r\n        }\r\n        return trim(m[0])\r\n            .replace(/\\/\\*([^*]|[\\r\\n]|(\\*+([^*/]|[\\r\\n])))*\\*\\/+/g, '')\r\n            .replace(/\"(?:\\\\\"|[^\"])*\"|'(?:\\\\'|[^'])*'/g, function (m) {\r\n            return m.replace(/,/g, '\\u200C');\r\n        })\r\n            .split(/\\s*(?![^(]*\\)),\\s*/)\r\n            .map(function (s) {\r\n            return s.replace(/\\u200C/g, ',');\r\n        });\r\n    }\r\n    function declaration() {\r\n        var pos = position();\r\n        var propMatch = match(/^(\\*?[-#\\/\\*\\\\\\w]+(\\[[0-9a-z_-]+\\])?)\\s*/);\r\n        if (!propMatch) {\r\n            return;\r\n        }\r\n        var prop = trim(propMatch[0]);\r\n        if (!match(/^:\\s*/)) {\r\n            return error(\"property missing ':'\");\r\n        }\r\n        var val = match(/^((?:'(?:\\\\'|.)*?'|\"(?:\\\\\"|.)*?\"|\\([^\\)]*?\\)|[^};])+)/);\r\n        var ret = pos({\r\n            type: 'declaration',\r\n            property: prop.replace(commentre, ''),\r\n            value: val ? trim(val[0]).replace(commentre, '') : ''\r\n        });\r\n        match(/^[;\\s]*/);\r\n        return ret;\r\n    }\r\n    function declarations() {\r\n        var decls = [];\r\n        if (!open()) {\r\n            return error(\"missing '{'\");\r\n        }\r\n        comments(decls);\r\n        var decl;\r\n        while ((decl = declaration())) {\r\n            if (decl !== false) {\r\n                decls.push(decl);\r\n                comments(decls);\r\n            }\r\n            decl = declaration();\r\n        }\r\n        if (!close()) {\r\n            return error(\"missing '}'\");\r\n        }\r\n        return decls;\r\n    }\r\n    function keyframe() {\r\n        var m;\r\n        var vals = [];\r\n        var pos = position();\r\n        while ((m = match(/^((\\d+\\.\\d+|\\.\\d+|\\d+)%?|[a-z]+)\\s*/))) {\r\n            vals.push(m[1]);\r\n            match(/^,\\s*/);\r\n        }\r\n        if (!vals.length) {\r\n            return;\r\n        }\r\n        return pos({\r\n            type: 'keyframe',\r\n            values: vals,\r\n            declarations: declarations()\r\n        });\r\n    }\r\n    function atkeyframes() {\r\n        var pos = position();\r\n        var m = match(/^@([-\\w]+)?keyframes\\s*/);\r\n        if (!m) {\r\n            return;\r\n        }\r\n        var vendor = m[1];\r\n        m = match(/^([-\\w]+)\\s*/);\r\n        if (!m) {\r\n            return error('@keyframes missing name');\r\n        }\r\n        var name = m[1];\r\n        if (!open()) {\r\n            return error(\"@keyframes missing '{'\");\r\n        }\r\n        var frame;\r\n        var frames = comments();\r\n        while ((frame = keyframe())) {\r\n            frames.push(frame);\r\n            frames = frames.concat(comments());\r\n        }\r\n        if (!close()) {\r\n            return error(\"@keyframes missing '}'\");\r\n        }\r\n        return pos({\r\n            type: 'keyframes',\r\n            name: name,\r\n            vendor: vendor,\r\n            keyframes: frames\r\n        });\r\n    }\r\n    function atsupports() {\r\n        var pos = position();\r\n        var m = match(/^@supports *([^{]+)/);\r\n        if (!m) {\r\n            return;\r\n        }\r\n        var supports = trim(m[1]);\r\n        if (!open()) {\r\n            return error(\"@supports missing '{'\");\r\n        }\r\n        var style = comments().concat(rules());\r\n        if (!close()) {\r\n            return error(\"@supports missing '}'\");\r\n        }\r\n        return pos({\r\n            type: 'supports',\r\n            supports: supports,\r\n            rules: style\r\n        });\r\n    }\r\n    function athost() {\r\n        var pos = position();\r\n        var m = match(/^@host\\s*/);\r\n        if (!m) {\r\n            return;\r\n        }\r\n        if (!open()) {\r\n            return error(\"@host missing '{'\");\r\n        }\r\n        var style = comments().concat(rules());\r\n        if (!close()) {\r\n            return error(\"@host missing '}'\");\r\n        }\r\n        return pos({\r\n            type: 'host',\r\n            rules: style\r\n        });\r\n    }\r\n    function atmedia() {\r\n        var pos = position();\r\n        var m = match(/^@media *([^{]+)/);\r\n        if (!m) {\r\n            return;\r\n        }\r\n        var media = trim(m[1]);\r\n        if (!open()) {\r\n            return error(\"@media missing '{'\");\r\n        }\r\n        var style = comments().concat(rules());\r\n        if (!close()) {\r\n            return error(\"@media missing '}'\");\r\n        }\r\n        return pos({\r\n            type: 'media',\r\n            media: media,\r\n            rules: style\r\n        });\r\n    }\r\n    function atcustommedia() {\r\n        var pos = position();\r\n        var m = match(/^@custom-media\\s+(--[^\\s]+)\\s*([^{;]+);/);\r\n        if (!m) {\r\n            return;\r\n        }\r\n        return pos({\r\n            type: 'custom-media',\r\n            name: trim(m[1]),\r\n            media: trim(m[2])\r\n        });\r\n    }\r\n    function atpage() {\r\n        var pos = position();\r\n        var m = match(/^@page */);\r\n        if (!m) {\r\n            return;\r\n        }\r\n        var sel = selector() || [];\r\n        if (!open()) {\r\n            return error(\"@page missing '{'\");\r\n        }\r\n        var decls = comments();\r\n        var decl;\r\n        while ((decl = declaration())) {\r\n            decls.push(decl);\r\n            decls = decls.concat(comments());\r\n        }\r\n        if (!close()) {\r\n            return error(\"@page missing '}'\");\r\n        }\r\n        return pos({\r\n            type: 'page',\r\n            selectors: sel,\r\n            declarations: decls\r\n        });\r\n    }\r\n    function atdocument() {\r\n        var pos = position();\r\n        var m = match(/^@([-\\w]+)?document *([^{]+)/);\r\n        if (!m) {\r\n            return;\r\n        }\r\n        var vendor = trim(m[1]);\r\n        var doc = trim(m[2]);\r\n        if (!open()) {\r\n            return error(\"@document missing '{'\");\r\n        }\r\n        var style = comments().concat(rules());\r\n        if (!close()) {\r\n            return error(\"@document missing '}'\");\r\n        }\r\n        return pos({\r\n            type: 'document',\r\n            document: doc,\r\n            vendor: vendor,\r\n            rules: style\r\n        });\r\n    }\r\n    function atfontface() {\r\n        var pos = position();\r\n        var m = match(/^@font-face\\s*/);\r\n        if (!m) {\r\n            return;\r\n        }\r\n        if (!open()) {\r\n            return error(\"@font-face missing '{'\");\r\n        }\r\n        var decls = comments();\r\n        var decl;\r\n        while ((decl = declaration())) {\r\n            decls.push(decl);\r\n            decls = decls.concat(comments());\r\n        }\r\n        if (!close()) {\r\n            return error(\"@font-face missing '}'\");\r\n        }\r\n        return pos({\r\n            type: 'font-face',\r\n            declarations: decls\r\n        });\r\n    }\r\n    var atimport = _compileAtrule('import');\r\n    var atcharset = _compileAtrule('charset');\r\n    var atnamespace = _compileAtrule('namespace');\r\n    function _compileAtrule(name) {\r\n        var re = new RegExp('^@' + name + '\\\\s*([^;]+);');\r\n        return function () {\r\n            var pos = position();\r\n            var m = match(re);\r\n            if (!m) {\r\n                return;\r\n            }\r\n            var ret = { type: name };\r\n            ret[name] = m[1].trim();\r\n            return pos(ret);\r\n        };\r\n    }\r\n    function atrule() {\r\n        if (css[0] !== '@') {\r\n            return;\r\n        }\r\n        return (atkeyframes() ||\r\n            atmedia() ||\r\n            atcustommedia() ||\r\n            atsupports() ||\r\n            atimport() ||\r\n            atcharset() ||\r\n            atnamespace() ||\r\n            atdocument() ||\r\n            atpage() ||\r\n            athost() ||\r\n            atfontface());\r\n    }\r\n    function rule() {\r\n        var pos = position();\r\n        var sel = selector();\r\n        if (!sel) {\r\n            return error('selector missing');\r\n        }\r\n        comments();\r\n        return pos({\r\n            type: 'rule',\r\n            selectors: sel,\r\n            declarations: declarations()\r\n        });\r\n    }\r\n    return addParent(stylesheet());\r\n}\r\nfunction trim(str) {\r\n    return str ? str.replace(/^\\s+|\\s+$/g, '') : '';\r\n}\r\nfunction addParent(obj, parent) {\r\n    var isNode = obj && typeof obj.type === 'string';\r\n    var childParent = isNode ? obj : parent;\r\n    for (var _i = 0, _a = Object.keys(obj); _i < _a.length; _i++) {\r\n        var k = _a[_i];\r\n        var value = obj[k];\r\n        if (Array.isArray(value)) {\r\n            value.forEach(function (v) {\r\n                addParent(v, childParent);\r\n            });\r\n        }\r\n        else if (value && typeof value === 'object') {\r\n            addParent(value, childParent);\r\n        }\r\n    }\r\n    if (isNode) {\r\n        Object.defineProperty(obj, 'parent', {\r\n            configurable: true,\r\n            writable: true,\r\n            enumerable: false,\r\n            value: parent || null\r\n        });\r\n    }\r\n    return obj;\r\n}\n\nvar tagMap = {\r\n    script: 'noscript',\r\n    altglyph: 'altGlyph',\r\n    altglyphdef: 'altGlyphDef',\r\n    altglyphitem: 'altGlyphItem',\r\n    animatecolor: 'animateColor',\r\n    animatemotion: 'animateMotion',\r\n    animatetransform: 'animateTransform',\r\n    clippath: 'clipPath',\r\n    feblend: 'feBlend',\r\n    fecolormatrix: 'feColorMatrix',\r\n    fecomponenttransfer: 'feComponentTransfer',\r\n    fecomposite: 'feComposite',\r\n    feconvolvematrix: 'feConvolveMatrix',\r\n    fediffuselighting: 'feDiffuseLighting',\r\n    fedisplacementmap: 'feDisplacementMap',\r\n    fedistantlight: 'feDistantLight',\r\n    fedropshadow: 'feDropShadow',\r\n    feflood: 'feFlood',\r\n    fefunca: 'feFuncA',\r\n    fefuncb: 'feFuncB',\r\n    fefuncg: 'feFuncG',\r\n    fefuncr: 'feFuncR',\r\n    fegaussianblur: 'feGaussianBlur',\r\n    feimage: 'feImage',\r\n    femerge: 'feMerge',\r\n    femergenode: 'feMergeNode',\r\n    femorphology: 'feMorphology',\r\n    feoffset: 'feOffset',\r\n    fepointlight: 'fePointLight',\r\n    fespecularlighting: 'feSpecularLighting',\r\n    fespotlight: 'feSpotLight',\r\n    fetile: 'feTile',\r\n    feturbulence: 'feTurbulence',\r\n    foreignobject: 'foreignObject',\r\n    glyphref: 'glyphRef',\r\n    lineargradient: 'linearGradient',\r\n    radialgradient: 'radialGradient'\r\n};\r\nfunction getTagName(n) {\r\n    var tagName = tagMap[n.tagName] ? tagMap[n.tagName] : n.tagName;\r\n    if (tagName === 'link' && n.attributes._cssText) {\r\n        tagName = 'style';\r\n    }\r\n    return tagName;\r\n}\r\nfunction escapeRegExp(str) {\r\n    return str.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\r\n}\r\nvar HOVER_SELECTOR = /([^\\\\]):hover/;\r\nvar HOVER_SELECTOR_GLOBAL = new RegExp(HOVER_SELECTOR.source, 'g');\r\nfunction addHoverClass(cssText, cache) {\r\n    var cachedStyle = cache === null || cache === void 0 ? void 0 : cache.stylesWithHoverClass.get(cssText);\r\n    if (cachedStyle)\r\n        return cachedStyle;\r\n    var ast = parse(cssText, {\r\n        silent: true\r\n    });\r\n    if (!ast.stylesheet) {\r\n        return cssText;\r\n    }\r\n    var selectors = [];\r\n    ast.stylesheet.rules.forEach(function (rule) {\r\n        if ('selectors' in rule) {\r\n            (rule.selectors || []).forEach(function (selector) {\r\n                if (HOVER_SELECTOR.test(selector)) {\r\n                    selectors.push(selector);\r\n                }\r\n            });\r\n        }\r\n    });\r\n    if (selectors.length === 0) {\r\n        return cssText;\r\n    }\r\n    var selectorMatcher = new RegExp(selectors\r\n        .filter(function (selector, index) { return selectors.indexOf(selector) === index; })\r\n        .sort(function (a, b) { return b.length - a.length; })\r\n        .map(function (selector) {\r\n        return escapeRegExp(selector);\r\n    })\r\n        .join('|'), 'g');\r\n    var result = cssText.replace(selectorMatcher, function (selector) {\r\n        var newSelector = selector.replace(HOVER_SELECTOR_GLOBAL, '$1.\\\\:hover');\r\n        return \"\".concat(selector, \", \").concat(newSelector);\r\n    });\r\n    cache === null || cache === void 0 ? void 0 : cache.stylesWithHoverClass.set(cssText, result);\r\n    return result;\r\n}\r\nfunction createCache() {\r\n    var stylesWithHoverClass = new Map();\r\n    return {\r\n        stylesWithHoverClass: stylesWithHoverClass\r\n    };\r\n}\r\nfunction buildNode(n, options) {\r\n    var doc = options.doc, hackCss = options.hackCss, cache = options.cache;\r\n    switch (n.type) {\r\n        case NodeType.Document:\r\n            return doc.implementation.createDocument(null, '', null);\r\n        case NodeType.DocumentType:\r\n            return doc.implementation.createDocumentType(n.name || 'html', n.publicId, n.systemId);\r\n        case NodeType.Element: {\r\n            var tagName = getTagName(n);\r\n            var node_1;\r\n            if (n.isSVG) {\r\n                node_1 = doc.createElementNS('http://www.w3.org/2000/svg', tagName);\r\n            }\r\n            else {\r\n                node_1 = doc.createElement(tagName);\r\n            }\r\n            var specialAttributes = {};\r\n            for (var name_1 in n.attributes) {\r\n                if (!Object.prototype.hasOwnProperty.call(n.attributes, name_1)) {\r\n                    continue;\r\n                }\r\n                var value = n.attributes[name_1];\r\n                if (tagName === 'option' &&\r\n                    name_1 === 'selected' &&\r\n                    value === false) {\r\n                    continue;\r\n                }\r\n                if (value === true)\r\n                    value = '';\r\n                if (name_1.startsWith('rr_')) {\r\n                    specialAttributes[name_1] = value;\r\n                    continue;\r\n                }\r\n                var isTextarea = tagName === 'textarea' && name_1 === 'value';\r\n                var isRemoteOrDynamicCss = tagName === 'style' && name_1 === '_cssText';\r\n                if (isRemoteOrDynamicCss && hackCss && typeof value === 'string') {\r\n                    value = addHoverClass(value, cache);\r\n                }\r\n                if ((isTextarea || isRemoteOrDynamicCss) && typeof value === 'string') {\r\n                    var child = doc.createTextNode(value);\r\n                    for (var _i = 0, _a = Array.from(node_1.childNodes); _i < _a.length; _i++) {\r\n                        var c = _a[_i];\r\n                        if (c.nodeType === node_1.TEXT_NODE) {\r\n                            node_1.removeChild(c);\r\n                        }\r\n                    }\r\n                    node_1.appendChild(child);\r\n                    continue;\r\n                }\r\n                try {\r\n                    if (n.isSVG && name_1 === 'xlink:href') {\r\n                        node_1.setAttributeNS('http://www.w3.org/1999/xlink', name_1, value.toString());\r\n                    }\r\n                    else if (name_1 === 'onload' ||\r\n                        name_1 === 'onclick' ||\r\n                        name_1.substring(0, 7) === 'onmouse') {\r\n                        node_1.setAttribute('_' + name_1, value.toString());\r\n                    }\r\n                    else if (tagName === 'meta' &&\r\n                        n.attributes['http-equiv'] === 'Content-Security-Policy' &&\r\n                        name_1 === 'content') {\r\n                        node_1.setAttribute('csp-content', value.toString());\r\n                        continue;\r\n                    }\r\n                    else if (tagName === 'link' &&\r\n                        n.attributes.rel === 'preload' &&\r\n                        n.attributes.as === 'script') {\r\n                    }\r\n                    else if (tagName === 'link' &&\r\n                        n.attributes.rel === 'prefetch' &&\r\n                        typeof n.attributes.href === 'string' &&\r\n                        n.attributes.href.endsWith('.js')) {\r\n                    }\r\n                    else if (tagName === 'img' &&\r\n                        n.attributes.srcset &&\r\n                        n.attributes.rr_dataURL) {\r\n                        node_1.setAttribute('rrweb-original-srcset', n.attributes.srcset);\r\n                    }\r\n                    else {\r\n                        node_1.setAttribute(name_1, value.toString());\r\n                    }\r\n                }\r\n                catch (error) {\r\n                }\r\n            }\r\n            var _loop_1 = function (name_2) {\r\n                var value = specialAttributes[name_2];\r\n                if (tagName === 'canvas' && name_2 === 'rr_dataURL') {\r\n                    var image_1 = document.createElement('img');\r\n                    image_1.onload = function () {\r\n                        var ctx = node_1.getContext('2d');\r\n                        if (ctx) {\r\n                            ctx.drawImage(image_1, 0, 0, image_1.width, image_1.height);\r\n                        }\r\n                    };\r\n                    image_1.src = value.toString();\r\n                    if (node_1.RRNodeType)\r\n                        node_1.rr_dataURL = value.toString();\r\n                }\r\n                else if (tagName === 'img' && name_2 === 'rr_dataURL') {\r\n                    var image = node_1;\r\n                    if (!image.currentSrc.startsWith('data:')) {\r\n                        image.setAttribute('rrweb-original-src', n.attributes.src);\r\n                        image.src = value.toString();\r\n                    }\r\n                }\r\n                if (name_2 === 'rr_width') {\r\n                    node_1.style.width = value.toString();\r\n                }\r\n                else if (name_2 === 'rr_height') {\r\n                    node_1.style.height = value.toString();\r\n                }\r\n                else if (name_2 === 'rr_mediaCurrentTime' &&\r\n                    typeof value === 'number') {\r\n                    node_1.currentTime = value;\r\n                }\r\n                else if (name_2 === 'rr_mediaState') {\r\n                    switch (value) {\r\n                        case 'played':\r\n                            node_1\r\n                                .play()[\"catch\"](function (e) { return console.warn('media playback error', e); });\r\n                            break;\r\n                        case 'paused':\r\n                            node_1.pause();\r\n                            break;\r\n                    }\r\n                }\r\n            };\r\n            for (var name_2 in specialAttributes) {\r\n                _loop_1(name_2);\r\n            }\r\n            if (n.isShadowHost) {\r\n                if (!node_1.shadowRoot) {\r\n                    node_1.attachShadow({ mode: 'open' });\r\n                }\r\n                else {\r\n                    while (node_1.shadowRoot.firstChild) {\r\n                        node_1.shadowRoot.removeChild(node_1.shadowRoot.firstChild);\r\n                    }\r\n                }\r\n            }\r\n            return node_1;\r\n        }\r\n        case NodeType.Text:\r\n            return doc.createTextNode(n.isStyle && hackCss\r\n                ? addHoverClass(n.textContent, cache)\r\n                : n.textContent);\r\n        case NodeType.CDATA:\r\n            return doc.createCDATASection(n.textContent);\r\n        case NodeType.Comment:\r\n            return doc.createComment(n.textContent);\r\n        default:\r\n            return null;\r\n    }\r\n}\r\nfunction buildNodeWithSN(n, options) {\r\n    var doc = options.doc, mirror = options.mirror, _a = options.skipChild, skipChild = _a === void 0 ? false : _a, _b = options.hackCss, hackCss = _b === void 0 ? true : _b, afterAppend = options.afterAppend, cache = options.cache;\r\n    var node = buildNode(n, { doc: doc, hackCss: hackCss, cache: cache });\r\n    if (!node) {\r\n        return null;\r\n    }\r\n    if (n.rootId && mirror.getNode(n.rootId) !== doc) {\r\n        mirror.replace(n.rootId, doc);\r\n    }\r\n    if (n.type === NodeType.Document) {\r\n        doc.close();\r\n        doc.open();\r\n        if (n.compatMode === 'BackCompat' &&\r\n            n.childNodes &&\r\n            n.childNodes[0].type !== NodeType.DocumentType) {\r\n            if (n.childNodes[0].type === NodeType.Element &&\r\n                'xmlns' in n.childNodes[0].attributes &&\r\n                n.childNodes[0].attributes.xmlns === 'http://www.w3.org/1999/xhtml') {\r\n                doc.write('<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"\">');\r\n            }\r\n            else {\r\n                doc.write('<!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.0 Transitional//EN\" \"\">');\r\n            }\r\n        }\r\n        node = doc;\r\n    }\r\n    mirror.add(node, n);\r\n    if ((n.type === NodeType.Document || n.type === NodeType.Element) &&\r\n        !skipChild) {\r\n        for (var _i = 0, _c = n.childNodes; _i < _c.length; _i++) {\r\n            var childN = _c[_i];\r\n            var childNode = buildNodeWithSN(childN, {\r\n                doc: doc,\r\n                mirror: mirror,\r\n                skipChild: false,\r\n                hackCss: hackCss,\r\n                afterAppend: afterAppend,\r\n                cache: cache\r\n            });\r\n            if (!childNode) {\r\n                console.warn('Failed to rebuild', childN);\r\n                continue;\r\n            }\r\n            if (childN.isShadow && isElement(node) && node.shadowRoot) {\r\n                node.shadowRoot.appendChild(childNode);\r\n            }\r\n            else {\r\n                node.appendChild(childNode);\r\n            }\r\n            if (afterAppend) {\r\n                afterAppend(childNode, childN.id);\r\n            }\r\n        }\r\n    }\r\n    return node;\r\n}\r\nfunction visit(mirror, onVisit) {\r\n    function walk(node) {\r\n        onVisit(node);\r\n    }\r\n    for (var _i = 0, _a = mirror.getIds(); _i < _a.length; _i++) {\r\n        var id = _a[_i];\r\n        if (mirror.has(id)) {\r\n            walk(mirror.getNode(id));\r\n        }\r\n    }\r\n}\r\nfunction handleScroll(node, mirror) {\r\n    var n = mirror.getMeta(node);\r\n    if ((n === null || n === void 0 ? void 0 : n.type) !== NodeType.Element) {\r\n        return;\r\n    }\r\n    var el = node;\r\n    for (var name_3 in n.attributes) {\r\n        if (!(Object.prototype.hasOwnProperty.call(n.attributes, name_3) &&\r\n            name_3.startsWith('rr_'))) {\r\n            continue;\r\n        }\r\n        var value = n.attributes[name_3];\r\n        if (name_3 === 'rr_scrollLeft') {\r\n            el.scrollLeft = value;\r\n        }\r\n        if (name_3 === 'rr_scrollTop') {\r\n            el.scrollTop = value;\r\n        }\r\n    }\r\n}\r\nfunction rebuild(n, options) {\r\n    var doc = options.doc, onVisit = options.onVisit, _a = options.hackCss, hackCss = _a === void 0 ? true : _a, afterAppend = options.afterAppend, cache = options.cache, _b = options.mirror, mirror = _b === void 0 ? new Mirror() : _b;\r\n    var node = buildNodeWithSN(n, {\r\n        doc: doc,\r\n        mirror: mirror,\r\n        skipChild: false,\r\n        hackCss: hackCss,\r\n        afterAppend: afterAppend,\r\n        cache: cache\r\n    });\r\n    visit(mirror, function (visitedNode) {\r\n        if (onVisit) {\r\n            onVisit(visitedNode);\r\n        }\r\n        handleScroll(visitedNode, mirror);\r\n    });\r\n    return node;\r\n}\n\nexport { IGNORED_NODE, Mirror, NodeType, addHoverClass, buildNodeWithSN, classMatchesRegex, cleanupSnapshot, createCache, createMirror, genId, getCssRuleString, getCssRulesString, is2DCanvasBlank, isCSSImportRule, isElement, isNativeShadowDom, isShadowRoot, maskInputValue, needMaskingText, rebuild, serializeNodeWithId, snapshot, transformAttribute, visitSnapshot };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}