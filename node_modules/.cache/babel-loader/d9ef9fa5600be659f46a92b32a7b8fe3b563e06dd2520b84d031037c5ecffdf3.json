{"ast":null,"code":"class CrossOriginIframeMirror {\n  constructor(generateIdFn) {\n    this.generateIdFn = generateIdFn;\n    this.iframeIdToRemoteIdMap = new WeakMap();\n    this.iframeRemoteIdToIdMap = new WeakMap();\n  }\n  getId(iframe, remoteId, idToRemoteMap, remoteToIdMap) {\n    const idToRemoteIdMap = idToRemoteMap || this.getIdToRemoteIdMap(iframe);\n    const remoteIdToIdMap = remoteToIdMap || this.getRemoteIdToIdMap(iframe);\n    let id = idToRemoteIdMap.get(remoteId);\n    if (!id) {\n      id = this.generateIdFn();\n      idToRemoteIdMap.set(remoteId, id);\n      remoteIdToIdMap.set(id, remoteId);\n    }\n    return id;\n  }\n  getIds(iframe, remoteId) {\n    const idToRemoteIdMap = this.getIdToRemoteIdMap(iframe);\n    const remoteIdToIdMap = this.getRemoteIdToIdMap(iframe);\n    return remoteId.map(id => this.getId(iframe, id, idToRemoteIdMap, remoteIdToIdMap));\n  }\n  getRemoteId(iframe, id, map) {\n    const remoteIdToIdMap = map || this.getRemoteIdToIdMap(iframe);\n    if (typeof id !== 'number') return id;\n    const remoteId = remoteIdToIdMap.get(id);\n    if (!remoteId) return -1;\n    return remoteId;\n  }\n  getRemoteIds(iframe, ids) {\n    const remoteIdToIdMap = this.getRemoteIdToIdMap(iframe);\n    return ids.map(id => this.getRemoteId(iframe, id, remoteIdToIdMap));\n  }\n  reset(iframe) {\n    if (!iframe) {\n      this.iframeIdToRemoteIdMap = new WeakMap();\n      this.iframeRemoteIdToIdMap = new WeakMap();\n      return;\n    }\n    this.iframeIdToRemoteIdMap.delete(iframe);\n    this.iframeRemoteIdToIdMap.delete(iframe);\n  }\n  getIdToRemoteIdMap(iframe) {\n    let idToRemoteIdMap = this.iframeIdToRemoteIdMap.get(iframe);\n    if (!idToRemoteIdMap) {\n      idToRemoteIdMap = new Map();\n      this.iframeIdToRemoteIdMap.set(iframe, idToRemoteIdMap);\n    }\n    return idToRemoteIdMap;\n  }\n  getRemoteIdToIdMap(iframe) {\n    let remoteIdToIdMap = this.iframeRemoteIdToIdMap.get(iframe);\n    if (!remoteIdToIdMap) {\n      remoteIdToIdMap = new Map();\n      this.iframeRemoteIdToIdMap.set(iframe, remoteIdToIdMap);\n    }\n    return remoteIdToIdMap;\n  }\n}\nexport { CrossOriginIframeMirror as default };","map":{"version":3,"names":["CrossOriginIframeMirror","constructor","generateIdFn","iframeIdToRemoteIdMap","WeakMap","iframeRemoteIdToIdMap","getId","iframe","remoteId","idToRemoteMap","remoteToIdMap","idToRemoteIdMap","getIdToRemoteIdMap","remoteIdToIdMap","getRemoteIdToIdMap","id","get","set","getIds","map","getRemoteId","getRemoteIds","ids","reset","delete","Map","default"],"sources":["/Users/ogonen/rrweb/node_modules/rrweb/es/rrweb/packages/rrweb/src/record/cross-origin-iframe-mirror.js"],"sourcesContent":["class CrossOriginIframeMirror {\r\n    constructor(generateIdFn) {\r\n        this.generateIdFn = generateIdFn;\r\n        this.iframeIdToRemoteIdMap = new WeakMap();\r\n        this.iframeRemoteIdToIdMap = new WeakMap();\r\n    }\r\n    getId(iframe, remoteId, idToRemoteMap, remoteToIdMap) {\r\n        const idToRemoteIdMap = idToRemoteMap || this.getIdToRemoteIdMap(iframe);\r\n        const remoteIdToIdMap = remoteToIdMap || this.getRemoteIdToIdMap(iframe);\r\n        let id = idToRemoteIdMap.get(remoteId);\r\n        if (!id) {\r\n            id = this.generateIdFn();\r\n            idToRemoteIdMap.set(remoteId, id);\r\n            remoteIdToIdMap.set(id, remoteId);\r\n        }\r\n        return id;\r\n    }\r\n    getIds(iframe, remoteId) {\r\n        const idToRemoteIdMap = this.getIdToRemoteIdMap(iframe);\r\n        const remoteIdToIdMap = this.getRemoteIdToIdMap(iframe);\r\n        return remoteId.map((id) => this.getId(iframe, id, idToRemoteIdMap, remoteIdToIdMap));\r\n    }\r\n    getRemoteId(iframe, id, map) {\r\n        const remoteIdToIdMap = map || this.getRemoteIdToIdMap(iframe);\r\n        if (typeof id !== 'number')\r\n            return id;\r\n        const remoteId = remoteIdToIdMap.get(id);\r\n        if (!remoteId)\r\n            return -1;\r\n        return remoteId;\r\n    }\r\n    getRemoteIds(iframe, ids) {\r\n        const remoteIdToIdMap = this.getRemoteIdToIdMap(iframe);\r\n        return ids.map((id) => this.getRemoteId(iframe, id, remoteIdToIdMap));\r\n    }\r\n    reset(iframe) {\r\n        if (!iframe) {\r\n            this.iframeIdToRemoteIdMap = new WeakMap();\r\n            this.iframeRemoteIdToIdMap = new WeakMap();\r\n            return;\r\n        }\r\n        this.iframeIdToRemoteIdMap.delete(iframe);\r\n        this.iframeRemoteIdToIdMap.delete(iframe);\r\n    }\r\n    getIdToRemoteIdMap(iframe) {\r\n        let idToRemoteIdMap = this.iframeIdToRemoteIdMap.get(iframe);\r\n        if (!idToRemoteIdMap) {\r\n            idToRemoteIdMap = new Map();\r\n            this.iframeIdToRemoteIdMap.set(iframe, idToRemoteIdMap);\r\n        }\r\n        return idToRemoteIdMap;\r\n    }\r\n    getRemoteIdToIdMap(iframe) {\r\n        let remoteIdToIdMap = this.iframeRemoteIdToIdMap.get(iframe);\r\n        if (!remoteIdToIdMap) {\r\n            remoteIdToIdMap = new Map();\r\n            this.iframeRemoteIdToIdMap.set(iframe, remoteIdToIdMap);\r\n        }\r\n        return remoteIdToIdMap;\r\n    }\r\n}\n\nexport { CrossOriginIframeMirror as default };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}