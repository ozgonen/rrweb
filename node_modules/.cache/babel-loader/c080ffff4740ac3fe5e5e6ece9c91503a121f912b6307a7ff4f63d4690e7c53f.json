{"ast":null,"code":"import { maskInputValue } from '../../../rrweb-snapshot/es/rrweb-snapshot.js';\nimport { on, throttle, isBlocked, getWindowHeight, getWindowWidth, hookSetter, patch, isTouchEvent } from '../utils.js';\nimport { MouseInteractions, IncrementalSource } from '../../../types/dist/types.js';\nimport MutationBuffer from './mutation.js';\nconst mutationBuffers = [];\nconst isCSSGroupingRuleSupported = typeof CSSGroupingRule !== 'undefined';\nconst isCSSMediaRuleSupported = typeof CSSMediaRule !== 'undefined';\nconst isCSSSupportsRuleSupported = typeof CSSSupportsRule !== 'undefined';\nconst isCSSConditionRuleSupported = typeof CSSConditionRule !== 'undefined';\nfunction getEventTarget(event) {\n  try {\n    if ('composedPath' in event) {\n      const path = event.composedPath();\n      if (path.length) {\n        return path[0];\n      }\n    } else if ('path' in event && event.path.length) {\n      return event.path[0];\n    }\n    return event.target;\n  } catch (_a) {\n    return event.target;\n  }\n}\nfunction initMutationObserver(options, rootEl) {\n  var _a, _b;\n  const mutationBuffer = new MutationBuffer();\n  mutationBuffers.push(mutationBuffer);\n  mutationBuffer.init(options);\n  let mutationObserverCtor = window.MutationObserver || window.__rrMutationObserver;\n  const angularZoneSymbol = (_b = (_a = window === null || window === void 0 ? void 0 : window.Zone) === null || _a === void 0 ? void 0 : _a.__symbol__) === null || _b === void 0 ? void 0 : _b.call(_a, 'MutationObserver');\n  if (angularZoneSymbol && window[angularZoneSymbol]) {\n    mutationObserverCtor = window[angularZoneSymbol];\n  }\n  const observer = new mutationObserverCtor(mutationBuffer.processMutations.bind(mutationBuffer));\n  observer.observe(rootEl, {\n    attributes: true,\n    attributeOldValue: true,\n    characterData: true,\n    characterDataOldValue: true,\n    childList: true,\n    subtree: true\n  });\n  return observer;\n}\nfunction initMoveObserver({\n  mousemoveCb,\n  sampling,\n  doc,\n  mirror\n}) {\n  if (sampling.mousemove === false) {\n    return () => {};\n  }\n  const threshold = typeof sampling.mousemove === 'number' ? sampling.mousemove : 50;\n  const callbackThreshold = typeof sampling.mousemoveCallback === 'number' ? sampling.mousemoveCallback : 500;\n  let positions = [];\n  let timeBaseline;\n  const wrappedCb = throttle(source => {\n    const totalOffset = Date.now() - timeBaseline;\n    mousemoveCb(positions.map(p => {\n      p.timeOffset -= totalOffset;\n      return p;\n    }), source);\n    positions = [];\n    timeBaseline = null;\n  }, callbackThreshold);\n  const updatePosition = throttle(evt => {\n    const target = getEventTarget(evt);\n    const {\n      clientX,\n      clientY\n    } = isTouchEvent(evt) ? evt.changedTouches[0] : evt;\n    if (!timeBaseline) {\n      timeBaseline = Date.now();\n    }\n    positions.push({\n      x: clientX,\n      y: clientY,\n      id: mirror.getId(target),\n      timeOffset: Date.now() - timeBaseline\n    });\n    wrappedCb(typeof DragEvent !== 'undefined' && evt instanceof DragEvent ? IncrementalSource.Drag : evt instanceof MouseEvent ? IncrementalSource.MouseMove : IncrementalSource.TouchMove);\n  }, threshold, {\n    trailing: false\n  });\n  const handlers = [on('mousemove', updatePosition, doc), on('touchmove', updatePosition, doc), on('drag', updatePosition, doc)];\n  return () => {\n    handlers.forEach(h => h());\n  };\n}\nfunction initMouseInteractionObserver({\n  mouseInteractionCb,\n  doc,\n  mirror,\n  blockClass,\n  blockSelector,\n  sampling\n}) {\n  if (sampling.mouseInteraction === false) {\n    return () => {};\n  }\n  const disableMap = sampling.mouseInteraction === true || sampling.mouseInteraction === undefined ? {} : sampling.mouseInteraction;\n  const handlers = [];\n  const getHandler = eventKey => {\n    return event => {\n      const target = getEventTarget(event);\n      if (isBlocked(target, blockClass, blockSelector, true)) {\n        return;\n      }\n      const e = isTouchEvent(event) ? event.changedTouches[0] : event;\n      if (!e) {\n        return;\n      }\n      const id = mirror.getId(target);\n      const {\n        clientX,\n        clientY\n      } = e;\n      mouseInteractionCb({\n        type: MouseInteractions[eventKey],\n        id,\n        x: clientX,\n        y: clientY\n      });\n    };\n  };\n  Object.keys(MouseInteractions).filter(key => Number.isNaN(Number(key)) && !key.endsWith('_Departed') && disableMap[key] !== false).forEach(eventKey => {\n    const eventName = eventKey.toLowerCase();\n    const handler = getHandler(eventKey);\n    handlers.push(on(eventName, handler, doc));\n  });\n  return () => {\n    handlers.forEach(h => h());\n  };\n}\nfunction initScrollObserver({\n  scrollCb,\n  doc,\n  mirror,\n  blockClass,\n  blockSelector,\n  sampling\n}) {\n  const updatePosition = throttle(evt => {\n    const target = getEventTarget(evt);\n    if (!target || isBlocked(target, blockClass, blockSelector, true)) {\n      return;\n    }\n    const id = mirror.getId(target);\n    if (target === doc) {\n      const scrollEl = doc.scrollingElement || doc.documentElement;\n      scrollCb({\n        id,\n        x: scrollEl.scrollLeft,\n        y: scrollEl.scrollTop\n      });\n    } else {\n      scrollCb({\n        id,\n        x: target.scrollLeft,\n        y: target.scrollTop\n      });\n    }\n  }, sampling.scroll || 100);\n  return on('scroll', updatePosition, doc);\n}\nfunction initViewportResizeObserver({\n  viewportResizeCb\n}) {\n  let lastH = -1;\n  let lastW = -1;\n  const updateDimension = throttle(() => {\n    const height = getWindowHeight();\n    const width = getWindowWidth();\n    if (lastH !== height || lastW !== width) {\n      viewportResizeCb({\n        width: Number(width),\n        height: Number(height)\n      });\n      lastH = height;\n      lastW = width;\n    }\n  }, 200);\n  return on('resize', updateDimension, window);\n}\nfunction wrapEventWithUserTriggeredFlag(v, enable) {\n  const value = Object.assign({}, v);\n  if (!enable) delete value.userTriggered;\n  return value;\n}\nconst INPUT_TAGS = ['INPUT', 'TEXTAREA', 'SELECT'];\nconst lastInputValueMap = new WeakMap();\nfunction initInputObserver({\n  inputCb,\n  doc,\n  mirror,\n  blockClass,\n  blockSelector,\n  ignoreClass,\n  maskInputOptions,\n  maskInputFn,\n  sampling,\n  userTriggeredOnInput\n}) {\n  function eventHandler(event) {\n    let target = getEventTarget(event);\n    const userTriggered = event.isTrusted;\n    if (target && target.tagName === 'OPTION') target = target.parentElement;\n    if (!target || !target.tagName || INPUT_TAGS.indexOf(target.tagName) < 0 || isBlocked(target, blockClass, blockSelector, true)) {\n      return;\n    }\n    const type = target.type;\n    if (target.classList.contains(ignoreClass)) {\n      return;\n    }\n    let text = target.value;\n    let isChecked = false;\n    if (type === 'radio' || type === 'checkbox') {\n      isChecked = target.checked;\n    } else if (maskInputOptions[target.tagName.toLowerCase()] || maskInputOptions[type]) {\n      text = maskInputValue({\n        maskInputOptions,\n        tagName: target.tagName,\n        type,\n        value: text,\n        maskInputFn\n      });\n    }\n    cbWithDedup(target, wrapEventWithUserTriggeredFlag({\n      text,\n      isChecked,\n      userTriggered\n    }, userTriggeredOnInput));\n    const name = target.name;\n    if (type === 'radio' && name && isChecked) {\n      doc.querySelectorAll(`input[type=\"radio\"][name=\"${name}\"]`).forEach(el => {\n        if (el !== target) {\n          cbWithDedup(el, wrapEventWithUserTriggeredFlag({\n            text: el.value,\n            isChecked: !isChecked,\n            userTriggered: false\n          }, userTriggeredOnInput));\n        }\n      });\n    }\n  }\n  function cbWithDedup(target, v) {\n    const lastInputValue = lastInputValueMap.get(target);\n    if (!lastInputValue || lastInputValue.text !== v.text || lastInputValue.isChecked !== v.isChecked) {\n      lastInputValueMap.set(target, v);\n      const id = mirror.getId(target);\n      inputCb(Object.assign(Object.assign({}, v), {\n        id\n      }));\n    }\n  }\n  const events = sampling.input === 'last' ? ['change'] : ['input', 'change'];\n  const handlers = events.map(eventName => on(eventName, eventHandler, doc));\n  const currentWindow = doc.defaultView;\n  if (!currentWindow) {\n    return () => {\n      handlers.forEach(h => h());\n    };\n  }\n  const propertyDescriptor = currentWindow.Object.getOwnPropertyDescriptor(currentWindow.HTMLInputElement.prototype, 'value');\n  const hookProperties = [[currentWindow.HTMLInputElement.prototype, 'value'], [currentWindow.HTMLInputElement.prototype, 'checked'], [currentWindow.HTMLSelectElement.prototype, 'value'], [currentWindow.HTMLTextAreaElement.prototype, 'value'], [currentWindow.HTMLSelectElement.prototype, 'selectedIndex'], [currentWindow.HTMLOptionElement.prototype, 'selected']];\n  if (propertyDescriptor && propertyDescriptor.set) {\n    handlers.push(...hookProperties.map(p => hookSetter(p[0], p[1], {\n      set() {\n        eventHandler({\n          target: this\n        });\n      }\n    }, false, currentWindow)));\n  }\n  return () => {\n    handlers.forEach(h => h());\n  };\n}\nfunction getNestedCSSRulePositions(rule) {\n  const positions = [];\n  function recurse(childRule, pos) {\n    if (isCSSGroupingRuleSupported && childRule.parentRule instanceof CSSGroupingRule || isCSSMediaRuleSupported && childRule.parentRule instanceof CSSMediaRule || isCSSSupportsRuleSupported && childRule.parentRule instanceof CSSSupportsRule || isCSSConditionRuleSupported && childRule.parentRule instanceof CSSConditionRule) {\n      const rules = Array.from(childRule.parentRule.cssRules);\n      const index = rules.indexOf(childRule);\n      pos.unshift(index);\n    } else if (childRule.parentStyleSheet) {\n      const rules = Array.from(childRule.parentStyleSheet.cssRules);\n      const index = rules.indexOf(childRule);\n      pos.unshift(index);\n    }\n    return pos;\n  }\n  return recurse(rule, positions);\n}\nfunction getIdAndStyleId(sheet, mirror, styleMirror) {\n  let id, styleId;\n  if (!sheet) return {};\n  if (sheet.ownerNode) id = mirror.getId(sheet.ownerNode);else styleId = styleMirror.getId(sheet);\n  return {\n    styleId,\n    id\n  };\n}\nfunction initStyleSheetObserver({\n  styleSheetRuleCb,\n  mirror,\n  stylesheetManager\n}, {\n  win\n}) {\n  const insertRule = win.CSSStyleSheet.prototype.insertRule;\n  win.CSSStyleSheet.prototype.insertRule = function (rule, index) {\n    const {\n      id,\n      styleId\n    } = getIdAndStyleId(this, mirror, stylesheetManager.styleMirror);\n    if (id && id !== -1 || styleId && styleId !== -1) {\n      styleSheetRuleCb({\n        id,\n        styleId,\n        adds: [{\n          rule,\n          index\n        }]\n      });\n    }\n    return insertRule.apply(this, [rule, index]);\n  };\n  const deleteRule = win.CSSStyleSheet.prototype.deleteRule;\n  win.CSSStyleSheet.prototype.deleteRule = function (index) {\n    const {\n      id,\n      styleId\n    } = getIdAndStyleId(this, mirror, stylesheetManager.styleMirror);\n    if (id && id !== -1 || styleId && styleId !== -1) {\n      styleSheetRuleCb({\n        id,\n        styleId,\n        removes: [{\n          index\n        }]\n      });\n    }\n    return deleteRule.apply(this, [index]);\n  };\n  let replace;\n  if (win.CSSStyleSheet.prototype.replace) {\n    replace = win.CSSStyleSheet.prototype.replace;\n    win.CSSStyleSheet.prototype.replace = function (text) {\n      const {\n        id,\n        styleId\n      } = getIdAndStyleId(this, mirror, stylesheetManager.styleMirror);\n      if (id && id !== -1 || styleId && styleId !== -1) {\n        styleSheetRuleCb({\n          id,\n          styleId,\n          replace: text\n        });\n      }\n      return replace.apply(this, [text]);\n    };\n  }\n  let replaceSync;\n  if (win.CSSStyleSheet.prototype.replaceSync) {\n    replaceSync = win.CSSStyleSheet.prototype.replaceSync;\n    win.CSSStyleSheet.prototype.replaceSync = function (text) {\n      const {\n        id,\n        styleId\n      } = getIdAndStyleId(this, mirror, stylesheetManager.styleMirror);\n      if (id && id !== -1 || styleId && styleId !== -1) {\n        styleSheetRuleCb({\n          id,\n          styleId,\n          replaceSync: text\n        });\n      }\n      return replaceSync.apply(this, [text]);\n    };\n  }\n  const supportedNestedCSSRuleTypes = {};\n  if (isCSSGroupingRuleSupported) {\n    supportedNestedCSSRuleTypes.CSSGroupingRule = win.CSSGroupingRule;\n  } else {\n    if (isCSSMediaRuleSupported) {\n      supportedNestedCSSRuleTypes.CSSMediaRule = win.CSSMediaRule;\n    }\n    if (isCSSConditionRuleSupported) {\n      supportedNestedCSSRuleTypes.CSSConditionRule = win.CSSConditionRule;\n    }\n    if (isCSSSupportsRuleSupported) {\n      supportedNestedCSSRuleTypes.CSSSupportsRule = win.CSSSupportsRule;\n    }\n  }\n  const unmodifiedFunctions = {};\n  Object.entries(supportedNestedCSSRuleTypes).forEach(([typeKey, type]) => {\n    unmodifiedFunctions[typeKey] = {\n      insertRule: type.prototype.insertRule,\n      deleteRule: type.prototype.deleteRule\n    };\n    type.prototype.insertRule = function (rule, index) {\n      const {\n        id,\n        styleId\n      } = getIdAndStyleId(this.parentStyleSheet, mirror, stylesheetManager.styleMirror);\n      if (id && id !== -1 || styleId && styleId !== -1) {\n        styleSheetRuleCb({\n          id,\n          styleId,\n          adds: [{\n            rule,\n            index: [...getNestedCSSRulePositions(this), index || 0]\n          }]\n        });\n      }\n      return unmodifiedFunctions[typeKey].insertRule.apply(this, [rule, index]);\n    };\n    type.prototype.deleteRule = function (index) {\n      const {\n        id,\n        styleId\n      } = getIdAndStyleId(this.parentStyleSheet, mirror, stylesheetManager.styleMirror);\n      if (id && id !== -1 || styleId && styleId !== -1) {\n        styleSheetRuleCb({\n          id,\n          styleId,\n          removes: [{\n            index: [...getNestedCSSRulePositions(this), index]\n          }]\n        });\n      }\n      return unmodifiedFunctions[typeKey].deleteRule.apply(this, [index]);\n    };\n  });\n  return () => {\n    win.CSSStyleSheet.prototype.insertRule = insertRule;\n    win.CSSStyleSheet.prototype.deleteRule = deleteRule;\n    replace && (win.CSSStyleSheet.prototype.replace = replace);\n    replaceSync && (win.CSSStyleSheet.prototype.replaceSync = replaceSync);\n    Object.entries(supportedNestedCSSRuleTypes).forEach(([typeKey, type]) => {\n      type.prototype.insertRule = unmodifiedFunctions[typeKey].insertRule;\n      type.prototype.deleteRule = unmodifiedFunctions[typeKey].deleteRule;\n    });\n  };\n}\nfunction initAdoptedStyleSheetObserver({\n  mirror,\n  stylesheetManager\n}, host) {\n  var _a, _b, _c;\n  let hostId = null;\n  if (host.nodeName === '#document') hostId = mirror.getId(host);else hostId = mirror.getId(host.host);\n  const patchTarget = host.nodeName === '#document' ? (_a = host.defaultView) === null || _a === void 0 ? void 0 : _a.Document : (_c = (_b = host.ownerDocument) === null || _b === void 0 ? void 0 : _b.defaultView) === null || _c === void 0 ? void 0 : _c.ShadowRoot;\n  const originalPropertyDescriptor = Object.getOwnPropertyDescriptor(patchTarget === null || patchTarget === void 0 ? void 0 : patchTarget.prototype, 'adoptedStyleSheets');\n  if (hostId === null || hostId === -1 || !patchTarget || !originalPropertyDescriptor) return () => {};\n  Object.defineProperty(host, 'adoptedStyleSheets', {\n    configurable: originalPropertyDescriptor.configurable,\n    enumerable: originalPropertyDescriptor.enumerable,\n    get() {\n      var _a;\n      return (_a = originalPropertyDescriptor.get) === null || _a === void 0 ? void 0 : _a.call(this);\n    },\n    set(sheets) {\n      var _a;\n      const result = (_a = originalPropertyDescriptor.set) === null || _a === void 0 ? void 0 : _a.call(this, sheets);\n      if (hostId !== null && hostId !== -1) {\n        try {\n          stylesheetManager.adoptStyleSheets(sheets, hostId);\n        } catch (e) {}\n      }\n      return result;\n    }\n  });\n  return () => {\n    Object.defineProperty(host, 'adoptedStyleSheets', {\n      configurable: originalPropertyDescriptor.configurable,\n      enumerable: originalPropertyDescriptor.enumerable,\n      get: originalPropertyDescriptor.get,\n      set: originalPropertyDescriptor.set\n    });\n  };\n}\nfunction initStyleDeclarationObserver({\n  styleDeclarationCb,\n  mirror,\n  ignoreCSSAttributes,\n  stylesheetManager\n}, {\n  win\n}) {\n  const setProperty = win.CSSStyleDeclaration.prototype.setProperty;\n  win.CSSStyleDeclaration.prototype.setProperty = function (property, value, priority) {\n    var _a;\n    if (ignoreCSSAttributes.has(property)) {\n      return setProperty.apply(this, [property, value, priority]);\n    }\n    const {\n      id,\n      styleId\n    } = getIdAndStyleId((_a = this.parentRule) === null || _a === void 0 ? void 0 : _a.parentStyleSheet, mirror, stylesheetManager.styleMirror);\n    if (id && id !== -1 || styleId && styleId !== -1) {\n      styleDeclarationCb({\n        id,\n        styleId,\n        set: {\n          property,\n          value,\n          priority\n        },\n        index: getNestedCSSRulePositions(this.parentRule)\n      });\n    }\n    return setProperty.apply(this, [property, value, priority]);\n  };\n  const removeProperty = win.CSSStyleDeclaration.prototype.removeProperty;\n  win.CSSStyleDeclaration.prototype.removeProperty = function (property) {\n    var _a;\n    if (ignoreCSSAttributes.has(property)) {\n      return removeProperty.apply(this, [property]);\n    }\n    const {\n      id,\n      styleId\n    } = getIdAndStyleId((_a = this.parentRule) === null || _a === void 0 ? void 0 : _a.parentStyleSheet, mirror, stylesheetManager.styleMirror);\n    if (id && id !== -1 || styleId && styleId !== -1) {\n      styleDeclarationCb({\n        id,\n        styleId,\n        remove: {\n          property\n        },\n        index: getNestedCSSRulePositions(this.parentRule)\n      });\n    }\n    return removeProperty.apply(this, [property]);\n  };\n  return () => {\n    win.CSSStyleDeclaration.prototype.setProperty = setProperty;\n    win.CSSStyleDeclaration.prototype.removeProperty = removeProperty;\n  };\n}\nfunction initMediaInteractionObserver({\n  mediaInteractionCb,\n  blockClass,\n  blockSelector,\n  mirror,\n  sampling\n}) {\n  const handler = type => throttle(event => {\n    const target = getEventTarget(event);\n    if (!target || isBlocked(target, blockClass, blockSelector, true)) {\n      return;\n    }\n    const {\n      currentTime,\n      volume,\n      muted,\n      playbackRate\n    } = target;\n    mediaInteractionCb({\n      type,\n      id: mirror.getId(target),\n      currentTime,\n      volume,\n      muted,\n      playbackRate\n    });\n  }, sampling.media || 500);\n  const handlers = [on('play', handler(0)), on('pause', handler(1)), on('seeked', handler(2)), on('volumechange', handler(3)), on('ratechange', handler(4))];\n  return () => {\n    handlers.forEach(h => h());\n  };\n}\nfunction initFontObserver({\n  fontCb,\n  doc\n}) {\n  const win = doc.defaultView;\n  if (!win) {\n    return () => {};\n  }\n  const handlers = [];\n  const fontMap = new WeakMap();\n  const originalFontFace = win.FontFace;\n  win.FontFace = function FontFace(family, source, descriptors) {\n    const fontFace = new originalFontFace(family, source, descriptors);\n    fontMap.set(fontFace, {\n      family,\n      buffer: typeof source !== 'string',\n      descriptors,\n      fontSource: typeof source === 'string' ? source : JSON.stringify(Array.from(new Uint8Array(source)))\n    });\n    return fontFace;\n  };\n  const restoreHandler = patch(doc.fonts, 'add', function (original) {\n    return function (fontFace) {\n      setTimeout(() => {\n        const p = fontMap.get(fontFace);\n        if (p) {\n          fontCb(p);\n          fontMap.delete(fontFace);\n        }\n      }, 0);\n      return original.apply(this, [fontFace]);\n    };\n  });\n  handlers.push(() => {\n    win.FontFace = originalFontFace;\n  });\n  handlers.push(restoreHandler);\n  return () => {\n    handlers.forEach(h => h());\n  };\n}\nfunction initSelectionObserver(param) {\n  const {\n    doc,\n    mirror,\n    blockClass,\n    blockSelector,\n    selectionCb\n  } = param;\n  let collapsed = true;\n  const updateSelection = () => {\n    const selection = doc.getSelection();\n    if (!selection || collapsed && (selection === null || selection === void 0 ? void 0 : selection.isCollapsed)) return;\n    collapsed = selection.isCollapsed || false;\n    const ranges = [];\n    const count = selection.rangeCount || 0;\n    for (let i = 0; i < count; i++) {\n      const range = selection.getRangeAt(i);\n      const {\n        startContainer,\n        startOffset,\n        endContainer,\n        endOffset\n      } = range;\n      const blocked = isBlocked(startContainer, blockClass, blockSelector, true) || isBlocked(endContainer, blockClass, blockSelector, true);\n      if (blocked) continue;\n      ranges.push({\n        start: mirror.getId(startContainer),\n        startOffset,\n        end: mirror.getId(endContainer),\n        endOffset\n      });\n    }\n    selectionCb({\n      ranges\n    });\n  };\n  updateSelection();\n  return on('selectionchange', updateSelection);\n}\nfunction mergeHooks(o, hooks) {\n  const {\n    mutationCb,\n    mousemoveCb,\n    mouseInteractionCb,\n    scrollCb,\n    viewportResizeCb,\n    inputCb,\n    mediaInteractionCb,\n    styleSheetRuleCb,\n    styleDeclarationCb,\n    canvasMutationCb,\n    fontCb,\n    selectionCb\n  } = o;\n  o.mutationCb = (...p) => {\n    if (hooks.mutation) {\n      hooks.mutation(...p);\n    }\n    mutationCb(...p);\n  };\n  o.mousemoveCb = (...p) => {\n    if (hooks.mousemove) {\n      hooks.mousemove(...p);\n    }\n    mousemoveCb(...p);\n  };\n  o.mouseInteractionCb = (...p) => {\n    if (hooks.mouseInteraction) {\n      hooks.mouseInteraction(...p);\n    }\n    mouseInteractionCb(...p);\n  };\n  o.scrollCb = (...p) => {\n    if (hooks.scroll) {\n      hooks.scroll(...p);\n    }\n    scrollCb(...p);\n  };\n  o.viewportResizeCb = (...p) => {\n    if (hooks.viewportResize) {\n      hooks.viewportResize(...p);\n    }\n    viewportResizeCb(...p);\n  };\n  o.inputCb = (...p) => {\n    if (hooks.input) {\n      hooks.input(...p);\n    }\n    inputCb(...p);\n  };\n  o.mediaInteractionCb = (...p) => {\n    if (hooks.mediaInteaction) {\n      hooks.mediaInteaction(...p);\n    }\n    mediaInteractionCb(...p);\n  };\n  o.styleSheetRuleCb = (...p) => {\n    if (hooks.styleSheetRule) {\n      hooks.styleSheetRule(...p);\n    }\n    styleSheetRuleCb(...p);\n  };\n  o.styleDeclarationCb = (...p) => {\n    if (hooks.styleDeclaration) {\n      hooks.styleDeclaration(...p);\n    }\n    styleDeclarationCb(...p);\n  };\n  o.canvasMutationCb = (...p) => {\n    if (hooks.canvasMutation) {\n      hooks.canvasMutation(...p);\n    }\n    canvasMutationCb(...p);\n  };\n  o.fontCb = (...p) => {\n    if (hooks.font) {\n      hooks.font(...p);\n    }\n    fontCb(...p);\n  };\n  o.selectionCb = (...p) => {\n    if (hooks.selection) {\n      hooks.selection(...p);\n    }\n    selectionCb(...p);\n  };\n}\nfunction initObservers(o, hooks = {}) {\n  const currentWindow = o.doc.defaultView;\n  if (!currentWindow) {\n    return () => {};\n  }\n  mergeHooks(o, hooks);\n  const mutationObserver = initMutationObserver(o, o.doc);\n  const mousemoveHandler = initMoveObserver(o);\n  const mouseInteractionHandler = initMouseInteractionObserver(o);\n  const scrollHandler = initScrollObserver(o);\n  const viewportResizeHandler = initViewportResizeObserver(o);\n  const inputHandler = initInputObserver(o);\n  const mediaInteractionHandler = initMediaInteractionObserver(o);\n  const styleSheetObserver = initStyleSheetObserver(o, {\n    win: currentWindow\n  });\n  const adoptedStyleSheetObserver = initAdoptedStyleSheetObserver(o, o.doc);\n  const styleDeclarationObserver = initStyleDeclarationObserver(o, {\n    win: currentWindow\n  });\n  const fontObserver = o.collectFonts ? initFontObserver(o) : () => {};\n  const selectionObserver = initSelectionObserver(o);\n  const pluginHandlers = [];\n  for (const plugin of o.plugins) {\n    pluginHandlers.push(plugin.observer(plugin.callback, currentWindow, plugin.options));\n  }\n  return () => {\n    mutationBuffers.forEach(b => b.reset());\n    mutationObserver.disconnect();\n    mousemoveHandler();\n    mouseInteractionHandler();\n    scrollHandler();\n    viewportResizeHandler();\n    inputHandler();\n    mediaInteractionHandler();\n    styleSheetObserver();\n    adoptedStyleSheetObserver();\n    styleDeclarationObserver();\n    fontObserver();\n    selectionObserver();\n    pluginHandlers.forEach(h => h());\n  };\n}\nexport { INPUT_TAGS, initAdoptedStyleSheetObserver, initMutationObserver, initObservers, initScrollObserver, mutationBuffers };","map":{"version":3,"names":["maskInputValue","on","throttle","isBlocked","getWindowHeight","getWindowWidth","hookSetter","patch","isTouchEvent","MouseInteractions","IncrementalSource","MutationBuffer","mutationBuffers","isCSSGroupingRuleSupported","CSSGroupingRule","isCSSMediaRuleSupported","CSSMediaRule","isCSSSupportsRuleSupported","CSSSupportsRule","isCSSConditionRuleSupported","CSSConditionRule","getEventTarget","event","path","composedPath","length","target","_a","initMutationObserver","options","rootEl","_b","mutationBuffer","push","init","mutationObserverCtor","window","MutationObserver","__rrMutationObserver","angularZoneSymbol","Zone","__symbol__","call","observer","processMutations","bind","observe","attributes","attributeOldValue","characterData","characterDataOldValue","childList","subtree","initMoveObserver","mousemoveCb","sampling","doc","mirror","mousemove","threshold","callbackThreshold","mousemoveCallback","positions","timeBaseline","wrappedCb","source","totalOffset","Date","now","map","p","timeOffset","updatePosition","evt","clientX","clientY","changedTouches","x","y","id","getId","DragEvent","Drag","MouseEvent","MouseMove","TouchMove","trailing","handlers","forEach","h","initMouseInteractionObserver","mouseInteractionCb","blockClass","blockSelector","mouseInteraction","disableMap","undefined","getHandler","eventKey","e","type","Object","keys","filter","key","Number","isNaN","endsWith","eventName","toLowerCase","handler","initScrollObserver","scrollCb","scrollEl","scrollingElement","documentElement","scrollLeft","scrollTop","scroll","initViewportResizeObserver","viewportResizeCb","lastH","lastW","updateDimension","height","width","wrapEventWithUserTriggeredFlag","v","enable","value","assign","userTriggered","INPUT_TAGS","lastInputValueMap","WeakMap","initInputObserver","inputCb","ignoreClass","maskInputOptions","maskInputFn","userTriggeredOnInput","eventHandler","isTrusted","tagName","parentElement","indexOf","classList","contains","text","isChecked","checked","cbWithDedup","name","querySelectorAll","el","lastInputValue","get","set","events","input","currentWindow","defaultView","propertyDescriptor","getOwnPropertyDescriptor","HTMLInputElement","prototype","hookProperties","HTMLSelectElement","HTMLTextAreaElement","HTMLOptionElement","getNestedCSSRulePositions","rule","recurse","childRule","pos","parentRule","rules","Array","from","cssRules","index","unshift","parentStyleSheet","getIdAndStyleId","sheet","styleMirror","styleId","ownerNode","initStyleSheetObserver","styleSheetRuleCb","stylesheetManager","win","insertRule","CSSStyleSheet","adds","apply","deleteRule","removes","replace","replaceSync","supportedNestedCSSRuleTypes","unmodifiedFunctions","entries","typeKey","initAdoptedStyleSheetObserver","host","_c","hostId","nodeName","patchTarget","Document","ownerDocument","ShadowRoot","originalPropertyDescriptor","defineProperty","configurable","enumerable","sheets","result","adoptStyleSheets","initStyleDeclarationObserver","styleDeclarationCb","ignoreCSSAttributes","setProperty","CSSStyleDeclaration","property","priority","has","removeProperty","remove","initMediaInteractionObserver","mediaInteractionCb","currentTime","volume","muted","playbackRate","media","initFontObserver","fontCb","fontMap","originalFontFace","FontFace","family","descriptors","fontFace","buffer","fontSource","JSON","stringify","Uint8Array","restoreHandler","fonts","original","setTimeout","delete","initSelectionObserver","param","selectionCb","collapsed","updateSelection","selection","getSelection","isCollapsed","ranges","count","rangeCount","i","range","getRangeAt","startContainer","startOffset","endContainer","endOffset","blocked","start","end","mergeHooks","o","hooks","mutationCb","canvasMutationCb","mutation","viewportResize","mediaInteaction","styleSheetRule","styleDeclaration","canvasMutation","font","initObservers","mutationObserver","mousemoveHandler","mouseInteractionHandler","scrollHandler","viewportResizeHandler","inputHandler","mediaInteractionHandler","styleSheetObserver","adoptedStyleSheetObserver","styleDeclarationObserver","fontObserver","collectFonts","selectionObserver","pluginHandlers","plugin","plugins","callback","b","reset","disconnect"],"sources":["/Users/ogonen/rrweb/node_modules/rrweb/es/rrweb/packages/rrweb/src/record/observer.js"],"sourcesContent":["import { maskInputValue } from '../../../rrweb-snapshot/es/rrweb-snapshot.js';\nimport { on, throttle, isBlocked, getWindowHeight, getWindowWidth, hookSetter, patch, isTouchEvent } from '../utils.js';\nimport { MouseInteractions, IncrementalSource } from '../../../types/dist/types.js';\nimport MutationBuffer from './mutation.js';\n\nconst mutationBuffers = [];\r\nconst isCSSGroupingRuleSupported = typeof CSSGroupingRule !== 'undefined';\r\nconst isCSSMediaRuleSupported = typeof CSSMediaRule !== 'undefined';\r\nconst isCSSSupportsRuleSupported = typeof CSSSupportsRule !== 'undefined';\r\nconst isCSSConditionRuleSupported = typeof CSSConditionRule !== 'undefined';\r\nfunction getEventTarget(event) {\r\n    try {\r\n        if ('composedPath' in event) {\r\n            const path = event.composedPath();\r\n            if (path.length) {\r\n                return path[0];\r\n            }\r\n        }\r\n        else if ('path' in event && event.path.length) {\r\n            return event.path[0];\r\n        }\r\n        return event.target;\r\n    }\r\n    catch (_a) {\r\n        return event.target;\r\n    }\r\n}\r\nfunction initMutationObserver(options, rootEl) {\r\n    var _a, _b;\r\n    const mutationBuffer = new MutationBuffer();\r\n    mutationBuffers.push(mutationBuffer);\r\n    mutationBuffer.init(options);\r\n    let mutationObserverCtor = window.MutationObserver ||\r\n        window.__rrMutationObserver;\r\n    const angularZoneSymbol = (_b = (_a = window === null || window === void 0 ? void 0 : window.Zone) === null || _a === void 0 ? void 0 : _a.__symbol__) === null || _b === void 0 ? void 0 : _b.call(_a, 'MutationObserver');\r\n    if (angularZoneSymbol &&\r\n        window[angularZoneSymbol]) {\r\n        mutationObserverCtor = window[angularZoneSymbol];\r\n    }\r\n    const observer = new mutationObserverCtor(mutationBuffer.processMutations.bind(mutationBuffer));\r\n    observer.observe(rootEl, {\r\n        attributes: true,\r\n        attributeOldValue: true,\r\n        characterData: true,\r\n        characterDataOldValue: true,\r\n        childList: true,\r\n        subtree: true,\r\n    });\r\n    return observer;\r\n}\r\nfunction initMoveObserver({ mousemoveCb, sampling, doc, mirror, }) {\r\n    if (sampling.mousemove === false) {\r\n        return () => {\r\n        };\r\n    }\r\n    const threshold = typeof sampling.mousemove === 'number' ? sampling.mousemove : 50;\r\n    const callbackThreshold = typeof sampling.mousemoveCallback === 'number'\r\n        ? sampling.mousemoveCallback\r\n        : 500;\r\n    let positions = [];\r\n    let timeBaseline;\r\n    const wrappedCb = throttle((source) => {\r\n        const totalOffset = Date.now() - timeBaseline;\r\n        mousemoveCb(positions.map((p) => {\r\n            p.timeOffset -= totalOffset;\r\n            return p;\r\n        }), source);\r\n        positions = [];\r\n        timeBaseline = null;\r\n    }, callbackThreshold);\r\n    const updatePosition = throttle((evt) => {\r\n        const target = getEventTarget(evt);\r\n        const { clientX, clientY } = isTouchEvent(evt)\r\n            ? evt.changedTouches[0]\r\n            : evt;\r\n        if (!timeBaseline) {\r\n            timeBaseline = Date.now();\r\n        }\r\n        positions.push({\r\n            x: clientX,\r\n            y: clientY,\r\n            id: mirror.getId(target),\r\n            timeOffset: Date.now() - timeBaseline,\r\n        });\r\n        wrappedCb(typeof DragEvent !== 'undefined' && evt instanceof DragEvent\r\n            ? IncrementalSource.Drag\r\n            : evt instanceof MouseEvent\r\n                ? IncrementalSource.MouseMove\r\n                : IncrementalSource.TouchMove);\r\n    }, threshold, {\r\n        trailing: false,\r\n    });\r\n    const handlers = [\r\n        on('mousemove', updatePosition, doc),\r\n        on('touchmove', updatePosition, doc),\r\n        on('drag', updatePosition, doc),\r\n    ];\r\n    return () => {\r\n        handlers.forEach((h) => h());\r\n    };\r\n}\r\nfunction initMouseInteractionObserver({ mouseInteractionCb, doc, mirror, blockClass, blockSelector, sampling, }) {\r\n    if (sampling.mouseInteraction === false) {\r\n        return () => {\r\n        };\r\n    }\r\n    const disableMap = sampling.mouseInteraction === true ||\r\n        sampling.mouseInteraction === undefined\r\n        ? {}\r\n        : sampling.mouseInteraction;\r\n    const handlers = [];\r\n    const getHandler = (eventKey) => {\r\n        return (event) => {\r\n            const target = getEventTarget(event);\r\n            if (isBlocked(target, blockClass, blockSelector, true)) {\r\n                return;\r\n            }\r\n            const e = isTouchEvent(event) ? event.changedTouches[0] : event;\r\n            if (!e) {\r\n                return;\r\n            }\r\n            const id = mirror.getId(target);\r\n            const { clientX, clientY } = e;\r\n            mouseInteractionCb({\r\n                type: MouseInteractions[eventKey],\r\n                id,\r\n                x: clientX,\r\n                y: clientY,\r\n            });\r\n        };\r\n    };\r\n    Object.keys(MouseInteractions)\r\n        .filter((key) => Number.isNaN(Number(key)) &&\r\n        !key.endsWith('_Departed') &&\r\n        disableMap[key] !== false)\r\n        .forEach((eventKey) => {\r\n        const eventName = eventKey.toLowerCase();\r\n        const handler = getHandler(eventKey);\r\n        handlers.push(on(eventName, handler, doc));\r\n    });\r\n    return () => {\r\n        handlers.forEach((h) => h());\r\n    };\r\n}\r\nfunction initScrollObserver({ scrollCb, doc, mirror, blockClass, blockSelector, sampling, }) {\r\n    const updatePosition = throttle((evt) => {\r\n        const target = getEventTarget(evt);\r\n        if (!target || isBlocked(target, blockClass, blockSelector, true)) {\r\n            return;\r\n        }\r\n        const id = mirror.getId(target);\r\n        if (target === doc) {\r\n            const scrollEl = (doc.scrollingElement || doc.documentElement);\r\n            scrollCb({\r\n                id,\r\n                x: scrollEl.scrollLeft,\r\n                y: scrollEl.scrollTop,\r\n            });\r\n        }\r\n        else {\r\n            scrollCb({\r\n                id,\r\n                x: target.scrollLeft,\r\n                y: target.scrollTop,\r\n            });\r\n        }\r\n    }, sampling.scroll || 100);\r\n    return on('scroll', updatePosition, doc);\r\n}\r\nfunction initViewportResizeObserver({ viewportResizeCb, }) {\r\n    let lastH = -1;\r\n    let lastW = -1;\r\n    const updateDimension = throttle(() => {\r\n        const height = getWindowHeight();\r\n        const width = getWindowWidth();\r\n        if (lastH !== height || lastW !== width) {\r\n            viewportResizeCb({\r\n                width: Number(width),\r\n                height: Number(height),\r\n            });\r\n            lastH = height;\r\n            lastW = width;\r\n        }\r\n    }, 200);\r\n    return on('resize', updateDimension, window);\r\n}\r\nfunction wrapEventWithUserTriggeredFlag(v, enable) {\r\n    const value = Object.assign({}, v);\r\n    if (!enable)\r\n        delete value.userTriggered;\r\n    return value;\r\n}\r\nconst INPUT_TAGS = ['INPUT', 'TEXTAREA', 'SELECT'];\r\nconst lastInputValueMap = new WeakMap();\r\nfunction initInputObserver({ inputCb, doc, mirror, blockClass, blockSelector, ignoreClass, maskInputOptions, maskInputFn, sampling, userTriggeredOnInput, }) {\r\n    function eventHandler(event) {\r\n        let target = getEventTarget(event);\r\n        const userTriggered = event.isTrusted;\r\n        if (target && target.tagName === 'OPTION')\r\n            target = target.parentElement;\r\n        if (!target ||\r\n            !target.tagName ||\r\n            INPUT_TAGS.indexOf(target.tagName) < 0 ||\r\n            isBlocked(target, blockClass, blockSelector, true)) {\r\n            return;\r\n        }\r\n        const type = target.type;\r\n        if (target.classList.contains(ignoreClass)) {\r\n            return;\r\n        }\r\n        let text = target.value;\r\n        let isChecked = false;\r\n        if (type === 'radio' || type === 'checkbox') {\r\n            isChecked = target.checked;\r\n        }\r\n        else if (maskInputOptions[target.tagName.toLowerCase()] ||\r\n            maskInputOptions[type]) {\r\n            text = maskInputValue({\r\n                maskInputOptions,\r\n                tagName: target.tagName,\r\n                type,\r\n                value: text,\r\n                maskInputFn,\r\n            });\r\n        }\r\n        cbWithDedup(target, wrapEventWithUserTriggeredFlag({ text, isChecked, userTriggered }, userTriggeredOnInput));\r\n        const name = target.name;\r\n        if (type === 'radio' && name && isChecked) {\r\n            doc\r\n                .querySelectorAll(`input[type=\"radio\"][name=\"${name}\"]`)\r\n                .forEach((el) => {\r\n                if (el !== target) {\r\n                    cbWithDedup(el, wrapEventWithUserTriggeredFlag({\r\n                        text: el.value,\r\n                        isChecked: !isChecked,\r\n                        userTriggered: false,\r\n                    }, userTriggeredOnInput));\r\n                }\r\n            });\r\n        }\r\n    }\r\n    function cbWithDedup(target, v) {\r\n        const lastInputValue = lastInputValueMap.get(target);\r\n        if (!lastInputValue ||\r\n            lastInputValue.text !== v.text ||\r\n            lastInputValue.isChecked !== v.isChecked) {\r\n            lastInputValueMap.set(target, v);\r\n            const id = mirror.getId(target);\r\n            inputCb(Object.assign(Object.assign({}, v), { id }));\r\n        }\r\n    }\r\n    const events = sampling.input === 'last' ? ['change'] : ['input', 'change'];\r\n    const handlers = events.map((eventName) => on(eventName, eventHandler, doc));\r\n    const currentWindow = doc.defaultView;\r\n    if (!currentWindow) {\r\n        return () => {\r\n            handlers.forEach((h) => h());\r\n        };\r\n    }\r\n    const propertyDescriptor = currentWindow.Object.getOwnPropertyDescriptor(currentWindow.HTMLInputElement.prototype, 'value');\r\n    const hookProperties = [\r\n        [currentWindow.HTMLInputElement.prototype, 'value'],\r\n        [currentWindow.HTMLInputElement.prototype, 'checked'],\r\n        [currentWindow.HTMLSelectElement.prototype, 'value'],\r\n        [currentWindow.HTMLTextAreaElement.prototype, 'value'],\r\n        [currentWindow.HTMLSelectElement.prototype, 'selectedIndex'],\r\n        [currentWindow.HTMLOptionElement.prototype, 'selected'],\r\n    ];\r\n    if (propertyDescriptor && propertyDescriptor.set) {\r\n        handlers.push(...hookProperties.map((p) => hookSetter(p[0], p[1], {\r\n            set() {\r\n                eventHandler({ target: this });\r\n            },\r\n        }, false, currentWindow)));\r\n    }\r\n    return () => {\r\n        handlers.forEach((h) => h());\r\n    };\r\n}\r\nfunction getNestedCSSRulePositions(rule) {\r\n    const positions = [];\r\n    function recurse(childRule, pos) {\r\n        if ((isCSSGroupingRuleSupported &&\r\n            childRule.parentRule instanceof CSSGroupingRule) ||\r\n            (isCSSMediaRuleSupported &&\r\n                childRule.parentRule instanceof CSSMediaRule) ||\r\n            (isCSSSupportsRuleSupported &&\r\n                childRule.parentRule instanceof CSSSupportsRule) ||\r\n            (isCSSConditionRuleSupported &&\r\n                childRule.parentRule instanceof CSSConditionRule)) {\r\n            const rules = Array.from(childRule.parentRule.cssRules);\r\n            const index = rules.indexOf(childRule);\r\n            pos.unshift(index);\r\n        }\r\n        else if (childRule.parentStyleSheet) {\r\n            const rules = Array.from(childRule.parentStyleSheet.cssRules);\r\n            const index = rules.indexOf(childRule);\r\n            pos.unshift(index);\r\n        }\r\n        return pos;\r\n    }\r\n    return recurse(rule, positions);\r\n}\r\nfunction getIdAndStyleId(sheet, mirror, styleMirror) {\r\n    let id, styleId;\r\n    if (!sheet)\r\n        return {};\r\n    if (sheet.ownerNode)\r\n        id = mirror.getId(sheet.ownerNode);\r\n    else\r\n        styleId = styleMirror.getId(sheet);\r\n    return {\r\n        styleId,\r\n        id,\r\n    };\r\n}\r\nfunction initStyleSheetObserver({ styleSheetRuleCb, mirror, stylesheetManager }, { win }) {\r\n    const insertRule = win.CSSStyleSheet.prototype.insertRule;\r\n    win.CSSStyleSheet.prototype.insertRule = function (rule, index) {\r\n        const { id, styleId } = getIdAndStyleId(this, mirror, stylesheetManager.styleMirror);\r\n        if ((id && id !== -1) || (styleId && styleId !== -1)) {\r\n            styleSheetRuleCb({\r\n                id,\r\n                styleId,\r\n                adds: [{ rule, index }],\r\n            });\r\n        }\r\n        return insertRule.apply(this, [rule, index]);\r\n    };\r\n    const deleteRule = win.CSSStyleSheet.prototype.deleteRule;\r\n    win.CSSStyleSheet.prototype.deleteRule = function (index) {\r\n        const { id, styleId } = getIdAndStyleId(this, mirror, stylesheetManager.styleMirror);\r\n        if ((id && id !== -1) || (styleId && styleId !== -1)) {\r\n            styleSheetRuleCb({\r\n                id,\r\n                styleId,\r\n                removes: [{ index }],\r\n            });\r\n        }\r\n        return deleteRule.apply(this, [index]);\r\n    };\r\n    let replace;\r\n    if (win.CSSStyleSheet.prototype.replace) {\r\n        replace = win.CSSStyleSheet.prototype.replace;\r\n        win.CSSStyleSheet.prototype.replace = function (text) {\r\n            const { id, styleId } = getIdAndStyleId(this, mirror, stylesheetManager.styleMirror);\r\n            if ((id && id !== -1) || (styleId && styleId !== -1)) {\r\n                styleSheetRuleCb({\r\n                    id,\r\n                    styleId,\r\n                    replace: text,\r\n                });\r\n            }\r\n            return replace.apply(this, [text]);\r\n        };\r\n    }\r\n    let replaceSync;\r\n    if (win.CSSStyleSheet.prototype.replaceSync) {\r\n        replaceSync = win.CSSStyleSheet.prototype.replaceSync;\r\n        win.CSSStyleSheet.prototype.replaceSync = function (text) {\r\n            const { id, styleId } = getIdAndStyleId(this, mirror, stylesheetManager.styleMirror);\r\n            if ((id && id !== -1) || (styleId && styleId !== -1)) {\r\n                styleSheetRuleCb({\r\n                    id,\r\n                    styleId,\r\n                    replaceSync: text,\r\n                });\r\n            }\r\n            return replaceSync.apply(this, [text]);\r\n        };\r\n    }\r\n    const supportedNestedCSSRuleTypes = {};\r\n    if (isCSSGroupingRuleSupported) {\r\n        supportedNestedCSSRuleTypes.CSSGroupingRule = win.CSSGroupingRule;\r\n    }\r\n    else {\r\n        if (isCSSMediaRuleSupported) {\r\n            supportedNestedCSSRuleTypes.CSSMediaRule = win.CSSMediaRule;\r\n        }\r\n        if (isCSSConditionRuleSupported) {\r\n            supportedNestedCSSRuleTypes.CSSConditionRule = win.CSSConditionRule;\r\n        }\r\n        if (isCSSSupportsRuleSupported) {\r\n            supportedNestedCSSRuleTypes.CSSSupportsRule = win.CSSSupportsRule;\r\n        }\r\n    }\r\n    const unmodifiedFunctions = {};\r\n    Object.entries(supportedNestedCSSRuleTypes).forEach(([typeKey, type]) => {\r\n        unmodifiedFunctions[typeKey] = {\r\n            insertRule: type.prototype.insertRule,\r\n            deleteRule: type.prototype.deleteRule,\r\n        };\r\n        type.prototype.insertRule = function (rule, index) {\r\n            const { id, styleId } = getIdAndStyleId(this.parentStyleSheet, mirror, stylesheetManager.styleMirror);\r\n            if ((id && id !== -1) || (styleId && styleId !== -1)) {\r\n                styleSheetRuleCb({\r\n                    id,\r\n                    styleId,\r\n                    adds: [\r\n                        {\r\n                            rule,\r\n                            index: [\r\n                                ...getNestedCSSRulePositions(this),\r\n                                index || 0,\r\n                            ],\r\n                        },\r\n                    ],\r\n                });\r\n            }\r\n            return unmodifiedFunctions[typeKey].insertRule.apply(this, [rule, index]);\r\n        };\r\n        type.prototype.deleteRule = function (index) {\r\n            const { id, styleId } = getIdAndStyleId(this.parentStyleSheet, mirror, stylesheetManager.styleMirror);\r\n            if ((id && id !== -1) || (styleId && styleId !== -1)) {\r\n                styleSheetRuleCb({\r\n                    id,\r\n                    styleId,\r\n                    removes: [\r\n                        { index: [...getNestedCSSRulePositions(this), index] },\r\n                    ],\r\n                });\r\n            }\r\n            return unmodifiedFunctions[typeKey].deleteRule.apply(this, [index]);\r\n        };\r\n    });\r\n    return () => {\r\n        win.CSSStyleSheet.prototype.insertRule = insertRule;\r\n        win.CSSStyleSheet.prototype.deleteRule = deleteRule;\r\n        replace && (win.CSSStyleSheet.prototype.replace = replace);\r\n        replaceSync && (win.CSSStyleSheet.prototype.replaceSync = replaceSync);\r\n        Object.entries(supportedNestedCSSRuleTypes).forEach(([typeKey, type]) => {\r\n            type.prototype.insertRule = unmodifiedFunctions[typeKey].insertRule;\r\n            type.prototype.deleteRule = unmodifiedFunctions[typeKey].deleteRule;\r\n        });\r\n    };\r\n}\r\nfunction initAdoptedStyleSheetObserver({ mirror, stylesheetManager, }, host) {\r\n    var _a, _b, _c;\r\n    let hostId = null;\r\n    if (host.nodeName === '#document')\r\n        hostId = mirror.getId(host);\r\n    else\r\n        hostId = mirror.getId(host.host);\r\n    const patchTarget = host.nodeName === '#document'\r\n        ? (_a = host.defaultView) === null || _a === void 0 ? void 0 : _a.Document\r\n        : (_c = (_b = host.ownerDocument) === null || _b === void 0 ? void 0 : _b.defaultView) === null || _c === void 0 ? void 0 : _c.ShadowRoot;\r\n    const originalPropertyDescriptor = Object.getOwnPropertyDescriptor(patchTarget === null || patchTarget === void 0 ? void 0 : patchTarget.prototype, 'adoptedStyleSheets');\r\n    if (hostId === null ||\r\n        hostId === -1 ||\r\n        !patchTarget ||\r\n        !originalPropertyDescriptor)\r\n        return () => {\r\n        };\r\n    Object.defineProperty(host, 'adoptedStyleSheets', {\r\n        configurable: originalPropertyDescriptor.configurable,\r\n        enumerable: originalPropertyDescriptor.enumerable,\r\n        get() {\r\n            var _a;\r\n            return (_a = originalPropertyDescriptor.get) === null || _a === void 0 ? void 0 : _a.call(this);\r\n        },\r\n        set(sheets) {\r\n            var _a;\r\n            const result = (_a = originalPropertyDescriptor.set) === null || _a === void 0 ? void 0 : _a.call(this, sheets);\r\n            if (hostId !== null && hostId !== -1) {\r\n                try {\r\n                    stylesheetManager.adoptStyleSheets(sheets, hostId);\r\n                }\r\n                catch (e) {\r\n                }\r\n            }\r\n            return result;\r\n        },\r\n    });\r\n    return () => {\r\n        Object.defineProperty(host, 'adoptedStyleSheets', {\r\n            configurable: originalPropertyDescriptor.configurable,\r\n            enumerable: originalPropertyDescriptor.enumerable,\r\n            get: originalPropertyDescriptor.get,\r\n            set: originalPropertyDescriptor.set,\r\n        });\r\n    };\r\n}\r\nfunction initStyleDeclarationObserver({ styleDeclarationCb, mirror, ignoreCSSAttributes, stylesheetManager, }, { win }) {\r\n    const setProperty = win.CSSStyleDeclaration.prototype.setProperty;\r\n    win.CSSStyleDeclaration.prototype.setProperty = function (property, value, priority) {\r\n        var _a;\r\n        if (ignoreCSSAttributes.has(property)) {\r\n            return setProperty.apply(this, [property, value, priority]);\r\n        }\r\n        const { id, styleId } = getIdAndStyleId((_a = this.parentRule) === null || _a === void 0 ? void 0 : _a.parentStyleSheet, mirror, stylesheetManager.styleMirror);\r\n        if ((id && id !== -1) || (styleId && styleId !== -1)) {\r\n            styleDeclarationCb({\r\n                id,\r\n                styleId,\r\n                set: {\r\n                    property,\r\n                    value,\r\n                    priority,\r\n                },\r\n                index: getNestedCSSRulePositions(this.parentRule),\r\n            });\r\n        }\r\n        return setProperty.apply(this, [property, value, priority]);\r\n    };\r\n    const removeProperty = win.CSSStyleDeclaration.prototype.removeProperty;\r\n    win.CSSStyleDeclaration.prototype.removeProperty = function (property) {\r\n        var _a;\r\n        if (ignoreCSSAttributes.has(property)) {\r\n            return removeProperty.apply(this, [property]);\r\n        }\r\n        const { id, styleId } = getIdAndStyleId((_a = this.parentRule) === null || _a === void 0 ? void 0 : _a.parentStyleSheet, mirror, stylesheetManager.styleMirror);\r\n        if ((id && id !== -1) || (styleId && styleId !== -1)) {\r\n            styleDeclarationCb({\r\n                id,\r\n                styleId,\r\n                remove: {\r\n                    property,\r\n                },\r\n                index: getNestedCSSRulePositions(this.parentRule),\r\n            });\r\n        }\r\n        return removeProperty.apply(this, [property]);\r\n    };\r\n    return () => {\r\n        win.CSSStyleDeclaration.prototype.setProperty = setProperty;\r\n        win.CSSStyleDeclaration.prototype.removeProperty = removeProperty;\r\n    };\r\n}\r\nfunction initMediaInteractionObserver({ mediaInteractionCb, blockClass, blockSelector, mirror, sampling, }) {\r\n    const handler = (type) => throttle((event) => {\r\n        const target = getEventTarget(event);\r\n        if (!target ||\r\n            isBlocked(target, blockClass, blockSelector, true)) {\r\n            return;\r\n        }\r\n        const { currentTime, volume, muted, playbackRate, } = target;\r\n        mediaInteractionCb({\r\n            type,\r\n            id: mirror.getId(target),\r\n            currentTime,\r\n            volume,\r\n            muted,\r\n            playbackRate,\r\n        });\r\n    }, sampling.media || 500);\r\n    const handlers = [\r\n        on('play', handler(0)),\r\n        on('pause', handler(1)),\r\n        on('seeked', handler(2)),\r\n        on('volumechange', handler(3)),\r\n        on('ratechange', handler(4)),\r\n    ];\r\n    return () => {\r\n        handlers.forEach((h) => h());\r\n    };\r\n}\r\nfunction initFontObserver({ fontCb, doc }) {\r\n    const win = doc.defaultView;\r\n    if (!win) {\r\n        return () => {\r\n        };\r\n    }\r\n    const handlers = [];\r\n    const fontMap = new WeakMap();\r\n    const originalFontFace = win.FontFace;\r\n    win.FontFace = function FontFace(family, source, descriptors) {\r\n        const fontFace = new originalFontFace(family, source, descriptors);\r\n        fontMap.set(fontFace, {\r\n            family,\r\n            buffer: typeof source !== 'string',\r\n            descriptors,\r\n            fontSource: typeof source === 'string'\r\n                ? source\r\n                : JSON.stringify(Array.from(new Uint8Array(source))),\r\n        });\r\n        return fontFace;\r\n    };\r\n    const restoreHandler = patch(doc.fonts, 'add', function (original) {\r\n        return function (fontFace) {\r\n            setTimeout(() => {\r\n                const p = fontMap.get(fontFace);\r\n                if (p) {\r\n                    fontCb(p);\r\n                    fontMap.delete(fontFace);\r\n                }\r\n            }, 0);\r\n            return original.apply(this, [fontFace]);\r\n        };\r\n    });\r\n    handlers.push(() => {\r\n        win.FontFace = originalFontFace;\r\n    });\r\n    handlers.push(restoreHandler);\r\n    return () => {\r\n        handlers.forEach((h) => h());\r\n    };\r\n}\r\nfunction initSelectionObserver(param) {\r\n    const { doc, mirror, blockClass, blockSelector, selectionCb } = param;\r\n    let collapsed = true;\r\n    const updateSelection = () => {\r\n        const selection = doc.getSelection();\r\n        if (!selection || (collapsed && (selection === null || selection === void 0 ? void 0 : selection.isCollapsed)))\r\n            return;\r\n        collapsed = selection.isCollapsed || false;\r\n        const ranges = [];\r\n        const count = selection.rangeCount || 0;\r\n        for (let i = 0; i < count; i++) {\r\n            const range = selection.getRangeAt(i);\r\n            const { startContainer, startOffset, endContainer, endOffset } = range;\r\n            const blocked = isBlocked(startContainer, blockClass, blockSelector, true) ||\r\n                isBlocked(endContainer, blockClass, blockSelector, true);\r\n            if (blocked)\r\n                continue;\r\n            ranges.push({\r\n                start: mirror.getId(startContainer),\r\n                startOffset,\r\n                end: mirror.getId(endContainer),\r\n                endOffset,\r\n            });\r\n        }\r\n        selectionCb({ ranges });\r\n    };\r\n    updateSelection();\r\n    return on('selectionchange', updateSelection);\r\n}\r\nfunction mergeHooks(o, hooks) {\r\n    const { mutationCb, mousemoveCb, mouseInteractionCb, scrollCb, viewportResizeCb, inputCb, mediaInteractionCb, styleSheetRuleCb, styleDeclarationCb, canvasMutationCb, fontCb, selectionCb, } = o;\r\n    o.mutationCb = (...p) => {\r\n        if (hooks.mutation) {\r\n            hooks.mutation(...p);\r\n        }\r\n        mutationCb(...p);\r\n    };\r\n    o.mousemoveCb = (...p) => {\r\n        if (hooks.mousemove) {\r\n            hooks.mousemove(...p);\r\n        }\r\n        mousemoveCb(...p);\r\n    };\r\n    o.mouseInteractionCb = (...p) => {\r\n        if (hooks.mouseInteraction) {\r\n            hooks.mouseInteraction(...p);\r\n        }\r\n        mouseInteractionCb(...p);\r\n    };\r\n    o.scrollCb = (...p) => {\r\n        if (hooks.scroll) {\r\n            hooks.scroll(...p);\r\n        }\r\n        scrollCb(...p);\r\n    };\r\n    o.viewportResizeCb = (...p) => {\r\n        if (hooks.viewportResize) {\r\n            hooks.viewportResize(...p);\r\n        }\r\n        viewportResizeCb(...p);\r\n    };\r\n    o.inputCb = (...p) => {\r\n        if (hooks.input) {\r\n            hooks.input(...p);\r\n        }\r\n        inputCb(...p);\r\n    };\r\n    o.mediaInteractionCb = (...p) => {\r\n        if (hooks.mediaInteaction) {\r\n            hooks.mediaInteaction(...p);\r\n        }\r\n        mediaInteractionCb(...p);\r\n    };\r\n    o.styleSheetRuleCb = (...p) => {\r\n        if (hooks.styleSheetRule) {\r\n            hooks.styleSheetRule(...p);\r\n        }\r\n        styleSheetRuleCb(...p);\r\n    };\r\n    o.styleDeclarationCb = (...p) => {\r\n        if (hooks.styleDeclaration) {\r\n            hooks.styleDeclaration(...p);\r\n        }\r\n        styleDeclarationCb(...p);\r\n    };\r\n    o.canvasMutationCb = (...p) => {\r\n        if (hooks.canvasMutation) {\r\n            hooks.canvasMutation(...p);\r\n        }\r\n        canvasMutationCb(...p);\r\n    };\r\n    o.fontCb = (...p) => {\r\n        if (hooks.font) {\r\n            hooks.font(...p);\r\n        }\r\n        fontCb(...p);\r\n    };\r\n    o.selectionCb = (...p) => {\r\n        if (hooks.selection) {\r\n            hooks.selection(...p);\r\n        }\r\n        selectionCb(...p);\r\n    };\r\n}\r\nfunction initObservers(o, hooks = {}) {\r\n    const currentWindow = o.doc.defaultView;\r\n    if (!currentWindow) {\r\n        return () => {\r\n        };\r\n    }\r\n    mergeHooks(o, hooks);\r\n    const mutationObserver = initMutationObserver(o, o.doc);\r\n    const mousemoveHandler = initMoveObserver(o);\r\n    const mouseInteractionHandler = initMouseInteractionObserver(o);\r\n    const scrollHandler = initScrollObserver(o);\r\n    const viewportResizeHandler = initViewportResizeObserver(o);\r\n    const inputHandler = initInputObserver(o);\r\n    const mediaInteractionHandler = initMediaInteractionObserver(o);\r\n    const styleSheetObserver = initStyleSheetObserver(o, { win: currentWindow });\r\n    const adoptedStyleSheetObserver = initAdoptedStyleSheetObserver(o, o.doc);\r\n    const styleDeclarationObserver = initStyleDeclarationObserver(o, {\r\n        win: currentWindow,\r\n    });\r\n    const fontObserver = o.collectFonts\r\n        ? initFontObserver(o)\r\n        : () => {\r\n        };\r\n    const selectionObserver = initSelectionObserver(o);\r\n    const pluginHandlers = [];\r\n    for (const plugin of o.plugins) {\r\n        pluginHandlers.push(plugin.observer(plugin.callback, currentWindow, plugin.options));\r\n    }\r\n    return () => {\r\n        mutationBuffers.forEach((b) => b.reset());\r\n        mutationObserver.disconnect();\r\n        mousemoveHandler();\r\n        mouseInteractionHandler();\r\n        scrollHandler();\r\n        viewportResizeHandler();\r\n        inputHandler();\r\n        mediaInteractionHandler();\r\n        styleSheetObserver();\r\n        adoptedStyleSheetObserver();\r\n        styleDeclarationObserver();\r\n        fontObserver();\r\n        selectionObserver();\r\n        pluginHandlers.forEach((h) => h());\r\n    };\r\n}\n\nexport { INPUT_TAGS, initAdoptedStyleSheetObserver, initMutationObserver, initObservers, initScrollObserver, mutationBuffers };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}